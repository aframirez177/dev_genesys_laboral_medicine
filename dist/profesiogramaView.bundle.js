/*! For license information please see profesiogramaView.bundle.js.LICENSE.txt */
(()=>{var e={4633:(e,t,n)=>{var r=n(3738).default;function o(){"use strict";e.exports=o=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},a=Object.prototype,i=a.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,a=Object.create(o.prototype),i=new O(r||[]);return c(a,"_invoke",{value:N(e,n,i)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var v="suspendedStart",g="suspendedYield",m="executing",y="completed",b={};function w(){}function x(){}function E(){}var P={};p(P,l,(function(){return this}));var L=Object.getPrototypeOf,k=L&&L(L(_([])));k&&k!==a&&i.call(k,l)&&(P=k);var I=E.prototype=w.prototype=Object.create(P);function S(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,a,c,s){var l=h(e[o],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(d).then((function(e){u.value=e,c(u)}),(function(e){return n("throw",e,c,s)}))}s(l.arg)}var o;c(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}})}function N(e,n,r){var o=v;return function(a,i){if(o===m)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=T(c,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var l=h(e,n,r);if("normal"===l.type){if(o=r.done?y:g,l.arg===b)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=y,r.method="throw",r.arg=l.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(i.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return x.prototype=E,c(I,"constructor",{value:E,configurable:!0}),c(E,"constructor",{value:x,configurable:!0}),x.displayName=p(E,d,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,p(e,d,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},S(j.prototype),p(j.prototype,u,(function(){return this})),n.AsyncIterator=j,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var i=new j(f(e,t,r,o),a);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),p(I,d,"Generator"),p(I,l,(function(){return this})),p(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;D(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:_(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4756:(e,t,n)=>{var r=n(4633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=t.apply(n,r);function c(t){e(i,o,a,c,s,"next",t)}function s(t){e(i,o,a,c,s,"throw",t)}c(void 0)}))}}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}var i=n(4756),c=n.n(i),s=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentPage=0,this.totalPages=0,this.viewer=null,this.pages=[],this.init()},n=[{key:"init",value:function(){var e=this;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){return e.setup()})):this.setup()}},{key:"setup",value:function(){this.viewer=document.getElementById("profesiograma-viewer"),this.pages=document.querySelectorAll(".page"),this.totalPages=this.pages.length,document.getElementById("total-pages-num").textContent=this.totalPages,this.initializeDots(),this.bindEvents(),this.loadData(),this.goToPage(0),this.setDates()}},{key:"initializeDots",value:function(){var e=this,t=document.getElementById("page-dots");t.innerHTML="";for(var n=function(n){var r=document.createElement("button");r.className="page-dot",r.setAttribute("aria-label","Ir a sección ".concat(n+1)),r.dataset.page=n,r.addEventListener("click",(function(){e.goToPage(n)})),t.appendChild(r)},r=0;r<this.totalPages;r++)n(r)}},{key:"bindEvents",value:function(){var e=this;document.getElementById("btn-prev").addEventListener("click",(function(){return e.previousPage()})),document.getElementById("btn-next").addEventListener("click",(function(){return e.nextPage()})),document.getElementById("btn-print").addEventListener("click",(function(){return e.print()})),document.getElementById("btn-export-pdf").addEventListener("click",(function(){return e.exportPDF()})),document.addEventListener("keydown",(function(t){"ArrowLeft"===t.key?e.previousPage():"ArrowRight"===t.key&&e.nextPage()})),this.viewer.addEventListener("scroll",(function(){e.detectCurrentPage()})),this.initTouchSupport()}},{key:"initTouchSupport",value:function(){var e=this,t=0,n=0;this.viewer.addEventListener("touchstart",(function(e){t=e.changedTouches[0].screenX}),{passive:!0}),this.viewer.addEventListener("touchend",(function(t){n=t.changedTouches[0].screenX,e.handleSwipe()}),{passive:!0}),this.handleSwipe=function(){var r=t-n;Math.abs(r)>50&&(r>0?e.nextPage():e.previousPage())}}},{key:"detectCurrentPage",value:function(){var e=this.viewer.scrollLeft,t=this.viewer.clientWidth,n=Math.round(e/t);n!==this.currentPage&&(this.currentPage=n,this.updateUI())}},{key:"goToPage",value:function(e){if(!(e<0||e>=this.totalPages)){this.currentPage=e;var t=this.viewer.clientWidth;this.viewer.scrollTo({left:e*t,behavior:"smooth"}),this.updateUI()}}},{key:"nextPage",value:function(){this.currentPage<this.totalPages-1&&this.goToPage(this.currentPage+1)}},{key:"previousPage",value:function(){this.currentPage>0&&this.goToPage(this.currentPage-1)}},{key:"updateUI",value:function(){var e=this;document.getElementById("current-page-num").textContent=this.currentPage+1;var t=document.getElementById("btn-prev"),n=document.getElementById("btn-next");t.disabled=0===this.currentPage,n.disabled=this.currentPage===this.totalPages-1,document.querySelectorAll(".page-dot").forEach((function(t,n){n===e.currentPage?t.classList.add("active"):t.classList.remove("active")}))}},{key:"print",value:function(){window.print()}},{key:"exportPDF",value:(i=t(c().mark((function e(){var t,n,r,o,a,i,s,l,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),n=t.get("id")){e.next=5;break}return alert("No se encontró el ID del profesiograma"),e.abrupt("return");case 5:return e.prev=5,r=document.getElementById("btn-export-pdf"),o=r.innerHTML,r.disabled=!0,r.innerHTML='\n                <svg class="btn-icon btn-icon-spin" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <circle cx="12" cy="12" r="10"></circle>\n                    <path d="M12 6v6l4 2"></path>\n                </svg>\n                Generando PDF...\n            ',e.next=12,fetch("/api/profesiograma/".concat(n,"/export-pdf"),{method:"POST",headers:{"Content-Type":"application/json"}});case 12:if((a=e.sent).ok){e.next=15;break}throw new Error("Error al generar PDF");case 15:return e.next=17,a.blob();case 17:i=e.sent,s=window.URL.createObjectURL(i),(l=document.createElement("a")).style.display="none",l.href=s,l.download="profesiograma_".concat(n,".pdf"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(s),document.body.removeChild(l),r.disabled=!1,r.innerHTML=o,alert("PDF generado exitosamente"),e.next=39;break;case 32:e.prev=32,e.t0=e.catch(5),console.error("Error al exportar PDF:",e.t0),alert("Error al generar el PDF. Por favor intente nuevamente."),(u=document.getElementById("btn-export-pdf")).disabled=!1,u.innerHTML='\n                <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>\n                    <polyline points="14 2 14 8 20 8"></polyline>\n                    <line x1="12" y1="18" x2="12" y2="12"></line>\n                    <line x1="9" y1="15" x2="15" y2="15"></line>\n                </svg>\n                Exportar PDF\n            ';case 39:case"end":return e.stop()}}),e,null,[[5,32]])}))),function(){return i.apply(this,arguments)})},{key:"loadData",value:(o=t(c().mark((function e(){var t,n,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),n=t.get("id")){e.next=5;break}return console.warn("No profesiograma ID in URL"),e.abrupt("return");case 5:return e.prev=5,e.next=8,fetch("/api/profesiograma/".concat(n));case 8:if((r=e.sent).ok){e.next=11;break}throw new Error("Error al cargar datos del profesiograma");case 11:return e.next=13,r.json();case 13:o=e.sent,this.populateData(o),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),console.error("Error al cargar profesiograma:",e.t0),alert("Error al cargar los datos del profesiograma");case 21:case"end":return e.stop()}}),e,this,[[5,17]])}))),function(){return o.apply(this,arguments)})},{key:"populateData",value:function(e){document.querySelectorAll("#empresa-nombre, #empresa-nombre-obj").forEach((function(t){var n;t&&(t.textContent=(null===(n=e.empresa)||void 0===n?void 0:n.nombre)||"[Nombre de la empresa]")}));var t,n=document.getElementById("empresa-nit");n&&(n.textContent=(null===(t=e.empresa)||void 0===t?void 0:t.nit)||"[NIT]"),this.populateCargos(e.cargos||[]);var r=document.getElementById("proxima-revision");if(r){var o=new Date;o.setFullYear(o.getFullYear()+1),r.textContent=o.toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"})}var a=document.getElementById("fecha-version-inicial"),i=document.getElementById("fecha-elaboro"),c=(new Date).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"});a&&(a.textContent=c),i&&(i.textContent=c)}},{key:"populateCargos",value:function(e){var t=this,n=document.getElementById("cargos-container");n&&(e&&0!==e.length?(n.innerHTML="",e.forEach((function(e,r){var o=t.generateCargoHTML(e,r+1);n.innerHTML+=o}))):n.innerHTML='\n                <div class="no-data-message">\n                    <p>No se encontraron cargos para este profesiograma.</p>\n                </div>\n            ')}},{key:"generateCargoHTML",value:function(e,t){var n,r,o,a,i,c=(null===(n=e.factoresRiesgo)||void 0===n?void 0:n.map((function(e){return'\n            <div class="factor-riesgo-item">\n                <div class="factor-header">\n                    <h5 class="factor-nombre">'.concat(e.factor||"",'</h5>\n                    <span class="factor-badge" style="background-color: ').concat((t=e.nrNivel,{I:"#4caf50",II:"#ffeb3b",III:"#ff9800",IV:"#f44336"}[t]||"#999"),';">\n                        NR: ').concat(e.nr||"N/A"," (Nivel ").concat(e.nrNivel||"N/A",')\n                    </span>\n                </div>\n                <p class="factor-descripcion">').concat(e.descripcion||"",'</p>\n                <p class="factor-exposicion"><strong>Nivel de exposición:</strong> ').concat(e.nivelExposicion||"N/A","</p>\n            </div>\n        ");var t})).join(""))||'<p class="no-data">No se identificaron factores de riesgo específicos.</p>',s=(null===(r=e.examenes)||void 0===r?void 0:r.map((function(e){return"\n            <tr>\n                <td>".concat(e.nombre||"","</td>\n                <td>").concat(e.periodicidad||"","</td>\n                <td>").concat(e.justificacion||"","</td>\n            </tr>\n        ")})).join(""))||'<tr><td colspan="3" class="no-data">No se definieron exámenes complementarios.</td></tr>',l=(null===(o=e.epp)||void 0===o?void 0:o.map((function(e){return"<li>".concat(e,"</li>")})).join(""))||'<li class="no-data">No se especificaron EPP.</li>',u=(null===(a=e.aptitudes)||void 0===a?void 0:a.map((function(e){return"<li>".concat(e,"</li>")})).join(""))||'<li class="no-data">No se especificaron aptitudes.</li>',d=(null===(i=e.condicionesIncompatibles)||void 0===i?void 0:i.map((function(e){return"<li>".concat(e,"</li>")})).join(""))||'<li class="no-data">No se especificaron condiciones incompatibles.</li>';return'\n            <div class="cargo-ficha">\n                <div class="cargo-header">\n                    <div class="cargo-numero">FICHA N°: '.concat(String(t).padStart(3,"0"),'</div>\n                    <h3 class="cargo-nombre">').concat(e.nombre||"Cargo sin nombre",'</h3>\n                </div>\n\n                <div class="cargo-info-grid">\n                    <div class="cargo-info-item">\n                        <span class="info-label">Área:</span>\n                        <span class="info-value">').concat(e.area||"N/A",'</span>\n                    </div>\n                    <div class="cargo-info-item">\n                        <span class="info-label">N° Trabajadores:</span>\n                        <span class="info-value">').concat(e.numTrabajadores||"N/A",'</span>\n                    </div>\n                    <div class="cargo-info-item">\n                        <span class="info-label">Nivel de Riesgo ARL:</span>\n                        <span class="info-value badge-risk">').concat(e.nivelRiesgoARL||"N/A",'</span>\n                    </div>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Descripción del cargo</h4>\n                    <p class="cargo-descripcion">').concat(e.descripcion||"No disponible",'</p>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Factores de Riesgo Identificados</h4>\n                    <div class="factores-riesgo-list">\n                        ').concat(c,'\n                    </div>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Exámenes Médicos Complementarios</h4>\n                    <table class="examenes-table">\n                        <thead>\n                            <tr>\n                                <th>Examen</th>\n                                <th>Periodicidad</th>\n                                <th>Justificación</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ').concat(s,'\n                        </tbody>\n                    </table>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Elementos de Protección Personal (EPP)</h4>\n                    <ul class="epp-list">\n                        ').concat(l,'\n                    </ul>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Aptitudes Requeridas</h4>\n                    <ul class="aptitudes-list">\n                        ').concat(u,'\n                    </ul>\n                </div>\n\n                <div class="cargo-section">\n                    <h4 class="cargo-section-title">Condiciones de Salud Incompatibles</h4>\n                    <ul class="incompatibles-list">\n                        ').concat(d,"\n                    </ul>\n                </div>\n            </div>\n        ")}},{key:"setDates",value:function(){var e=new Date,t=e.toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}),n=document.getElementById("fecha-elaboracion");n&&(n.textContent=t);var r=new Date(e);r.setFullYear(r.getFullYear()+1);var o=r.toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}),a=document.getElementById("fecha-vigencia");a&&(a.textContent=o);var i=document.getElementById("fecha-revision");i&&(i.textContent=o)}}],n&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,o,i}();new s;console.log("✅ Profesiograma Viewer initialized")})()})();