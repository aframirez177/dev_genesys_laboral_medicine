/*! For license information please see dashboard.bundle.js.LICENSE.txt */
(()=>{var e={4633:(e,n,t)=>{var a=t(3738).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var n,t={},i=Object.prototype,o=i.hasOwnProperty,s=Object.defineProperty||function(e,n,t){e[n]=t.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function p(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{p({},"")}catch(n){p=function(e,n,t){return e[n]=t}}function g(e,n,t,a){var r=n&&n.prototype instanceof _?n:_,i=Object.create(r.prototype),o=new T(a||[]);return s(i,"_invoke",{value:N(e,t,o)}),i}function v(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}t.wrap=g;var m="suspendedStart",h="suspendedYield",f="executing",b="completed",y={};function _(){}function w(){}function x(){}var E={};p(E,l,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(j([])));C&&C!==i&&o.call(C,l)&&(E=C);var A=x.prototype=_.prototype=Object.create(E);function I(e){["next","throw","return"].forEach((function(n){p(e,n,(function(e){return this._invoke(n,e)}))}))}function S(e,n){function t(r,i,s,c){var l=v(e[r],e,i);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==a(u)&&o.call(u,"__await")?n.resolve(u.__await).then((function(e){t("next",e,s,c)}),(function(e){t("throw",e,s,c)})):n.resolve(u).then((function(e){d.value=e,s(d)}),(function(e){return t("throw",e,s,c)}))}c(l.arg)}var r;s(this,"_invoke",{value:function(e,a){function i(){return new n((function(n,r){t(e,a,n,r)}))}return r=r?r.then(i,i):i()}})}function N(e,t,a){var r=m;return function(i,o){if(r===f)throw Error("Generator is already running");if(r===b){if("throw"===i)throw o;return{value:n,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=z(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===m)throw r=b,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=f;var l=v(e,t,a);if("normal"===l.type){if(r=a.done?b:h,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r=b,a.method="throw",a.arg=l.arg)}}}function z(e,t){var a=t.method,r=e.iterator[a];if(r===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=n,z(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=v(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,y;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function P(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function L(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function j(e){if(e||""===e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,s(A,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:w,configurable:!0}),w.displayName=p(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===w||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,p(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},I(S.prototype),p(S.prototype,d,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,a,r,i){void 0===i&&(i=Promise);var o=new S(g(e,n,a,r),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},I(A),p(A,u,"Generator"),p(A,l,(function(){return this})),p(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var n=Object(e),t=[];for(var a in n)t.push(a);return t.reverse(),function e(){for(;t.length;){var a=t.pop();if(a in n)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=n&&n<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=n,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(i)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),y},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),L(t),y}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var a=t.completion;if("throw"===a.type){var r=a.arg;L(t)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:j(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),y}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},4756:(e,n,t)=>{var a=t(4633)();e.exports=a;try{regeneratorRuntime=a}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var i=n[a]={exports:{}};return e[a](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{"use strict";function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function n(n,t){if(n){if("string"==typeof n)return e(n,t);var a={}.toString.call(n).slice(8,-1);return"Object"===a&&n.constructor&&(a=n.constructor.name),"Map"===a||"Set"===a?Array.from(n):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(n,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,o,s=[],c=!0,l=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=i.call(t)).done)&&(s.push(a.value),s.length!==n);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return s}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var n=function(e,n){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==r(n)?n:n+""}function o(e,n,t){return(n=i(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n,t,a,r,i,o){try{var s=e[i](o),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(a,r)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,r){var i=e.apply(n,t);function o(e){s(i,a,r,o,c,"next",e)}function c(e){s(i,a,r,o,c,"throw",e)}o(void 0)}))}}function l(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function u(e,n,t){return n&&d(e.prototype,n),t&&d(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var p=t(4756),g=t.n(p);function v(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function m(t){return function(n){if(Array.isArray(n))return e(n)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const h=globalThis,f=h.trustedTypes,b=f?f.createPolicy("lit-html",{createHTML:e=>e}):void 0,y="$lit$",_=`lit$${Math.random().toFixed(9).slice(2)}$`,w="?"+_,x=`<${w}>`,E=document,k=()=>E.createComment(""),C=e=>null===e||"object"!=typeof e&&"function"!=typeof e,A=Array.isArray,I=e=>A(e)||"function"==typeof e?.[Symbol.iterator],S="[ \t\n\f\r]",N=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,z=/-->/g,P=/>/g,L=RegExp(`>|${S}(?:([^\\s"'>=/]+)(${S}*=${S}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),T=/'/g,j=/"/g,O=/^(?:script|style|textarea|title)$/i,D=e=>(n,...t)=>({_$litType$:e,strings:n,values:t}),M=D(1),$=(D(2),D(3),Symbol.for("lit-noChange")),R=Symbol.for("lit-nothing"),H=new WeakMap,B=E.createTreeWalker(E,129);function G(e,n){if(!A(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==b?b.createHTML(n):n}const q=(e,n)=>{const t=e.length-1,a=[];let r,i=2===n?"<svg>":3===n?"<math>":"",o=N;for(let n=0;n<t;n++){const t=e[n];let s,c,l=-1,d=0;for(;d<t.length&&(o.lastIndex=d,c=o.exec(t),null!==c);)d=o.lastIndex,o===N?"!--"===c[1]?o=z:void 0!==c[1]?o=P:void 0!==c[2]?(O.test(c[2])&&(r=RegExp("</"+c[2],"g")),o=L):void 0!==c[3]&&(o=L):o===L?">"===c[0]?(o=r??N,l=-1):void 0===c[1]?l=-2:(l=o.lastIndex-c[2].length,s=c[1],o=void 0===c[3]?L:'"'===c[3]?j:T):o===j||o===T?o=L:o===z||o===P?o=N:(o=L,r=void 0);const u=o===L&&e[n+1].startsWith("/>")?" ":"";i+=o===N?t+x:l>=0?(a.push(s),t.slice(0,l)+y+t.slice(l)+_+u):t+_+(-2===l?n:u)}return[G(e,i+(e[t]||"<?>")+(2===n?"</svg>":3===n?"</math>":"")),a]};class V{constructor({strings:e,_$litType$:n},t){let a;this.parts=[];let r=0,i=0;const o=e.length-1,s=this.parts,[c,l]=q(e,n);if(this.el=V.createElement(c,t),B.currentNode=this.el.content,2===n||3===n){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(a=B.nextNode())&&s.length<o;){if(1===a.nodeType){if(a.hasAttributes())for(const e of a.getAttributeNames())if(e.endsWith(y)){const n=l[i++],t=a.getAttribute(e).split(_),o=/([.?@])?(.*)/.exec(n);s.push({type:1,index:r,name:o[2],strings:t,ctor:"."===o[1]?Z:"?"===o[1]?K:"@"===o[1]?X:J}),a.removeAttribute(e)}else e.startsWith(_)&&(s.push({type:6,index:r}),a.removeAttribute(e));if(O.test(a.tagName)){const e=a.textContent.split(_),n=e.length-1;if(n>0){a.textContent=f?f.emptyScript:"";for(let t=0;t<n;t++)a.append(e[t],k()),B.nextNode(),s.push({type:2,index:++r});a.append(e[n],k())}}}else if(8===a.nodeType)if(a.data===w)s.push({type:2,index:r});else{let e=-1;for(;-1!==(e=a.data.indexOf(_,e+1));)s.push({type:7,index:r}),e+=_.length-1}r++}}static createElement(e,n){const t=E.createElement("template");return t.innerHTML=e,t}}function U(e,n,t=e,a){if(n===$)return n;let r=void 0!==a?t._$Co?.[a]:t._$Cl;const i=C(n)?void 0:n._$litDirective$;return r?.constructor!==i&&(r?._$AO?.(!1),void 0===i?r=void 0:(r=new i(e),r._$AT(e,t,a)),void 0!==a?(t._$Co??=[])[a]=r:t._$Cl=r),void 0!==r&&(n=U(e,r._$AS(e,n.values),r,a)),n}class F{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:t}=this._$AD,a=(e?.creationScope??E).importNode(n,!0);B.currentNode=a;let r=B.nextNode(),i=0,o=0,s=t[0];for(;void 0!==s;){if(i===s.index){let n;2===s.type?n=new W(r,r.nextSibling,this,e):1===s.type?n=new s.ctor(r,s.name,s.strings,this,e):6===s.type&&(n=new Y(r,this,e)),this._$AV.push(n),s=t[++o]}i!==s?.index&&(r=B.nextNode(),i++)}return B.currentNode=E,a}p(e){let n=0;for(const t of this._$AV)void 0!==t&&(void 0!==t.strings?(t._$AI(e,t,n),n+=t.strings.length-2):t._$AI(e[n])),n++}}class W{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,t,a){this.type=2,this._$AH=R,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=t,this.options=a,this._$Cv=a?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return void 0!==n&&11===e?.nodeType&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=U(this,e,n),C(e)?e===R||null==e||""===e?(this._$AH!==R&&this._$AR(),this._$AH=R):e!==this._$AH&&e!==$&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):I(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==R&&C(this._$AH)?this._$AA.nextSibling.data=e:this.T(E.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:t}=e,a="number"==typeof t?this._$AC(e):(void 0===t.el&&(t.el=V.createElement(G(t.h,t.h[0]),this.options)),t);if(this._$AH?._$AD===a)this._$AH.p(n);else{const e=new F(a,this),t=e.u(this.options);e.p(n),this.T(t),this._$AH=e}}_$AC(e){let n=H.get(e.strings);return void 0===n&&H.set(e.strings,n=new V(e)),n}k(e){A(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let t,a=0;for(const r of e)a===n.length?n.push(t=new W(this.O(k()),this.O(k()),this,this.options)):t=n[a],t._$AI(r),a++;a<n.length&&(this._$AR(t&&t._$AB.nextSibling,a),n.length=a)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class J{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,t,a,r){this.type=1,this._$AH=R,this._$AN=void 0,this.element=e,this.name=n,this._$AM=a,this.options=r,t.length>2||""!==t[0]||""!==t[1]?(this._$AH=Array(t.length-1).fill(new String),this.strings=t):this._$AH=R}_$AI(e,n=this,t,a){const r=this.strings;let i=!1;if(void 0===r)e=U(this,e,n,0),i=!C(e)||e!==this._$AH&&e!==$,i&&(this._$AH=e);else{const a=e;let o,s;for(e=r[0],o=0;o<r.length-1;o++)s=U(this,a[t+o],n,o),s===$&&(s=this._$AH[o]),i||=!C(s)||s!==this._$AH[o],s===R?e=R:e!==R&&(e+=(s??"")+r[o+1]),this._$AH[o]=s}i&&!a&&this.j(e)}j(e){e===R?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Z extends J{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===R?void 0:e}}class K extends J{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==R)}}class X extends J{constructor(e,n,t,a,r){super(e,n,t,a,r),this.type=5}_$AI(e,n=this){if((e=U(this,e,n,0)??R)===$)return;const t=this._$AH,a=e===R&&t!==R||e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive,r=e!==R&&(t===R||a);a&&this.element.removeEventListener(this.name,this,t),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class Y{constructor(e,n,t){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=t}get _$AU(){return this._$AM._$AU}_$AI(e){U(this,e)}}const Q=h.litHtmlPolyfillSupport;Q?.(V,W),(h.litHtmlVersions??=[]).push("3.3.1");var ee,ne,te,ae,re,ie,oe,se,ce,le,de,ue,pe,ge,ve,me,he,fe,be,ye,_e,we,xe,Ee,ke,Ce,Ae,Ie,Se,Ne,ze,Pe,Le,Te,je,Oe,De;function Me(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function $e(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Re=function(){return u((function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.options=$e({mode:n.mode||"create",cargoId:n.cargoId||null,cargoData:n.cargoData||null,empresaId:n.empresaId||null,onSave:n.onSave||function(){},onCancel:n.onCancel||function(){}},n),this.state={currentStep:0,totalSteps:5,loading:!1,error:null,cargo:{nombre:"",area:"",zona:"",descripcion:"",numPersonas:1,tareasRutinarias:!1,trabajaAlturas:!1,manipulaAlimentos:!1,conduceVehiculo:!1,trabajaEspaciosConfinados:!1,riesgosSeleccionados:[],niveles:{},controles:{}},pendingApprovals:[],originalNiveles:{},originalControles:{},catalogoGES:[],catalogoRiesgos:[],existingAreas:[],existingZonas:[]},this.steps=[{id:"info",title:"Informaci贸n B谩sica",icon:"user"},{id:"riesgos",title:"Selecci贸n de Riesgos",icon:"alert-triangle"},{id:"niveles",title:"Niveles de Riesgo",icon:"sliders"},{id:"controles",title:"Controles",icon:"shield"},{id:"resumen",title:"Resumen",icon:"check-circle"}],this.niveles={ND:[{value:1,label:"Bajo / N/A",color:"#10b981"},{value:2,label:"Medio",color:"#84cc16"},{value:6,label:"Alto",color:"#f59e0b"},{value:10,label:"Muy Alto",color:"#ef4444"}],NE:[{value:1,label:"Espor谩dica",color:"#10b981"},{value:2,label:"Ocasional",color:"#84cc16"},{value:3,label:"Frecuente",color:"#f59e0b"},{value:4,label:"Continua",color:"#ef4444"}],NC:[{value:10,label:"Leve",color:"#10b981"},{value:25,label:"Grave",color:"#f59e0b"},{value:60,label:"Muy Grave",color:"#f97316"},{value:100,label:"Mortal",color:"#ef4444"}]},this.modalElement=null,this.init()}),[{key:"init",value:(r=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"edit"===this.options.mode&&this.options.cargoData&&this.loadCargoData(this.options.cargoData),e.next=3,this.loadCatalogos();case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadCargoData",value:function(e){this.state.cargo=$e($e({},this.state.cargo),{},{nombre:e.nombre||e.nombre_cargo||"",area:e.area||"",zona:e.zona||"",descripcion:e.descripcion||e.descripcion_tareas||e.descripcionTareas||"",numPersonas:e.numPersonas||e.num_trabajadores||1,tareasRutinarias:e.tareasRutinarias||e.tareas_rutinarias||!1,trabajaAlturas:e.trabajaAlturas||e.trabaja_alturas||!1,manipulaAlimentos:e.manipulaAlimentos||e.manipula_alimentos||!1,conduceVehiculo:e.conduceVehiculo||e.conduce_vehiculo||!1,trabajaEspaciosConfinados:e.trabajaEspaciosConfinados||e.trabaja_espacios_confinados||!1,riesgosSeleccionados:e.gesSeleccionados||e.riesgos||e.riesgosSeleccionados||[],niveles:e.niveles||{},controles:e.controles||{}}),this.state.originalNiveles=JSON.parse(JSON.stringify(this.state.cargo.niveles)),this.state.originalControles=JSON.parse(JSON.stringify(this.state.cargo.controles))}},{key:"loadCatalogos",value:(t=c(g().mark((function e(){var n,t,a,r,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/catalogo/ges");case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:t=e.sent,this.state.catalogoGES=t.data||t||[];case 9:if(!this.options.empresaId){e.next=20;break}return e.next=12,fetch("/api/cargos/empresa/".concat(this.options.empresaId));case 12:if(!(a=e.sent).ok){e.next=20;break}return e.next=16,a.json();case 16:r=e.sent,i=r.cargos||[],this.state.existingAreas=m(new Set(i.map((function(e){return e.area})).filter(Boolean))),this.state.existingZonas=m(new Set(i.map((function(e){return e.zona})).filter(Boolean)));case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error("[CargoMiniWizard] Error loading catalogs:",e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])}))),function(){return t.apply(this,arguments)})},{key:"show",value:function(){var e=this;this.modalElement=document.createElement("div"),this.modalElement.className="cargo-mini-wizard-overlay",this.modalElement.innerHTML='\n      <div class="cargo-mini-wizard-modal">\n        <div class="cargo-mini-wizard-content" id="cargo-mini-wizard-content">\n        </div>\n      </div>\n    ',document.body.appendChild(this.modalElement),document.body.style.overflow="hidden",this.renderContent(),this.modalElement.addEventListener("click",(function(n){n.target===e.modalElement&&e.handleCancel()})),this.escapeHandler=function(n){"Escape"===n.key&&e.handleCancel()},document.addEventListener("keydown",this.escapeHandler)}},{key:"hide",value:function(){this.modalElement&&(document.body.removeChild(this.modalElement),document.body.style.overflow="",this.modalElement=null),this.escapeHandler&&document.removeEventListener("keydown",this.escapeHandler)}},{key:"renderContent",value:function(){var e=this,n=document.getElementById("cargo-mini-wizard-content");n&&(((e,n,t)=>{const a=t?.renderBefore??n;let r=a._$litPart$;if(void 0===r){const e=t?.renderBefore??null;a._$litPart$=r=new W(n.insertBefore(k(),e),e,void 0,t??{})}r._$AI(e)})(M(ee||(ee=v(['\n      \x3c!-- Header --\x3e\n      <div class="mini-wizard__header">\n        <div class="mini-wizard__header-left">\n          <h2 class="mini-wizard__title">\n            ','\n          </h2>\n          <p class="mini-wizard__subtitle">\n            ','\n          </p>\n        </div>\n        <button class="mini-wizard__close" @click=','>\n          <i data-lucide="x"></i>\n        </button>\n      </div>\n\n      \x3c!-- Progress Steps --\x3e\n      <div class="mini-wizard__progress">\n        ','\n      </div>\n\n      \x3c!-- Content --\x3e\n      <div class="mini-wizard__body">\n        ','\n      </div>\n\n      \x3c!-- Footer --\x3e\n      <div class="mini-wizard__footer">\n        <div class="mini-wizard__footer-left">\n          ','\n        </div>\n        <div class="mini-wizard__footer-right">\n          <button class="btn btn--ghost" @click=',">\n            Cancelar\n          </button>\n          ","\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?"Editar Cargo":"Nuevo Cargo",this.steps[this.state.currentStep].title,(function(){return e.handleCancel()}),this.steps.map((function(n,t){return M(ne||(ne=v(['\n          <div class="mini-wizard__step '," ",'">\n            <div class="mini-wizard__step-icon">\n              <i data-lucide="','"></i>\n            </div>\n            <span class="mini-wizard__step-label">',"</span>\n          </div>\n        "])),t===e.state.currentStep?"active":"",t<e.state.currentStep?"completed":"",n.icon,n.title)})),this.renderCurrentStep(),this.state.currentStep>0?M(te||(te=v(['\n            <button class="btn btn--outline" @click=','>\n              <i data-lucide="arrow-left"></i>\n              Anterior\n            </button>\n          '])),(function(){return e.goToPreviousStep()})):"",(function(){return e.handleCancel()}),this.state.currentStep<this.state.totalSteps-1?M(ae||(ae=v(['\n            <button class="btn btn--primary" @click=','>\n              Siguiente\n              <i data-lucide="arrow-right"></i>\n            </button>\n          '])),(function(){return e.goToNextStep()})):M(re||(re=v(['\n            <button class="btn btn--primary" @click=','>\n              <i data-lucide="save"></i>\n              ',"\n            </button>\n          "])),(function(){return e.handleSave()}),"edit"===this.options.mode?"Guardar Cambios":"Crear Cargo")),n),window.lucide&&window.lucide.createIcons())}},{key:"renderCurrentStep",value:function(){switch(this.state.currentStep){case 0:return this.renderInfoStep();case 1:return this.renderRiesgosStep();case 2:return this.renderNivelesStep();case 3:return this.renderControlesStep();case 4:return this.renderResumenStep();default:return M(ie||(ie=v(["<p>Paso no encontrado</p>"])))}}},{key:"renderInfoStep",value:function(){var e=this,n=this.state.cargo;return M(oe||(oe=v(['\n      <div class="mini-wizard__step-content">\n        <div class="mini-wizard__form-grid">\n          \x3c!-- Columna izquierda: Campos b谩sicos --\x3e\n          <div class="mini-wizard__form-col">\n            <div class="form-group">\n              <label class="form-label">Nombre del Cargo <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Operario de Producci贸n"\n                required\n              />\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">rea <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                list="areas-list"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Producci贸n, Administraci贸n"\n              />\n              <datalist id="areas-list">\n                ','\n              </datalist>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Zona o Lugar <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                list="zonas-list"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Planta 1, Oficina central"\n              />\n              <datalist id="zonas-list">\n                ','\n              </datalist>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">N煤mero de Trabajadores <span class="required">*</span></label>\n              <input\n                type="number"\n                class="form-input"\n                .value=',"\n                @input=",'\n                min="1"\n                max="9999"\n              />\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Descripci贸n</label>\n              <textarea\n                class="form-input form-textarea"\n                .value=',"\n                @input=",'\n                placeholder="Descripci贸n de las funciones del cargo..."\n                rows="4"\n              ></textarea>\n            </div>\n          </div>\n\n          \x3c!-- Columna derecha: Toggles especiales --\x3e\n          <div class="mini-wizard__form-col">\n            <label class="form-label form-label--section">\n              <i data-lucide="shield"></i>\n              Caracter铆sticas Especiales\n            </label>\n            <div class="toggles-grid">\n              ',"\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),n.nombre,(function(n){return e.updateCargo("nombre",n.target.value)}),n.area,(function(n){return e.updateCargo("area",n.target.value)}),this.state.existingAreas.map((function(e){return M(se||(se=v(['<option value="','">'])),e)})),n.zona,(function(n){return e.updateCargo("zona",n.target.value)}),this.state.existingZonas.map((function(e){return M(ce||(ce=v(['<option value="','">'])),e)})),n.numPersonas,(function(n){return e.updateCargo("numPersonas",parseInt(n.target.value)||1)}),n.descripcion,(function(n){return e.updateCargo("descripcion",n.target.value)}),[{name:"tareasRutinarias",label:"Tareas repetitivas",icon:"repeat",severity:"warning"},{name:"conduceVehiculo",label:"Conduce veh铆culo",icon:"car",severity:"warning"},{name:"manipulaAlimentos",label:"Manipula alimentos",icon:"utensils",severity:"danger"},{name:"trabajaAlturas",label:"Trabaja en alturas",icon:"arrow-up",severity:"danger"},{name:"trabajaEspaciosConfinados",label:"Espacios confinados",icon:"door-closed",severity:"danger"}].map((function(t){return M(le||(le=v(['\n                <div class="toggle-item toggle-item--','">\n                  <div class="toggle-item__info">\n                    <i data-lucide="','" class="toggle-item__icon"></i>\n                    <span class="toggle-item__label">','</span>\n                  </div>\n                  <label class="toggle-switch toggle-switch--','">\n                    <input\n                      type="checkbox"\n                      .checked=',"\n                      @change=",'\n                    />\n                    <span class="toggle-switch__slider"></span>\n                  </label>\n                </div>\n              '])),t.severity,t.icon,t.label,t.severity,n[t.name],(function(n){return e.updateCargo(t.name,n.target.checked)}))})))}},{key:"renderRiesgosStep",value:function(){var e=this,n=this.state.catalogoGES.reduce((function(e,n){var t=n.riesgo_nombre||n.categoria||n.riesgo||"Otros";return e[t]||(e[t]=[]),e[t].push(n),e}),{}),t=this.state.cargo.riesgosSeleccionados.map((function(e){return e.id_ges||e.idGes||e.id}));return this.state.expandedCategories||(this.state.expandedCategories={}),M(de||(de=v(['\n      <div class="mini-wizard__step-content mini-wizard__step-content--riesgos">\n        <div class="riesgos-header">\n          <p>Selecciona los riesgos asociados a este cargo</p>\n          <span class="riesgos-count">\n            ',' seleccionados\n          </span>\n        </div>\n\n        <div class="riesgos-grid">\n          ',"\n        </div>\n      </div>\n    "])),t.length,Object.entries(n).map((function(n){var r=a(n,2),i=r[0],o=r[1],s=e.state.expandedCategories[i],c=s?o:o.slice(0,10);return M(ue||(ue=v(['\n              <div class="riesgos-category">\n                <div class="riesgos-category__header">\n                  <span class="riesgos-category__name">','</span>\n                  <span class="riesgos-category__count">','</span>\n                </div>\n                <div class="riesgos-category__items">\n                  ',"\n                  ","\n                </div>\n              </div>\n            "])),i,o.length,c.map((function(n){var a=n.id_ges||n.idGes||n.id,r=t.includes(a);return M(pe||(pe=v(['\n                      <div\n                        class="riesgo-chip ','"\n                        @click=','\n                      >\n                        <span class="riesgo-chip__name">',"</span>\n                        ","\n                      </div>\n                    "])),r?"selected":"",(function(){return e.toggleRiesgo(n)}),n.nombre,r?M(ge||(ge=v(['<i data-lucide="check"></i>']))):"")})),o.length>10?M(ve||(ve=v(['\n                    <button\n                      class="riesgo-chip riesgo-chip--toggle"\n                      @click=',"\n                    >\n                      ","\n                    </button>\n                  "])),(function(){return e.toggleCategoryExpanded(i)}),s?M(me||(me=v(['<i data-lucide="chevron-up"></i> Mostrar menos']))):M(he||(he=v(['<i data-lucide="chevron-down"></i> +'," m谩s"])),o.length-10)):"")})))}},{key:"renderNivelesStep",value:function(){var e=this,n=this.state.cargo.riesgosSeleccionados;return 0===n.length?M(fe||(fe=v(['\n        <div class="mini-wizard__empty">\n          <i data-lucide="alert-circle"></i>\n          <p>No hay riesgos seleccionados</p>\n          <span>Vuelve al paso anterior para seleccionar riesgos</span>\n        </div>\n      ']))):M(be||(be=v(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="niveles-list">\n          ',"\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?M(ye||(ye=v(['\n          <div class="approval-warning">\n            <i data-lucide="alert-triangle"></i>\n            <div>\n              <strong>Cambios en niveles requieren aprobaci贸n</strong>\n              <p>Las modificaciones en los niveles de riesgo ser谩n marcadas para revisi贸n antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.map((function(n,t){return e.renderNivelItem(n,t)})))}},{key:"renderNivelItem",value:function(e,n){var t=this,a=e.id_ges||e.idGes||e.id,r=this.state.cargo.niveles[a]||{ND:1,NE:1,NC:10},i=r.ND*r.NE,o=i*r.NC,s=this.getNRInfo(o);return M(_e||(_e=v(['\n      <div class="nivel-item">\n        <div class="nivel-item__header">\n          <span class="nivel-item__name">','</span>\n          <span class="nivel-item__badge nivel-item__badge--','">\n            NR: '," (",')\n          </span>\n        </div>\n\n        <div class="nivel-item__selectors">\n          \x3c!-- ND --\x3e\n          <div class="nivel-selector">\n            <label>ND (Deficiencia)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- NE --\x3e\n          <div class="nivel-selector">\n            <label>NE (Exposici贸n)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- NC --\x3e\n          <div class="nivel-selector">\n            <label>NC (Consecuencia)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- Calculated values --\x3e\n          <div class="nivel-calculated">\n            <div class="nivel-calc-item">\n              <span class="nivel-calc-label">NP</span>\n              <span class="nivel-calc-value">','</span>\n            </div>\n            <div class="nivel-calc-item nivel-calc-item--nr" style="--nr-color: ','">\n              <span class="nivel-calc-label">NR</span>\n              <span class="nivel-calc-value">',"</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),e.nombre,s.level,o,s.label,this.niveles.ND.map((function(e){return M(we||(we=v(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.ND===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"ND",e.value)}),e.value)})),this.niveles.NE.map((function(e){return M(xe||(xe=v(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.NE===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"NE",e.value)}),e.value)})),this.niveles.NC.map((function(e){return M(Ee||(Ee=v(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.NC===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"NC",e.value)}),e.value)})),i,s.color,o)}},{key:"renderControlesStep",value:function(){var e=this,n=this.state.cargo.riesgosSeleccionados;return 0===n.length?M(ke||(ke=v(['\n        <div class="mini-wizard__empty">\n          <i data-lucide="alert-circle"></i>\n          <p>No hay riesgos seleccionados</p>\n        </div>\n      ']))):M(Ce||(Ce=v(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="controles-list">\n          ',"\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?M(Ae||(Ae=v(['\n          <div class="approval-warning">\n            <i data-lucide="alert-triangle"></i>\n            <div>\n              <strong>Cambios en controles requieren aprobaci贸n</strong>\n              <p>Las modificaciones en los controles ser谩n marcadas para revisi贸n antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.map((function(n,t){return e.renderControlItem(n,t)})))}},{key:"renderControlItem",value:function(e,n){var t=this,a=e.id_ges||e.idGes||e.id,r=this.state.cargo.controles[a]||{fuente:"",medio:"",individuo:""};return M(Ie||(Ie=v(['\n      <div class="control-item">\n        <div class="control-item__header">\n          <span class="control-item__name">','</span>\n        </div>\n\n        <div class="control-item__fields">\n          <div class="form-group">\n            <label class="form-label">Control en la Fuente</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: Aislamiento ac煤stico, guardas de protecci贸n..."\n              rows="2"\n            ></textarea>\n          </div>\n\n          <div class="form-group">\n            <label class="form-label">Control en el Medio</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: Se帽alizaci贸n, ventilaci贸n, iluminaci贸n..."\n              rows="2"\n            ></textarea>\n          </div>\n\n          <div class="form-group">\n            <label class="form-label">Control en el Individuo</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: EPP, capacitaci贸n, pausas activas..."\n              rows="2"\n            ></textarea>\n          </div>\n        </div>\n      </div>\n    '])),e.nombre,r.fuente,(function(e){return t.updateControl(a,"fuente",e.target.value)}),r.medio,(function(e){return t.updateControl(a,"medio",e.target.value)}),r.individuo,(function(e){return t.updateControl(a,"individuo",e.target.value)}))}},{key:"renderResumenStep",value:function(){var e=this,n=this.state.cargo,t=this.checkPendingApprovals();return M(Se||(Se=v(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="resumen-grid">\n          \x3c!-- Info b谩sica --\x3e\n          <div class="resumen-section">\n            <h3 class="resumen-section__title">\n              <i data-lucide="user"></i>\n              Informaci贸n del Cargo\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-item">\n                <span class="resumen-item__label">Nombre:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">rea:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">Zona:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">Trabajadores:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Caracter铆sticas especiales --\x3e\n          <div class="resumen-section">\n            <h3 class="resumen-section__title">\n              <i data-lucide="shield"></i>\n              Caracter铆sticas Especiales\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-toggles">\n                ',"\n                ","\n                ","\n                ","\n                ","\n                ",'\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Riesgos --\x3e\n          <div class="resumen-section resumen-section--full">\n            <h3 class="resumen-section__title">\n              <i data-lucide="alert-triangle"></i>\n              Riesgos Seleccionados (',')\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-riesgos">\n                ',"\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),t?M(Ne||(Ne=v(['\n          <div class="approval-pending-banner">\n            <i data-lucide="clock"></i>\n            <div>\n              <strong>Cambios pendientes de aprobaci贸n</strong>\n              <p>Algunos cambios en niveles y/o controles requieren verificaci贸n con la empresa antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.nombre||"-",n.area||"-",n.zona||"-",n.numPersonas,n.trabajaAlturas?M(ze||(ze=v(['<span class="resumen-toggle resumen-toggle--danger">Alturas</span>']))):"",n.manipulaAlimentos?M(Pe||(Pe=v(['<span class="resumen-toggle resumen-toggle--danger">Alimentos</span>']))):"",n.conduceVehiculo?M(Le||(Le=v(['<span class="resumen-toggle resumen-toggle--warning">Veh铆culo</span>']))):"",n.trabajaEspaciosConfinados?M(Te||(Te=v(['<span class="resumen-toggle resumen-toggle--danger">Espacios Confinados</span>']))):"",n.tareasRutinarias?M(je||(je=v(['<span class="resumen-toggle resumen-toggle--warning">Tareas Rutinarias</span>']))):"",n.trabajaAlturas||n.manipulaAlimentos||n.conduceVehiculo||n.trabajaEspaciosConfinados||n.tareasRutinarias?"":M(Oe||(Oe=v(['<span class="resumen-toggle resumen-toggle--none">Ninguna</span>']))),n.riesgosSeleccionados.length,n.riesgosSeleccionados.map((function(t){var a=t.id_ges||t.idGes||t.id,r=n.niveles[a]||{ND:1,NE:1,NC:10},i=r.ND*r.NE*r.NC,o=e.getNRInfo(i);return M(De||(De=v(['\n                    <div class="resumen-riesgo">\n                      <span class="resumen-riesgo__name">','</span>\n                      <span class="resumen-riesgo__nr" style="background: ','">\n                        NR: ',"\n                      </span>\n                    </div>\n                  "])),t.nombre,o.color,i)})))}},{key:"updateCargo",value:function(e,n){this.state.cargo[e]=n,this.renderContent()}},{key:"toggleRiesgo",value:function(e){var n=e.id_ges||e.idGes||e.id,t=this.state.cargo.riesgosSeleccionados,a=t.findIndex((function(e){return(e.id_ges||e.idGes||e.id)===n}));a>=0?(t.splice(a,1),delete this.state.cargo.niveles[n],delete this.state.cargo.controles[n]):(t.push(e),this.state.cargo.niveles[n]={ND:1,NE:1,NC:10},this.state.cargo.controles[n]={fuente:"",medio:"",individuo:""}),this.renderContent()}},{key:"toggleCategoryExpanded",value:function(e){this.state.expandedCategories||(this.state.expandedCategories={}),this.state.expandedCategories[e]=!this.state.expandedCategories[e],this.renderContent()}},{key:"updateNivel",value:function(e,n,t){this.state.cargo.niveles[e]||(this.state.cargo.niveles[e]={ND:1,NE:1,NC:10}),this.state.cargo.niveles[e][n]=t,"edit"===this.options.mode&&this.checkNivelApprovalNeeded(e,n,t),this.renderContent()}},{key:"updateControl",value:function(e,n,t){this.state.cargo.controles[e]||(this.state.cargo.controles[e]={fuente:"",medio:"",individuo:""}),this.state.cargo.controles[e][n]=t,"edit"===this.options.mode&&this.checkControlApprovalNeeded(e,n,t)}},{key:"checkNivelApprovalNeeded",value:function(e,n,t){var a=this.state.originalNiveles[e];if(a&&a[n]!==t){var r="nivel_".concat(e,"_").concat(n);this.state.pendingApprovals.includes(r)||this.state.pendingApprovals.push(r)}}},{key:"checkControlApprovalNeeded",value:function(e,n,t){var a=this.state.originalControles[e];if(a&&a[n]!==t){var r="control_".concat(e,"_").concat(n);this.state.pendingApprovals.includes(r)||this.state.pendingApprovals.push(r)}}},{key:"checkPendingApprovals",value:function(){return this.state.pendingApprovals.length>0}},{key:"goToNextStep",value:function(){this.validateCurrentStep()&&this.state.currentStep<this.state.totalSteps-1&&(this.state.currentStep++,this.renderContent())}},{key:"goToPreviousStep",value:function(){this.state.currentStep>0&&(this.state.currentStep--,this.renderContent())}},{key:"validateCurrentStep",value:function(){var e=this.state.cargo;switch(this.state.currentStep){case 0:return!e.nombre||e.nombre.length<3?(alert("El nombre del cargo debe tener al menos 3 caracteres"),!1):e.area?!!e.zona||(alert("La zona es requerida"),!1):(alert("El 谩rea es requerida"),!1);case 1:return 0!==e.riesgosSeleccionados.length||(alert("Debes seleccionar al menos un riesgo"),!1);default:return!0}}},{key:"handleSave",value:(n=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.checkPendingApprovals()){e.next=6;break}return e.next=3,this.showApprovalModal();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return this.state.loading=!0,this.renderContent(),e.prev=8,e.next=11,this.options.onSave($e($e({},this.state.cargo),{},{pendingApprovals:this.state.pendingApprovals,mode:this.options.mode,cargoId:this.options.cargoId}));case 11:this.hide(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.error("[CargoMiniWizard] Error saving:",e.t0),alert("Error al guardar: "+e.t0.message);case 18:return e.prev=18,this.state.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[8,14,18,21]])}))),function(){return n.apply(this,arguments)})},{key:"handleCancel",value:function(){this.options.onCancel(),this.hide()}},{key:"showApprovalModal",value:(e=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("div");n.className="approval-modal-overlay",n.innerHTML='\n        <div class="approval-modal">\n          <div class="approval-modal__icon">\n            <i data-lucide="alert-triangle"></i>\n          </div>\n          <h3 class="approval-modal__title">Cambios Requieren Aprobaci贸n</h3>\n          <p class="approval-modal__message">\n            Has modificado niveles de riesgo y/o controles existentes.\n            Estos cambios deben ser verificados con la empresa antes de aplicarse.\n          </p>\n          <p class="approval-modal__submessage">\n            Los cambios quedar谩n en estado "Pendiente de aprobaci贸n" hasta que sean revisados.\n          </p>\n          <div class="approval-modal__actions">\n            <button class="btn btn--ghost" id="approval-cancel">Cancelar</button>\n            <button class="btn btn--primary" id="approval-confirm">\n              <i data-lucide="clock"></i>\n              Enviar para Aprobaci贸n\n            </button>\n          </div>\n        </div>\n      ',document.body.appendChild(n),window.lucide&&window.lucide.createIcons(),n.querySelector("#approval-cancel").addEventListener("click",(function(){document.body.removeChild(n),e(!1)})),n.querySelector("#approval-confirm").addEventListener("click",(function(){document.body.removeChild(n),e(!0)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})},{key:"getNRInfo",value:function(e){return e<=20?{level:"i",label:"Nivel I",color:"#10b981"}:e<=120?{level:"ii",label:"Nivel II",color:"#84cc16"}:e<=500?{level:"iii",label:"Nivel III",color:"#f59e0b"}:e<=1e3?{level:"iv",label:"Nivel IV",color:"#f97316"}:{level:"v",label:"Nivel V",color:"#ef4444"}}}]);var e,n,t,r}();function He(e){return new Re(e)}var Be=function(){return u((function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"matriz-dashboard-container";l(this,e),this.container=document.getElementById(n),this.data=null,this.filteredData=null,this.sortConfig={column:null,direction:"asc"},this.searchTerm="",this.filters={nivel:"",cargo:"",tipo:""},this.documento=null}),[{key:"init",value:(n=c(g().mark((function e(n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(" [MATRIZ] Initializing component with data:",n),this.container){e.next=4;break}return console.error(" [MATRIZ] Container not found"),e.abrupt("return");case 4:this.data=this.processAPIData(n),this.filteredData=m(this.data),this.documento=n.documento||null,this.render(),this.attachEventListeners(),window.lucide&&window.lucide.createIcons();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"processAPIData",value:function(e){if(!e||!e.categorias)return[];var n=[];return Object.values(e.categorias).forEach((function(e){e.peligros.forEach((function(t){n.push({id:t.id,cargo:t.cargo,area:t.area,tipo:e.nombre,descripcion:t.descripcion,nd:t.niveles.nd,ne:t.niveles.ne,nc:t.niveles.nc,np:t.niveles.np,nr:t.niveles.nr,nrNivel:t.niveles.nrNivel,niveles:t.niveles,interpretacion:t.interpretacion,controles:t.controles,controlesExistentes:t.controlesExistentes,tieneControlesExistentes:t.tieneControlesExistentes,requiereAccionUrgente:t.requiereAccionUrgente,sugerenciasIA:t.sugerenciasIA})}))})),console.log(" [MATRIZ] Processed risks:",n.length),n}},{key:"calculateMetrics",value:function(){var e={total:this.data.length,critical:this.data.filter((function(e){return"V"===e.nrNivel})).length,high:this.data.filter((function(e){return"IV"===e.nrNivel})).length,medium:this.data.filter((function(e){return"III"===e.nrNivel})).length,low:this.data.filter((function(e){return"II"===e.nrNivel||"I"===e.nrNivel})).length};return e}},{key:"getFilterOptions",value:function(){return{cargos:m(new Set(this.data.map((function(e){return e.cargo})))).sort(),tipos:m(new Set(this.data.map((function(e){return e.tipo})))).sort(),niveles:["I","II","III","IV","V"]}}},{key:"render",value:function(){var e=this,n=this.calculateMetrics(),t=this.getFilterOptions();this.container.innerHTML='\n            \x3c!-- Metrics Cards --\x3e\n            <div class="matriz-metrics-grid">\n                '.concat(this.renderMetricCard("Total de Peligros",n.total,"layout-grid",""),"\n                ").concat(this.renderMetricCard("Nivel V - Cr铆tico",n.critical,"alert-octagon","critical"),"\n                ").concat(this.renderMetricCard("Nivel IV - Alto",n.high,"alert-triangle","high"),"\n                ").concat(this.renderMetricCard("Nivel III - Moderado",n.medium,"alert-circle","medium"),"\n                ").concat(this.renderMetricCard("Nivel I-II - Aceptable",n.low,"check-circle","low"),'\n            </div>\n\n            \x3c!-- Toolbar: Search & Filters --\x3e\n            <div class="matriz-toolbar">\n                <div class="matriz-search">\n                    <i data-lucide="search" class="matriz-search__icon"></i>\n                    <input\n                        type="text"\n                        class="matriz-search__input"\n                        placeholder="Buscar por descripci贸n, cargo o 谩rea..."\n                        id="matriz-search-input"\n                        value="').concat(this.searchTerm,'"\n                    />\n                </div>\n\n                <div class="matriz-filters">\n                    <div class="filter-dropdown">\n                        <select id="filter-nivel">\n                            <option value="">Todos los niveles</option>\n                            ').concat(t.niveles.map((function(n){return'\n                                <option value="'.concat(n,'" ').concat(e.filters.nivel===n?"selected":"",">\n                                    Nivel ").concat(n,"\n                                </option>\n                            ")})).join(""),'\n                        </select>\n                    </div>\n\n                    <div class="filter-dropdown">\n                        <select id="filter-cargo">\n                            <option value="">Todos los cargos</option>\n                            ').concat(t.cargos.map((function(n){return'\n                                <option value="'.concat(n,'" ').concat(e.filters.cargo===n?"selected":"",">\n                                    ").concat(n,"\n                                </option>\n                            ")})).join(""),'\n                        </select>\n                    </div>\n\n                    <div class="filter-dropdown">\n                        <select id="filter-tipo">\n                            <option value="">Todos los tipos</option>\n                            ').concat(t.tipos.map((function(n){return'\n                                <option value="'.concat(n,'" ').concat(e.filters.tipo===n?"selected":"",">\n                                    ").concat(n,"\n                                </option>\n                            ")})).join(""),'\n                        </select>\n                    </div>\n                </div>\n\n                <div class="matriz-actions">\n                    <button class="btn btn--icon" id="btn-reset-filters" title="Limpiar filtros">\n                        <i data-lucide="rotate-ccw"></i>\n                    </button>\n                </div>\n            </div>\n\n            \x3c!-- Table Container --\x3e\n            <div class="matriz-table-container">\n                ').concat(this.renderTable(),'\n            </div>\n\n            \x3c!-- Results Count --\x3e\n            <div class="matriz-results-count">\n                Mostrando <strong>').concat(this.filteredData.length,"</strong> de <strong>").concat(this.data.length,"</strong> peligros\n            </div>\n        "),window.lucide&&window.lucide.createIcons()}},{key:"renderMetricCard",value:function(e,n,t,a){return'\n            <div class="metric-card '.concat(a?"metric-card--".concat(a):"",'">\n                <div class="metric-card__icon">\n                    <i data-lucide="').concat(t,'"></i>\n                </div>\n                <div class="metric-card__value">').concat(n,'</div>\n                <div class="metric-card__label">').concat(e,"</div>\n            </div>\n        ")}},{key:"renderTable",value:function(){var e=this;return 0===this.filteredData.length?this.renderEmptyState():'\n            <table class="matriz-table">\n                <thead>\n                    <tr>\n                        '.concat(this.renderTableHeader("cargo","Cargo"),"\n                        ").concat(this.renderTableHeader("area","rea"),"\n                        ").concat(this.renderTableHeader("tipo","Tipo de Riesgo"),"\n                        ").concat(this.renderTableHeader("descripcion","Descripci贸n del Peligro"),"\n                        ").concat(this.renderTableHeader("nd","ND"),"\n                        ").concat(this.renderTableHeader("ne","NE"),"\n                        ").concat(this.renderTableHeader("nc","NC"),"\n                        ").concat(this.renderTableHeader("np","NP"),"\n                        ").concat(this.renderTableHeader("nr","NR"),"\n                        <th>Nivel</th>\n                        <th>Acciones</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ").concat(this.filteredData.map((function(n){return e.renderTableRow(n)})).join(""),"\n                </tbody>\n            </table>\n        ")}},{key:"renderTableHeader",value:function(e,n){var t=this.sortConfig.column===e?"sorted-".concat(this.sortConfig.direction):"";return'\n            <th class="sortable '.concat(t,'" data-column="').concat(e,'">\n                ').concat(n,"\n            </th>\n        ")}},{key:"renderTableRow",value:function(e){return'\n            <tr class="row-expandable" data-risk-id="'.concat(e.id,'">\n                <td class="cell-cargo">').concat(e.cargo,"</td>\n                <td>").concat(e.area||"N/A",'</td>\n                <td>\n                    <span class="risk-badge risk-badge--tipo">').concat(e.tipo,'</span>\n                </td>\n                <td class="cell-riesgo">').concat(e.descripcion,'</td>\n                <td class="cell-nr">').concat(e.nd,'</td>\n                <td class="cell-nr">').concat(e.ne,'</td>\n                <td class="cell-nr">').concat(e.nc,'</td>\n                <td class="cell-nr">').concat(e.np,'</td>\n                <td class="cell-nr"><strong>').concat(e.nr,"</strong></td>\n                <td>\n                    ").concat(this.renderNRBadge(e.nrNivel),'\n                </td>\n                <td>\n                    <button class="btn btn--icon btn--sm" data-action="expand" data-risk-id="').concat(e.id,'">\n                        <i data-lucide="chevron-down"></i>\n                    </button>\n                </td>\n            </tr>\n            <tr class="risk-details" id="details-').concat(e.id,'">\n                <td colspan="11">\n                    <div class="risk-details-content">\n                        ').concat(this.renderRiskDetails(e),"\n                    </div>\n                </td>\n            </tr>\n        ")}},{key:"renderNRBadge",value:function(e){var n=e.toLowerCase();return'<span class="risk-badge risk-badge--nr risk-badge--nr-'.concat(n,'">Nivel ').concat(e,"</span>")}},{key:"renderRiskDetails",value:function(e){var n,t,a,r,i,o,s,c,l,d,u,p,g,v,m,h,f=e.requiereAccionUrgente||"V"===e.nrNivel||"IV"===e.nrNivel||e.np&&e.np>=10,b=this.isControlEmpty(null===(n=e.controlesExistentes)||void 0===n?void 0:n.fuente),y=this.isControlEmpty(null===(t=e.controlesExistentes)||void 0===t?void 0:t.medio),_=this.isControlEmpty(null===(a=e.controlesExistentes)||void 0===a?void 0:a.individuo),w=this.getRiskLevelIcon(e.nrNivel),x=(e.nrNivel||"iii").toLowerCase();return'\n            <div class="risk-expanded-panel">\n                \x3c!-- FILA 1: Interpretaci贸n + Controles Existentes --\x3e\n                <div class="risk-panel-row risk-panel-row--primary">\n                    \x3c!-- Columna 1: Interpretaci贸n del Riesgo --\x3e\n                    <div class="risk-panel-card risk-panel-card--interpretation">\n                        <div class="risk-panel-card__header">\n                            <div class="risk-level-indicator risk-level-indicator--'.concat(x,'">\n                                ').concat(w,'\n                            </div>\n                            <div class="risk-panel-card__title">\n                                <span class="label">Interpretaci贸n del Riesgo</span>\n                                <span class="level-badge level-badge--').concat(x,'">\n                                    Nivel ').concat(e.nrNivel||"N/A",'\n                                </span>\n                            </div>\n                        </div>\n                        <div class="risk-panel-card__body">\n                            <p class="interpretation-meaning">\n                                <strong>').concat((null===(r=e.interpretacion)||void 0===r?void 0:r.significado)||"Sin interpretaci贸n",'</strong>\n                            </p>\n                            <p class="interpretation-action">\n                                ').concat((null===(i=e.interpretacion)||void 0===i?void 0:i.accion)||"",'\n                            </p>\n                        </div>\n                    </div>\n\n                    \x3c!-- Columna 2: Control en Fuente --\x3e\n                    <div class="risk-panel-card risk-panel-card--control ').concat(b&&f?"risk-panel-card--warning":"",'">\n                        ').concat(b&&f?'\n                            <div class="control-warning-float">\n                                <i data-lucide="alert-triangle"></i>\n                                <span>Sin control</span>\n                            </div>\n                        ':"",'\n                        <div class="risk-panel-card__header">\n                            <i data-lucide="target" class="control-icon"></i>\n                            <span class="risk-panel-card__title">Fuente</span>\n                        </div>\n                        <div class="risk-panel-card__body">\n                            ').concat(this.renderControlContent(null===(o=e.controlesExistentes)||void 0===o?void 0:o.fuente),'\n                        </div>\n                    </div>\n\n                    \x3c!-- Columna 3: Control en Medio --\x3e\n                    <div class="risk-panel-card risk-panel-card--control ').concat(y&&f?"risk-panel-card--warning":"",'">\n                        ').concat(y&&f?'\n                            <div class="control-warning-float">\n                                <i data-lucide="alert-triangle"></i>\n                                <span>Sin control</span>\n                            </div>\n                        ':"",'\n                        <div class="risk-panel-card__header">\n                            <i data-lucide="layers" class="control-icon"></i>\n                            <span class="risk-panel-card__title">Medio</span>\n                        </div>\n                        <div class="risk-panel-card__body">\n                            ').concat(this.renderControlContent(null===(s=e.controlesExistentes)||void 0===s?void 0:s.medio),'\n                        </div>\n                    </div>\n\n                    \x3c!-- Columna 4: Control en Individuo --\x3e\n                    <div class="risk-panel-card risk-panel-card--control ').concat(_&&f?"risk-panel-card--warning":"",'">\n                        ').concat(_&&f?'\n                            <div class="control-warning-float">\n                                <i data-lucide="alert-triangle"></i>\n                                <span>Sin control</span>\n                            </div>\n                        ':"",'\n                        <div class="risk-panel-card__header">\n                            <i data-lucide="user-check" class="control-icon"></i>\n                            <span class="risk-panel-card__title">Individuo</span>\n                        </div>\n                        <div class="risk-panel-card__body">\n                            ').concat(this.renderControlContent(null===(c=e.controlesExistentes)||void 0===c?void 0:c.individuo),"\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Bot贸n de Sugerencias IA (si hay riesgo alto) --\x3e\n                ").concat(f&&e.sugerenciasIA?'\n                    <div class="risk-panel-suggestions-bar">\n                        <button class="btn-suggestions" data-risk-id="'.concat(e.id,'">\n                            <i data-lucide="lightbulb"></i>\n                            <span>Ver sugerencias para reducir este riesgo</span>\n                            <i data-lucide="chevron-right" class="arrow"></i>\n                        </button>\n                    </div>\n\n                    \x3c!-- Tooltip de sugerencias (position: fixed) --\x3e\n                    <div class="sugerencias-ia-tooltip" id="sugerencias-').concat(e.id,'">\n                        <div class="sugerencias-ia-tooltip__header">\n                            <i data-lucide="sparkles"></i>\n                            <span>Sugerencias para reducir el riesgo</span>\n                        </div>\n                        <div class="sugerencias-ia-tooltip__body">\n                            ').concat(null!==(l=e.sugerenciasIA.fuente)&&void 0!==l&&l.length?'\n                                <div class="sugerencia-grupo">\n                                    <span class="sugerencia-label">En la Fuente</span>\n                                    <ul>'.concat(e.sugerenciasIA.fuente.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ul>\n                                </div>\n                            "):"","\n                            ").concat(null!==(d=e.sugerenciasIA.medio)&&void 0!==d&&d.length?'\n                                <div class="sugerencia-grupo">\n                                    <span class="sugerencia-label">En el Medio</span>\n                                    <ul>'.concat(e.sugerenciasIA.medio.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ul>\n                                </div>\n                            "):"","\n                            ").concat(null!==(u=e.sugerenciasIA.individuo)&&void 0!==u&&u.length?'\n                                <div class="sugerencia-grupo">\n                                    <span class="sugerencia-label">En el Individuo</span>\n                                    <ul>'.concat(e.sugerenciasIA.individuo.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ul>\n                                </div>\n                            "):"","\n                        </div>\n                    </div>\n                "):"","\n\n                \x3c!-- FILA 2: Medidas de Intervenci贸n Sugeridas --\x3e\n                ").concat(this.hasControlesSugeridos(e)?'\n                    <div class="risk-panel-row risk-panel-row--controls">\n                        <div class="risk-panel-section-header">\n                            <i data-lucide="shield-check"></i>\n                            <span>Medidas de Intervenci贸n Sugeridas (ISO 45001)</span>\n                        </div>\n                        <div class="risk-panel-controls-grid">\n                            '.concat(this.renderControlSugerido(null===(p=e.controles)||void 0===p?void 0:p.eliminacion,"Eliminaci贸n",1,"eliminacion"),"\n                            ").concat(this.renderControlSugerido(null===(g=e.controles)||void 0===g?void 0:g.sustitucion,"Sustituci贸n",2,"sustitucion"),"\n                            ").concat(this.renderControlSugerido(null===(v=e.controles)||void 0===v?void 0:v.ingenieria,"Ingenier铆a",3,"ingenieria"),"\n                            ").concat(this.renderControlSugerido(null===(m=e.controles)||void 0===m?void 0:m.administrativos,"Administrativos",4,"administrativos"),"\n                            ").concat(this.renderControlSugerido(null===(h=e.controles)||void 0===h?void 0:h.epp,"EPP",5,"epp"),"\n                        </div>\n                    </div>\n                "):"","\n            </div>\n        ")}},{key:"isControlEmpty",value:function(e){if(!e)return!0;var n=(Array.isArray(e)?e:[e]).filter((function(e){return e&&"string"==typeof e&&e.trim()}));return 0===n.length}},{key:"getRiskLevelIcon",value:function(e){var n={V:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>\n                    <line x1="12" y1="9" x2="12" y2="13"></line>\n                    <line x1="12" y1="17" x2="12.01" y2="17"></line>\n                  </svg>',IV:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>\n                    <line x1="12" y1="9" x2="12" y2="13"></line>\n                    <line x1="12" y1="17" x2="12.01" y2="17"></line>\n                  </svg>',III:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                     <circle cx="12" cy="12" r="10"></circle>\n                     <line x1="12" y1="8" x2="12" y2="12"></line>\n                     <line x1="12" y1="16" x2="12.01" y2="16"></line>\n                   </svg>',II:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <circle cx="12" cy="12" r="10"></circle>\n                    <line x1="12" y1="16" x2="12" y2="12"></line>\n                    <line x1="12" y1="8" x2="12.01" y2="8"></line>\n                  </svg>',I:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                   <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>\n                   <polyline points="22 4 12 14.01 9 11.01"></polyline>\n                 </svg>'};return n[e]||n.III}},{key:"renderControlContent",value:function(e){if(!e)return'<p class="control-empty">No especificado</p>';var n=(Array.isArray(e)?e:[e]).filter((function(e){return e&&"string"==typeof e&&e.trim()}));return 0===n.length?'<p class="control-empty">No especificado</p>':'\n            <ul class="control-list">\n                '.concat(n.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"\n            </ul>\n        ")}},{key:"hasControlesSugeridos",value:function(e){var n,t,a,r,i;return e.controles&&((null===(n=e.controles.eliminacion)||void 0===n?void 0:n.length)>0||(null===(t=e.controles.sustitucion)||void 0===t?void 0:t.length)>0||(null===(a=e.controles.ingenieria)||void 0===a?void 0:a.length)>0||(null===(r=e.controles.administrativos)||void 0===r?void 0:r.length)>0||(null===(i=e.controles.epp)||void 0===i?void 0:i.length)>0)}},{key:"renderControlSugerido",value:function(e,n,t,a){if(!e||0===e.length)return"";var r=(Array.isArray(e)?e:[e]).filter((function(e){return e&&"string"==typeof e&&e.trim()}));return 0===r.length?"":'\n            <div class="control-sugerido control-sugerido--'.concat(a,'">\n                <div class="control-sugerido__header">\n                    <span class="control-sugerido__badge">').concat(t,'</span>\n                    <span class="control-sugerido__title">').concat(n,'</span>\n                </div>\n                <ul class="control-sugerido__list">\n                    ').concat(r.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"\n                </ul>\n            </div>\n        ")}},{key:"attachTooltipEventListeners",value:function(){var e=this;this.container.querySelectorAll(".btn-suggestions").forEach((function(n){var t=n.dataset.riskId,a=document.getElementById("sugerencias-".concat(t));a&&n.addEventListener("click",(function(t){t.stopPropagation(),e.container.querySelectorAll(".sugerencias-ia-tooltip.active").forEach((function(e){e!==a&&e.classList.remove("active")})),e.positionTooltip(n,a),a.classList.toggle("active")}))})),document.addEventListener("click",(function(n){n.target.closest(".btn-suggestions")||n.target.closest(".sugerencias-ia-tooltip")||e.container.querySelectorAll(".sugerencias-ia-tooltip.active").forEach((function(e){e.classList.remove("active")}))}));var n=this.container.querySelector(".matriz-table-container");n&&n.addEventListener("scroll",(function(){e.container.querySelectorAll(".sugerencias-ia-tooltip.active").forEach((function(n){var t=n.id.replace("sugerencias-",""),a=e.container.querySelector('.btn-suggestions[data-risk-id="'.concat(t,'"]'));a&&e.positionTooltip(a,n)}))}))}},{key:"positionTooltip",value:function(e,n){var t=e.getBoundingClientRect(),a=window.innerWidth,r=window.innerHeight,i=t.right+12;i+380>a-20&&(i=t.left-380-12),i<20&&(i=Math.max(20,(a-380)/2));var o=t.top;o+400>r-20&&(o=r-400-20),o<20&&(o=20),n.style.left="".concat(i,"px"),n.style.top="".concat(o,"px")}},{key:"renderEmptyState",value:function(){return'\n            <div class="matriz-empty-state">\n                <div class="matriz-empty-state__icon">\n                    <i data-lucide="search-x"></i>\n                </div>\n                <h3 class="matriz-empty-state__title">No se encontraron peligros</h3>\n                <p class="matriz-empty-state__description">\n                    '.concat(this.searchTerm||Object.values(this.filters).some((function(e){return e}))?"Intenta ajustar los filtros de b煤squeda":"A煤n no hay peligros identificados en la matriz","\n                </p>\n                ").concat(this.searchTerm||Object.values(this.filters).some((function(e){return e}))?'\n                    <button class="btn btn--outline" id="btn-clear-search">\n                        <i data-lucide="rotate-ccw"></i>\n                        Limpiar b煤squeda\n                    </button>\n                ':"","\n            </div>\n        ")}},{key:"attachEventListeners",value:function(){var e=this,n=document.getElementById("matriz-search-input");n&&n.addEventListener("input",(function(n){e.searchTerm=n.target.value.toLowerCase(),e.applyFilters()})),["nivel","cargo","tipo"].forEach((function(n){var t=document.getElementById("filter-".concat(n));t&&t.addEventListener("change",(function(t){e.filters[n]=t.target.value,e.applyFilters()}))}));var t=document.getElementById("btn-reset-filters");t&&t.addEventListener("click",(function(){return e.resetFilters()})),this.container.querySelectorAll("th.sortable").forEach((function(n){n.addEventListener("click",(function(n){var t=n.currentTarget.dataset.column;e.sortTable(t)}))})),this.container.querySelectorAll('[data-action="expand"]').forEach((function(n){n.addEventListener("click",(function(n){n.stopPropagation();var t=n.currentTarget.dataset.riskId;e.toggleRowDetails(t,n.currentTarget)}))}));var a=document.getElementById("btn-clear-search");a&&a.addEventListener("click",(function(){return e.resetFilters()})),this.attachTooltipEventListeners()}},{key:"applyFilters",value:function(){var e=this;this.filteredData=this.data.filter((function(n){if(e.searchTerm&&!"".concat(n.descripcion," ").concat(n.cargo," ").concat(n.area).toLowerCase().includes(e.searchTerm))return!1;return(!e.filters.nivel||n.nrNivel===e.filters.nivel)&&((!e.filters.cargo||n.cargo===e.filters.cargo)&&(!e.filters.tipo||n.tipo===e.filters.tipo))}));var n=this.container.querySelector(".matriz-table-container");n&&(n.innerHTML=this.renderTable(),this.attachTableEventListeners());var t=this.container.querySelector(".matriz-results-count");t&&(t.innerHTML="Mostrando <strong>".concat(this.filteredData.length,"</strong> de <strong>").concat(this.data.length,"</strong> peligros")),window.lucide&&window.lucide.createIcons()}},{key:"resetFilters",value:function(){this.searchTerm="",this.filters={nivel:"",cargo:"",tipo:""},this.sortConfig={column:null,direction:"asc"},this.render(),this.attachEventListeners()}},{key:"exportExcel",value:(e=c(g().mark((function e(){var n,t,a,r,i,o,s,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.documento&&this.documento.excelUrl){e.next=4;break}return console.error("No Excel URL available"),alert("No hay archivo Excel disponible para descargar"),e.abrupt("return");case 4:if(n=document.getElementById("btn-export-matriz-excel")){e.next=7;break}return e.abrupt("return");case 7:return t=n.innerHTML,n.disabled=!0,n.innerHTML='<i data-lucide="loader-2" class="animate-spin"></i> <span>Descargando...</span>',window.lucide&&window.lucide.createIcons(),e.prev=11,e.next=14,fetch(this.documento.excelUrl);case 14:if((a=e.sent).ok){e.next=17;break}throw new Error("Error al descargar el archivo");case 17:return e.next=19,a.blob();case 19:r=e.sent,i=window.URL.createObjectURL(r),(o=document.createElement("a")).href=i,s=this.documento.excelUrl.split("/"),c=s[s.length-1]||"Matriz_GTC45.xlsx",o.download=c,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(i),o.remove(),e.next=36;break;case 32:e.prev=32,e.t0=e.catch(11),console.error("Error exporting matriz:",e.t0),alert("Error al descargar el archivo Excel. Intente de nuevo.");case 36:return e.prev=36,n.disabled=!1,n.innerHTML=t,window.lucide&&window.lucide.createIcons(),e.finish(36);case 41:case"end":return e.stop()}}),e,this,[[11,32,36,41]])}))),function(){return e.apply(this,arguments)})},{key:"sortTable",value:function(e){var n=this;this.sortConfig.column===e?this.sortConfig.direction="asc"===this.sortConfig.direction?"desc":"asc":(this.sortConfig.column=e,this.sortConfig.direction="asc"),this.filteredData.sort((function(t,a){var r=t[e],i=a[e];return["nd","ne","nc","np","nr"].includes(e)?(r=Number(r),i=Number(i)):(r=String(r||"").toLowerCase(),i=String(i||"").toLowerCase()),r<i?"asc"===n.sortConfig.direction?-1:1:r>i?"asc"===n.sortConfig.direction?1:-1:0}));var t=this.container.querySelector(".matriz-table-container");t&&(t.innerHTML=this.renderTable(),this.attachTableEventListeners()),window.lucide&&window.lucide.createIcons()}},{key:"toggleRowDetails",value:function(e,n){var t=this.container.querySelector(".matriz-table-container");if(t){var a=t.querySelector("#details-".concat(e));if(!a)return console.error("Details row not found for risk:",e),void console.log("Available detail rows:",t.querySelectorAll(".risk-details"));var r=a.classList.contains("expanded");if(r?a.classList.remove("expanded"):a.classList.add("expanded"),n){var i=r?"chevron-down":"chevron-up";n.innerHTML='<i data-lucide="'.concat(i,'"></i>'),window.lucide&&window.lucide.createIcons()}}else console.error("Table container not found")}},{key:"attachTableEventListeners",value:function(){var e=this;this.container.querySelectorAll("th.sortable").forEach((function(n){n.addEventListener("click",(function(n){var t=n.currentTarget.dataset.column;e.sortTable(t)}))})),this.container.querySelectorAll('[data-action="expand"]').forEach((function(n){n.addEventListener("click",(function(n){n.stopPropagation();var t=n.currentTarget.dataset.riskId;e.toggleRowDetails(t,n.currentTarget)}))}));var n=document.getElementById("btn-clear-search");n&&n.addEventListener("click",(function(){return e.resetFilters()})),this.attachTooltipEventListeners()}}]);var e,n}();const Ge=Be;function qe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Ve(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?qe(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ue={currentPage:"home",companyId:null,companyName:"",user:null,isLoading:!1,data:{summary:null,alerts:null,conditions:null,risks:null,examenes:null,cargos:null,matriz:null}},Fe="#sidebar",We="#sidebar-toggle",Je="#sidebar-overlay",Ze="#mobile-menu-toggle",Ke=".sidebar-nav__item",Xe=".dashboard-page",Ye=function(){return u((function e(){l(this,e),this.pages=new Map,this.currentPage=null,this.init()}),[{key:"init",value:function(){var e=this;document.querySelectorAll(Xe).forEach((function(n){var t=n.dataset.page;e.pages.set(t,n)})),this.bindNavEvents(),this.bindSidebarEvents();var n=window.location.hash.replace("#","")||"home";this.navigateTo(n)}},{key:"bindNavEvents",value:function(){var e=this;document.querySelectorAll(Ke).forEach((function(n){n.addEventListener("click",(function(t){t.preventDefault();var a=n.dataset.page;a&&e.navigateTo(a)}))})),document.querySelectorAll("[data-navigate]").forEach((function(n){n.addEventListener("click",(function(t){t.preventDefault();var a=n.dataset.navigate;a&&e.navigateTo(a)}))})),window.addEventListener("popstate",(function(){var n=window.location.hash.replace("#","")||"home";e.navigateTo(n,!1)}))}},{key:"bindSidebarEvents",value:function(){var e=document.querySelector(Fe),n=document.querySelector(We),t=document.querySelector(Je),a=document.querySelector(Ze);n&&n.addEventListener("click",(function(){e.classList.toggle("collapsed"),document.querySelector(".dashboard-main").classList.toggle("sidebar-collapsed")})),a&&a.addEventListener("click",(function(){e.classList.toggle("open"),t.classList.toggle("visible")})),t&&t.addEventListener("click",(function(){e.classList.remove("open"),t.classList.remove("visible")}))}},{key:"navigateTo",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.pages.has(e)||(console.warn('Page "'.concat(e,'" not found')),e="home"),this.pages.forEach((function(e,n){e.style.display="none"}));var t=this.pages.get(e);t&&(t.style.display="block"),document.querySelectorAll(Ke).forEach((function(n){n.classList.remove("active"),n.dataset.page===e&&n.classList.add("active")})),this.currentPage=e,Ue.currentPage=e,n&&window.history.pushState({page:e},"","#".concat(e));var a=document.querySelector(Fe),r=document.querySelector(Je);a&&a.classList.remove("open"),r&&r.classList.remove("visible"),this.loadPageData(e),window.lucide&&window.lucide.createIcons(),console.log("Navigated to: ".concat(e))}},{key:"loadPageData",value:(e=c(g().mark((function e(n){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t={home:Qe,inteligencia:cn,"mapa-org":dn,cargos:pn,examenes:vn,matriz:hn,estadisticas:yn,sve:wn,psicosocial:En,documentos:Cn,profesiograma:Pn,config:In,"panel-medico":Nn}[n])){e.next=11;break}return e.prev=3,e.next=6,t();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("Error loading page ".concat(n,":"),e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])}))),function(n){return e.apply(this,arguments)})}]);var e}();function Qe(){return en.apply(this,arguments)}function en(){return(en=c(g().mark((function e(){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading Dashboard Home..."),e.prev=1,nn(),e.next=5,an();case 5:(n=e.sent)&&on(n),sn("donut-cumplimiento",87),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error loading dashboard home:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function nn(){var e=new Date,n=document.getElementById("last-update"),t=document.getElementById("next-update");if(n&&(n.textContent="Hoy ".concat(tn(e))),t){var a=new Date(e.getTime()+216e5);t.textContent="Hoy ".concat(tn(a))}}function tn(e){return e.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit",hour12:!0}).toUpperCase()}function an(){return rn.apply(this,arguments)}function rn(){return(rn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{cumplimiento:87,trabajadores:{total:53,alDia:45,alertas:8},alertas:{total:8,vencidos:3,proximos:5},examenes:{vencidos:3,proximos:5},riesgos:{nivelV:8,nivelIV:15,total:34},condiciones:{hipoacusia:15,trend:3},sve:3,peligros:122});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function on(e){On("cumplimiento-value",e.cumplimiento),On("total-trabajadores",e.trabajadores.total),On("trabajadores-aldia",e.trabajadores.alDia),On("trabajadores-alertas",e.trabajadores.alertas),On("total-alertas",e.alertas.total),On("alertas-vencidos",e.alertas.vencidos),On("alertas-proximos",e.alertas.proximos),On("hipoacusia-percent","".concat(e.condiciones.hipoacusia,"%")),On("condition-trend-text","+".concat(e.condiciones.trend,"% vs trimestre")),On("examenes-vencidos",e.examenes.vencidos),On("examenes-proximos",e.examenes.proximos),On("riesgos-v",e.riesgos.nivelV),On("riesgos-iv",e.riesgos.nivelIV),On("riesgos-total",e.riesgos.total),On("stat-cumplimiento","".concat(e.cumplimiento,"%")),On("stat-examenes-dia",e.trabajadores.alDia),On("stat-total-trabajadores",e.trabajadores.total),On("stat-sve-activos",e.sve),On("stat-peligros",e.peligros),On("insight-pattern-text","Aumento 15% deterioro auditivo en soldadores 煤ltimos 6 meses"),On("insight-recommendation-text","Auditor铆a uso EPP + medir ruido")}function sn(e,n){var t=document.getElementById(e);if(t){var a=160,r=2*Math.PI*74,i=r-n/100*r;t.innerHTML='\n        <svg width="'.concat(a,'" height="').concat(a,'" viewBox="0 0 ').concat(a," ").concat(a,'">\n            \x3c!-- Background circle --\x3e\n            <circle\n                cx="').concat(80,'"\n                cy="').concat(80,'"\n                r="').concat(74,'"\n                fill="none"\n                stroke="#e5e7eb"\n                stroke-width="').concat(12,'"\n            />\n            \x3c!-- Progress circle --\x3e\n            <circle\n                cx="').concat(80,'"\n                cy="').concat(80,'"\n                r="').concat(74,'"\n                fill="none"\n                stroke="#5dc4af"\n                stroke-width="').concat(12,'"\n                stroke-linecap="round"\n                stroke-dasharray="').concat(r,'"\n                stroke-dashoffset="').concat(i,'"\n                transform="rotate(-90 ').concat(80," ").concat(80,')"\n                style="transition: stroke-dashoffset 0.5s ease;"\n            />\n            \x3c!-- Center text --\x3e\n            <text\n                x="').concat(80,'"\n                y="').concat(80,'"\n                text-anchor="middle"\n                dominant-baseline="middle"\n                font-family="Poppins, sans-serif"\n                font-size="36"\n                font-weight="700"\n                fill="#383d47"\n            >').concat(n,"%</text>\n        </svg>\n    ")}}function cn(){return ln.apply(this,arguments)}function ln(){return(ln=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Intelligence Page..."),Tn("inteligencia-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="brain"></i>\n            </div>\n            <h3 class="empty-state__title">Inteligencia de Salud</h3>\n            <p class="empty-state__description">A煤n no hay datos disponibles. Complete el wizard de riesgos para generar an谩lisis de salud.</p>\n            <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Iniciar Wizard</a>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dn(){return un.apply(this,arguments)}function un(){return(un=c(g().mark((function e(){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Org Map Page..."),(n=document.getElementById("org-chart-canvas"))&&(n.innerHTML='\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="network"></i>\n                </div>\n                <h3 class="empty-state__title">Mapa Organizacional</h3>\n                <p class="empty-state__description">A煤n no hay datos disponibles. Agregue cargos para visualizar la estructura organizacional.</p>\n            </div>\n        ',window.lucide&&window.lucide.createIcons());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pn(){return gn.apply(this,arguments)}function gn(){return gn=c(g().mark((function e(){var n,t,a,r,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(" [CARGOS] ========== Loading Cargos Page =========="),Tn("cargos-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <div class="skeleton skeleton--circle" style="width:64px;height:64px;"></div>\n            </div>\n            <h3 class="empty-state__title">Cargando cargos...</h3>\n        </div>\n    '),e.next=4,$n();case 4:if(n=e.sent,console.log(" [CARGOS] API result:",n),n&&n.success){e.next=11;break}return console.log(" [CARGOS] No cargos found from API"),Tn("cargos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="users"></i>\n                </div>\n                <h3 class="empty-state__title">Gesti贸n de Cargos</h3>\n                <p class="empty-state__description">A煤n no hay cargos registrados. Complete el wizard para agregar cargos a la empresa.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Agregar Cargos</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 11:if(e.prev=11,t=n.cargos||[],console.log(" [CARGOS] Processing cargos from API:",t.length),0!==t.length){e.next=18;break}return Tn("cargos-content",'\n                <div class="empty-state">\n                    <div class="empty-state__icon">\n                        <i data-lucide="users"></i>\n                    </div>\n                    <h3 class="empty-state__title">Sin Cargos</h3>\n                    <p class="empty-state__description">No hay cargos configurados. Agregue cargos en el wizard.</p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Agregar Cargos</a>\n                </div>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 18:a=t.map((function(e,n){var t=e.riesgosCount||0,a=e.num_trabajadores||0,r=e.nrNivelMaximo||"I",i=e.togglesActivos||[],o=i.map((function(e){return'<span class="badge badge--warning"><i data-lucide="'.concat({Alturas:"mountain",Alimentos:"utensils",Vehiculo:"car","Espacios Conf.":"box"}[e]||"alert-triangle",'" style="width:12px;height:12px;"></i> ').concat(e,"</span>")})).join(""),s={I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[r]||"muted";return'\n                <div class="card">\n                    <div class="card__header">\n                        <h3 class="card__title">'.concat(e.nombre_cargo||"Cargo "+(n+1),'</h3>\n                        <div class="card__badges">\n                            <span class="badge badge--').concat(t>0?"primary":"muted",'">').concat(t," riesgo").concat(1!==t?"s":"","</span>\n                            ").concat(t>0?'<span class="badge badge--'.concat(s,'">NR ').concat(r,"</span>"):"",'\n                        </div>\n                    </div>\n                    <div class="card__body">\n                        <div class="cargo-info">\n                            <div class="cargo-info__row">\n                                <i data-lucide="map-pin" class="text-muted"></i>\n                                <span>').concat(e.area||"Sin 谩rea"," / ").concat(e.zona||"Sin zona",'</span>\n                            </div>\n                            <div class="cargo-info__row">\n                                <i data-lucide="users" class="text-muted"></i>\n                                <span>').concat(a," persona").concat(1!==a?"s":"","</span>\n                            </div>\n                            ").concat(i.length>0?'\n                                <div class="cargo-info__conditions mt-2">\n                                    '.concat(o,"\n                                </div>\n                            "):"",'\n                        </div>\n                    </div>\n                    <div class="card__footer">\n                        <button class="btn btn--sm btn--ghost btn-view-cargo" data-cargo-id="').concat(e.id,"\" data-cargo='").concat(JSON.stringify(e).replace(/'/g,"&#39;"),'\'>\n                            <i data-lucide="eye"></i> Ver detalles\n                        </button>\n                        <button class="btn btn--sm btn--outline btn-edit-cargo" data-cargo-id="').concat(e.id,"\" data-cargo='").concat(JSON.stringify(e).replace(/'/g,"&#39;"),'\'>\n                            <i data-lucide="edit-2"></i> Editar\n                        </button>\n                    </div>\n                </div>\n            ')})).join(""),r=t.reduce((function(e,n){return e+(n.num_trabajadores||0)}),0),i=t.filter((function(e){var n;return null===(n=e.togglesActivos)||void 0===n?void 0:n.includes("Alturas")})).length,t.filter((function(e){var n;return null===(n=e.togglesActivos)||void 0===n?void 0:n.includes("Espacios Conf.")})).length,o=t.reduce((function(e,n){return e+(n.riesgosCount||0)}),0),Tn("cargos-content",'\n            <div class="dashboard-grid dashboard-grid--cols-4 mb-6">\n                <div class="card card--stat">\n                    <div class="stat-value">'.concat(t.length,'</div>\n                    <div class="stat-label">Total Cargos</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(r,'</div>\n                    <div class="stat-label">Total Personas</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(o,'</div>\n                    <div class="stat-label">Total Riesgos</div>\n                </div>\n                <div class="card card--stat card--warning">\n                    <div class="stat-value stat-value--warning">').concat(i,'</div>\n                    <div class="stat-label">Trabajo en Alturas</div>\n                </div>\n            </div>\n            <div class="dashboard-grid dashboard-grid--cols-3">\n                ').concat(a,'\n            </div>\n            <div class="text-center mt-6">\n                <button class="btn btn--primary btn-nuevo-cargo-inline">\n                    <i data-lucide="plus"></i> Agregar Cargo\n                </button>\n            </div>\n        ')),window.lucide&&window.lucide.createIcons(),Zn(),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(11),console.error("Error loading cargos:",e.t0),Tn("cargos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="alert-circle"></i>\n                </div>\n                <h3 class="empty-state__title">Error</h3>\n                <p class="empty-state__description">Hubo un error al cargar los cargos.</p>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 33:case"end":return e.stop()}}),e,null,[[11,28]])}))),gn.apply(this,arguments)}function vn(){return mn.apply(this,arguments)}function mn(){return(mn=c(g().mark((function e(){var n,t,r,i,o,s,c,l,d,u,p,v,m,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(" [EXAMENES] ========== Loading Examenes Page =========="),n=jn(),console.log(" [EXAMENES] wizardData:",n?"found":"not found"),n){e.next=13;break}return On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar","0"),On("examenes-showing","Mostrando 0 de 0"),(t=document.getElementById("examenes-table-body"))&&(t.innerHTML='\n                <tr>\n                    <td colspan="7" class="table-empty">\n                        <div class="empty-state empty-state--inline">\n                            <i data-lucide="clipboard-list"></i>\n                            <span>Complete el wizard para ver los ex谩menes recomendados por cargo</span>\n                        </div>\n                    </td>\n                </tr>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 13:if(e.prev=13,r=n.formData||{},i=r.cargos||[],console.log(" [EXAMENES] Processing cargos:",i.length),0!==i.length){e.next=28;break}return console.log(" [EXAMENES] No cargos found"),On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar","0"),On("examenes-showing","Mostrando 0 de 0"),(o=document.getElementById("examenes-table-body"))&&(o.innerHTML='\n                    <tr>\n                        <td colspan="7" class="table-empty">\n                            <div class="empty-state empty-state--inline">\n                                <i data-lucide="users"></i>\n                                <span>No hay cargos configurados. Agregue cargos en el wizard.</span>\n                            </div>\n                        </td>\n                    </tr>\n                '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 28:s={EMO:"Examen M茅dico Ocupacional",EMOA:"EMO con 茅nfasis en Alturas",EMOMP:"EMO Manipuladores de Alimentos",OPTO:"Visiometr铆a",AUD:"Audiometr铆a",ECG:"Electrocardiograma",GLI:"Glicemia",PL:"Perfil Lip铆dico",PE:"Prueba de Esfuerzo",ESP:"Espirometr铆a",PSM:"Prueba Psicosensom茅trica",PST:"Prueba Psicot茅cnica",FRO:"Frotis de Garganta",KOH:"KOH (Examen Hongos)",COP:"Coprol贸gico"},c=["EMO","OPTO","AUD"],l={trabajaAlturas:["EMOA","GLI","PL","PE","ESP","ECG"],manipulaAlimentos:["EMOMP","FRO","KOH","COP"],conduceVehiculo:["PSM","PSP","GLI","PL"],trabajaEspaciosConfinados:["EMO","ESP","ECG","GLI","PL","PSM"],espaciosConfinados:["EMO","ESP","ECG","GLI","PL","PSM"]},d=0,u=0,p=[],i.forEach((function(e){var n=new Set(c);Object.entries(l).forEach((function(t){var r=a(t,2),i=r[0],o=r[1];e[i]&&o.forEach((function(e){return n.add(e)}))})),(e.gesSeleccionados||e.ges||[]).forEach((function(e){e.examenesMedicos&&Object.keys(e.examenesMedicos).forEach((function(e){return n.add(e)}))}));var t=Array.from(n),r=e.numPersonas||e.numTrabajadores||1;t.forEach((function(n){d++,u++,p.push('\n                    <tr>\n                        <td><input type="checkbox" class="examen-checkbox" data-cargo="'.concat(e.nombre,'" data-examen="').concat(n,'" /></td>\n                        <td>--</td>\n                        <td>\n                            <div class="cell-cargo">\n                                <strong>').concat(e.nombre||"Sin nombre",'</strong>\n                                <span class="text-xs text-muted">').concat(r," persona").concat(1!==r?"s":"",'</span>\n                            </div>\n                        </td>\n                        <td>\n                            <span class="badge badge--primary">').concat(n,'</span>\n                            <span class="text-sm">').concat(s[n]||n,'</span>\n                        </td>\n                        <td class="text-muted">Por programar</td>\n                        <td><span class="badge badge--warning">Por agendar</span></td>\n                        <td>\n                            <button class="btn btn--icon btn--sm" title="Agendar examen">\n                                <i data-lucide="calendar-plus"></i>\n                            </button>\n                        </td>\n                    </tr>\n                '))}))})),On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar",u.toString()),On("examenes-showing","Mostrando ".concat(d," de ").concat(d)),(v=document.getElementById("filter-cargo"))&&(v.innerHTML='<option value="">Cargo: Todos</option>',i.forEach((function(e){v.innerHTML+='<option value="'.concat(e.nombre,'">').concat(e.nombre,"</option>")}))),(m=document.getElementById("examenes-table-body"))&&(p.length>0?m.innerHTML=p.join(""):m.innerHTML='\n                    <tr>\n                        <td colspan="7" class="table-empty">\n                            <div class="empty-state empty-state--inline">\n                                <i data-lucide="check-circle"></i>\n                                <span>No hay ex谩menes pendientes</span>\n                            </div>\n                        </td>\n                    </tr>\n                '),window.lucide&&window.lucide.createIcons(),e.next=53;break;case 47:e.prev=47,e.t0=e.catch(13),console.error("Error loading examenes:",e.t0),(h=document.getElementById("examenes-table-body"))&&(h.innerHTML='\n                <tr>\n                    <td colspan="7" class="table-empty">\n                        <div class="empty-state empty-state--inline">\n                            <i data-lucide="alert-circle"></i>\n                            <span>Error al cargar los ex谩menes</span>\n                        </div>\n                    </td>\n                </tr>\n            '),window.lucide&&window.lucide.createIcons();case 53:case"end":return e.stop()}}),e,null,[[13,47]])})))).apply(this,arguments)}function hn(){return fn.apply(this,arguments)}function fn(){return(fn=c(g().mark((function e(){var n,t,a,r,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(" [MATRIZ] ========== Loading Matriz Page =========="),e.next=3,Hn();case 3:if(n=e.sent,console.log(" [MATRIZ] API result:",n),On("matriz-fecha",(new Date).toLocaleDateString("es-CO")),t=localStorage.getItem("genesys_empresa"),a="Sin asignar",t)try{r=JSON.parse(t),a=r.nombre_legal||r.razon_social||r.nombre||"Sin asignar"}catch(e){}if(On("matriz-responsable",a),n&&n.success){e.next=14;break}return(i=document.getElementById("matriz-dashboard-container"))&&(i.innerHTML='\n                <div class="matriz-empty-state">\n                    <div class="matriz-empty-state__icon">\n                        <i data-lucide="layout-grid"></i>\n                    </div>\n                    <h3 class="matriz-empty-state__title">Matriz de Riesgos GTC-45</h3>\n                    <p class="matriz-empty-state__description">\n                        A煤n no hay peligros identificados. Complete el wizard para generar la matriz de riesgos.\n                    </p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">\n                        <i data-lucide="plus"></i>\n                        Crear Matriz\n                    </a>\n                </div>\n            ',window.lucide&&window.lucide.createIcons()),e.abrupt("return");case 14:return e.prev=14,o=new Ge("matriz-dashboard-container"),e.next=18,o.init(n);case 18:console.log(" [MATRIZ] Component initialized successfully"),bn(n.documento),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(14),console.error(" [MATRIZ] Error initializing component:",e.t0),(s=document.getElementById("matriz-dashboard-container"))&&(s.innerHTML='\n                <div class="matriz-empty-state">\n                    <div class="matriz-empty-state__icon">\n                        <i data-lucide="alert-circle"></i>\n                    </div>\n                    <h3 class="matriz-empty-state__title">Error al cargar</h3>\n                    <p class="matriz-empty-state__description">\n                        Hubo un error al cargar los datos de la matriz. Intente recargar la p谩gina.\n                    </p>\n                </div>\n            ',window.lucide&&window.lucide.createIcons());case 27:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}function bn(e){var n=document.getElementById("btn-export-matriz-excel");if(n){var t=n.cloneNode(!0);n.parentNode.replaceChild(t,n),e&&e.excelUrl?t.addEventListener("click",(function(){var n=document.createElement("a");n.href=e.excelUrl,n.download=e.excelUrl.split("/").pop()||"Matriz_GTC45.xlsx",n.target="_blank",document.body.appendChild(n),n.click(),n.remove()})):t.style.display="none"}}function yn(){return _n.apply(this,arguments)}function _n(){return(_n=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Estadisticas Page..."),Tn("estadisticas-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="bar-chart-3"></i>\n            </div>\n            <h3 class="empty-state__title">Perfil Sociodemogr谩fico</h3>\n            <p class="empty-state__description">A煤n no hay datos disponibles. El perfil se generar谩 autom谩ticamente con los datos de trabajadores.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wn(){return xn.apply(this,arguments)}function xn(){return(xn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading SVE Page..."),Tn("sve-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="activity"></i>\n            </div>\n            <h3 class="empty-state__title">Sistema de Vigilancia Epidemiol贸gica</h3>\n            <p class="empty-state__description">A煤n no hay SVE configurados. Se generar谩n autom谩ticamente basados en los riesgos identificados.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function En(){return kn.apply(this,arguments)}function kn(){return(kn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Psicosocial Page..."),Tn("psicosocial-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="flask-conical"></i>\n            </div>\n            <h3 class="empty-state__title">Bater铆a de Riesgo Psicosocial</h3>\n            <p class="empty-state__description">A煤n no hay bater铆as aplicadas. Configure la empresa para comenzar la evaluaci贸n psicosocial.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cn(){return An.apply(this,arguments)}function An(){return(An=c(g().mark((function e(){var n,t,r,i,o,s,c,l,d,u,p,v,m,h,f,b;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(" [DOCUMENTOS] ========== Loading Documentos Page =========="),n=localStorage.getItem("genesys_empresa"),t=jn(),console.log(" [DOCUMENTOS] wizardData:",t?"found":"not found"),r=[],!n){e.next=23;break}if(e.prev=6,!(i=JSON.parse(n)).id){e.next=18;break}return o=localStorage.getItem("authToken")||localStorage.getItem("genesys_token"),e.next=12,fetch("/api/documentos/empresa/".concat(i.id),{headers:o?{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}:{"Content-Type":"application/json"}});case 12:if(!(s=e.sent).ok){e.next=18;break}return e.next=16,s.json();case 16:(c=e.sent).success&&c.documents&&(r=c.documents);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.warn("Error fetching documents from API:",e.t0);case 23:if(!(l=localStorage.getItem("genesys_pending_document_token"))||0!==r.length){e.next=39;break}return e.prev=25,e.next=28,fetch("/api/documentos/status/".concat(l));case 28:if(!(d=e.sent).ok){e.next=34;break}return e.next=32,d.json();case 32:(u=e.sent).success&&r.push({token_acceso:l,estado:u.status,preview_urls:u.urls||{},metadata:u.metadata||{},created_at:(new Date).toISOString()});case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(25),console.warn("Error fetching pending document:",e.t1);case 39:if(0!==r.length||!t){e.next=50;break}if(p=t.formData||{},v=p.cargos||[],console.log(" [DOCUMENTOS] Wizard cargos:",v.length),!(v.length>0)){e.next=50;break}return m=0,h=0,v.forEach((function(e){var n;m+=(null===(n=e.ges)||void 0===n?void 0:n.length)||0,h+=e.numPersonas||0})),Tn("documentos-content",'\n                <div class="alert-banner alert-banner--info mb-6">\n                    <i data-lucide="info"></i>\n                    <span>\n                        <strong>'.concat(p.nombreEmpresa||"Sin nombre","</strong> 路 NIT: ").concat(p.nit||"N/A"," 路\n                        ").concat(v.length," cargo(s), ").concat(h," trabajadores, ").concat(m,' riesgos identificados\n                    </span>\n                </div>\n\n                <div class="dashboard-section mb-6">\n                    <h2 class="dashboard-section__title">Documentos Disponibles para Generar</h2>\n                    <div class="dashboard-grid dashboard-grid--cols-4">\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="file-spreadsheet" style="width:48px;height:48px;color:#10b981;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Matriz GTC-45</h3>\n                                <p class="text-muted text-sm mb-4">Excel con ').concat(m,' peligros identificados</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="file-text" style="width:48px;height:48px;color:#5dc4af;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Profesiograma</h3>\n                                <p class="text-muted text-sm mb-4">PDF para ').concat(v.length,' cargo(s)</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="user-check" style="width:48px;height:48px;color:#f59e0b;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Perfil de Cargo</h3>\n                                <p class="text-muted text-sm mb-4">Requisitos por cargo</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="receipt" style="width:48px;height:48px;color:#6366f1;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Cotizaci贸n</h3>\n                                <p class="text-muted text-sm mb-4">Presupuesto de ex谩menes</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="dashboard-section mb-6">\n                    <h2 class="dashboard-section__title">Resumen de Cargos</h2>\n                    <div class="table-container">\n                        <table class="data-table">\n                            <thead>\n                                <tr>\n                                    <th>Cargo</th>\n                                    <th>rea</th>\n                                    <th>Zona</th>\n                                    <th>Trabajadores</th>\n                                    <th>Riesgos GES</th>\n                                    <th>Especial</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ').concat(v.map((function(e){var n;return"\n                                    <tr>\n                                        <td><strong>".concat(e.nombre||"Sin nombre","</strong></td>\n                                        <td>").concat(e.area||"N/A","</td>\n                                        <td>").concat(e.zona||"N/A","</td>\n                                        <td>").concat(e.numPersonas||0,'</td>\n                                        <td><span class="badge badge--primary">').concat((null===(n=e.ges)||void 0===n?void 0:n.length)||0,"</span></td>\n                                        <td>\n                                            ").concat(e.trabajaAlturas?'<span class="badge badge--warning" title="Trabajo en alturas"></span>':"","\n                                            ").concat(e.manipulaAlimentos?'<span class="badge badge--info" title="Manipula alimentos">斤</span>':"","\n                                            ").concat(e.conduceVehiculo?'<span class="badge badge--secondary" title="Conduce veh铆culo"></span>':"","\n                                            ").concat(e.trabajaEspaciosConfinados?'<span class="badge badge--danger" title="Espacios confinados">锔</span>':"","\n                                            ").concat(e.trabajaAlturas||e.manipulaAlimentos||e.conduceVehiculo||e.trabajaEspaciosConfinados?"":"-","\n                                        </td>\n                                    </tr>\n                                ")})).join(""),'\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n\n                <div class="text-center mt-6">\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary btn--lg">\n                        <i data-lucide="zap"></i>\n                        Ir al Wizard para Generar Documentos\n                    </a>\n                </div>\n            ')),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 50:r.length>0?(f={matriz:{icon:"file-spreadsheet",label:"Matriz GTC-45",color:"#10b981"},profesiograma:{icon:"file-text",label:"Profesiograma",color:"#5dc4af"},perfil:{icon:"user-check",label:"Perfil de Cargo",color:"#f59e0b"},cotizacion:{icon:"receipt",label:"Cotizaci贸n",color:"#6366f1"}},b=r.map((function(e){var n=e.preview_urls||{},t=e.metadata||{},r=new Date(e.created_at).toLocaleDateString("es-CO"),i="pagado"===e.estado?"Pagado":"completado"===e.estado?"Completado":"Pendiente",o="pagado"===e.estado?"success":"completado"===e.estado?"primary":"warning",s=Object.entries(n).filter((function(e){return"thumbnails"!==a(e,1)[0]})).map((function(e){var n=a(e,2),t=n[0],r=n[1],i=f[t]||{icon:"file",label:t,color:"#6b7280"};return'\n                    <div class="card card--document">\n                        <div class="card__body">\n                            <div class="document-icon" style="color:'.concat(i.color,';">\n                                <i data-lucide="').concat(i.icon,'"></i>\n                            </div>\n                            <div class="document-info">\n                                <h4>').concat(i.label,'</h4>\n                                <span class="text-xs text-muted">').concat("matriz"===t?"Excel":"PDF",'</span>\n                            </div>\n                            <a href="').concat(r,'" target="_blank" class="btn btn--sm btn--primary" download>\n                                <i data-lucide="download"></i>\n                            </a>\n                        </div>\n                    </div>\n                ')})).join("");return'\n                <div class="card mb-4">\n                    <div class="card__header">\n                        <div>\n                            <h3 class="card__title">'.concat(t.nombreEmpresa||"Empresa",'</h3>\n                            <span class="text-sm text-muted">Generado: ').concat(r," 路 ").concat(t.numCargos||0,' cargos</span>\n                        </div>\n                        <span class="badge badge--').concat(o,'">').concat(i,'</span>\n                    </div>\n                    <div class="card__body">\n                        <div class="dashboard-grid dashboard-grid--cols-4">\n                            ').concat(s||'<p class="text-muted">Sin documentos disponibles</p>',"\n                        </div>\n                    </div>\n                </div>\n            ")})).join(""),Tn("documentos-content",'\n            <div class="dashboard-section">\n                <h2 class="dashboard-section__title">Documentos Generados</h2>\n                '.concat(b,'\n            </div>\n            <div class="text-center mt-6">\n                <a href="/pages/wizard_riesgos.html" class="btn btn--outline">\n                    <i data-lucide="plus"></i>\n                    Generar Nuevos Documentos\n                </a>\n            </div>\n        '))):Tn("documentos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="folder-open"></i>\n                </div>\n                <h3 class="empty-state__title">Centro de Documentos</h3>\n                <p class="empty-state__description">A煤n no hay documentos generados. Complete el wizard para generar profesiogramas, matrices y m谩s.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Generar Documentos</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 52:case"end":return e.stop()}}),e,null,[[6,20],[25,36]])})))).apply(this,arguments)}function In(){return Sn.apply(this,arguments)}function Sn(){return(Sn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Config Page..."),Tn("config-content",'\n        <div class="card">\n            <div class="card__header">\n                <h3 class="card__title">Configuraci贸n de Empresa</h3>\n            </div>\n            <div class="card__body">\n                <p class="text-muted">La configuraci贸n se habilitar谩 cuando la empresa est茅 registrada en el sistema.</p>\n            </div>\n        </div>\n    ');case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nn(){return zn.apply(this,arguments)}function zn(){return(zn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Panel Medico Page..."),On("medico-info","Sin m茅dico asignado"),Tn("panel-medico-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="stethoscope"></i>\n            </div>\n            <h3 class="empty-state__title">Panel M茅dico Ocupacional</h3>\n            <p class="empty-state__description">Este panel es exclusivo para m茅dicos ocupacionales. Contacte al administrador para obtener acceso.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pn(){return Ln.apply(this,arguments)}function Ln(){return Ln=c(g().mark((function e(){var n,t,r,i,o,s,c,l,d,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(" [PROFESIOGRAMA] ========== Loading Profesiograma Page =========="),Tn("profesiograma-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <div class="skeleton skeleton--circle" style="width:64px;height:64px;"></div>\n            </div>\n            <h3 class="empty-state__title">Cargando profesiograma...</h3>\n        </div>\n    '),e.next=4,$n();case 4:if(n=e.sent,console.log(" [PROFESIOGRAMA] API result:",n),n&&n.success){e.next=10;break}return Tn("profesiograma-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="file-text"></i>\n                </div>\n                <h3 class="empty-state__title">Sin Profesiograma</h3>\n                <p class="empty-state__description">A煤n no has generado un profesiograma. Usa el asistente para crear uno.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Crear Profesiograma</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 10:if(e.prev=10,r=n.cargos||[],console.log(" [PROFESIOGRAMA] Processing cargos from API:",r.length),0!==r.length){e.next=18;break}return console.log(" [PROFESIOGRAMA] No cargos found"),Tn("profesiograma-content",'\n                <div class="empty-state">\n                    <div class="empty-state__icon">\n                        <i data-lucide="file-text"></i>\n                    </div>\n                    <h3 class="empty-state__title">Sin Cargos Configurados</h3>\n                    <p class="empty-state__description">No hay cargos en el profesiograma. Completa el wizard para agregar cargos.</p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Ir al Wizard</a>\n                </div>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 18:if(i=localStorage.getItem("genesys_empresa"),o={nombre:"Empresa",nit:"--"},s=(null===(t=r[0])||void 0===t?void 0:t.documento_id)||null,i)try{c=JSON.parse(i),o={nombre:c.nombre_legal||c.razon_social||c.nombre||"Empresa",nit:c.nit||"--"}}catch(e){}l=r.map((function(e,n){var t=e.riesgosCount||0,r=e.togglesActivos||[],i=e.nrNivelMaximo||"I",o=e.conteoNiveles||{},s=e.examenesMedicos||[];console.log(" [CARGO ".concat(n+1,'] "').concat(e.nombre_cargo,'":'),{riesgosCount:t,examenesMedicosCount:s.length,examenesMedicos:s});var c={I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[i]||"muted",l=r.map((function(e){return{Alturas:{icon:"mountain",label:"Alturas"},Alimentos:{icon:"utensils",label:"Alimentos"},Vehiculo:{icon:"car",label:"Conducci贸n"},"Espacios Conf.":{icon:"box",label:"Esp. Confinados"}}[e]||{icon:"alert-triangle",label:e}})),d=Object.entries(o).filter((function(e){return a(e,2)[1]>0})).map((function(e){var n=a(e,2),t=n[0],r=n[1];return'<span class="badge badge--'.concat({I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[t]||"muted",'">').concat(r," NR-").concat(t,"</span>")})).join(" "),u=s.length>0?s.map((function(e){return'\n                    <div class="exam-item">\n                        <div class="exam-item__header">\n                            <span class="exam-item__name">'.concat(e.nombre,'</span>\n                            <span class="badge badge--').concat(1===e.prioridad?"danger":"info",' badge--sm">').concat(e.tipo,'</span>\n                        </div>\n                        <div class="exam-item__footer">\n                            <span class="exam-item__periodicidad">\n                                <i data-lucide="calendar" style="width:12px;height:12px;"></i>\n                                ').concat(e.periodicidad,"\n                            </span>\n                        </div>\n                    </div>\n                ")})).join(""):'<p class="text-muted text-sm">No hay ex谩menes m茅dicos asignados para este cargo.</p>';return'\n                <div class="card card--profesiograma">\n                    <div class="card__header">\n                        <div>\n                            <h3 class="card__title">'.concat(e.nombre_cargo||"Cargo "+(n+1),'</h3>\n                            <span class="text-sm text-muted">').concat(e.area||"Sin 谩rea"," 路 ").concat(e.zona||"Sin zona"," 路 ").concat(e.num_trabajadores||0,' persona(s)</span>\n                        </div>\n                        <div class="card__badges">\n                            <span class="badge badge--').concat(t>0?"primary":"muted",'">').concat(t," Riesgos</span>\n                            ").concat(t>0?'<span class="badge badge--'.concat(c,'">NR Max: ').concat(i,"</span>"):"",'\n                        </div>\n                    </div>\n                    <div class="card__body">\n                        ').concat(l.length>0?'\n                            <div class="profesiograma-section mb-4">\n                                <p class="profesiograma-section__title">\n                                    <i data-lucide="alert-triangle" style="width:16px;height:16px;color:#f59e0b;"></i>\n                                    Condiciones Especiales\n                                </p>\n                                <div class="flex gap-2 flex-wrap">\n                                    '.concat(l.map((function(e){return'<span class="badge badge--warning"><i data-lucide="'.concat(e.icon,'" style="width:12px;height:12px;"></i> ').concat(e.label,"</span>")})).join(""),"\n                                </div>\n                            </div>\n                        "):"","\n\n                        ").concat(t>0?'\n                            <div class="profesiograma-section mb-4">\n                                <p class="profesiograma-section__title">\n                                    <i data-lucide="shield-alert" style="width:16px;height:16px;color:#ef4444;"></i>\n                                    Distribuci贸n de Riesgos\n                                </p>\n                                <div class="flex gap-2 flex-wrap">\n                                    '.concat(d||'<span class="badge badge--muted">Sin clasificar</span>',"\n                                </div>\n                            </div>\n                        "):"",'\n\n                        <div class="profesiograma-section">\n                            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">\n                                <p class="profesiograma-section__title" style="margin-bottom:0;">\n                                    <i data-lucide="stethoscope" style="width:16px;height:16px;color:#10b981;"></i>\n                                    Ex谩menes M茅dicos Requeridos\n                                    ').concat(s.length>0?'<span class="badge badge--sm badge--success" style="margin-left:8px;">'.concat(s.length,"</span>"):"","\n                                </p>\n                                ").concat(s.length>0?'\n                                    <button class="btn btn--outline btn--sm" style="padding:4px 12px;font-size:12px;" onclick="alert(\'Funci贸n de descarga en desarrollo\')">\n                                        <i data-lucide="download" style="width:12px;height:12px;"></i>\n                                        Descargar Excel\n                                    </button>\n                                ':"",'\n                            </div>\n                            <div class="exams-grid">\n                                ').concat(u,"\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            ")})).join(""),d=r.reduce((function(e,n){return e+(n.num_trabajadores||0)}),0),u=r.reduce((function(e,n){return e+(n.riesgosCount||0)}),0),Tn("profesiograma-content",'\n            <div class="dashboard-grid dashboard-grid--cols-4 mb-6">\n                <div class="card card--stat">\n                    <div class="stat-value">'.concat(r.length,'</div>\n                    <div class="stat-label">Cargos</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(d,'</div>\n                    <div class="stat-label">Trabajadores</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(u,'</div>\n                    <div class="stat-label">Riesgos Identificados</div>\n                </div>\n                <div class="card card--stat card--highlight">\n                    <div class="stat-value stat-value--primary">').concat(n.total||r.length,'</div>\n                    <div class="stat-label">Total BD</div>\n                </div>\n            </div>\n\n            <div class="card card--company mb-6">\n                <div class="card__body" style="display:flex;align-items:center;gap:24px;">\n                    <div class="company-logo" style="width:64px;height:64px;background:#5dc4af;border-radius:12px;display:flex;align-items:center;justify-content:center;">\n                        <i data-lucide="building-2" style="width:32px;height:32px;color:#fff;"></i>\n                    </div>\n                    <div>\n                        <h2 style="margin:0 0 4px;">').concat(o.nombre,'</h2>\n                        <p class="text-muted" style="margin:0;">NIT: ').concat(o.nit,'</p>\n                    </div>\n                </div>\n            </div>\n\n            <div class="dashboard-section">\n                <h2 class="dashboard-section__title">Protocolo de Vigilancia por Cargo</h2>\n                <div class="dashboard-grid dashboard-grid--cols-2">\n                    ').concat(l,'\n                </div>\n            </div>\n\n            <div class="text-center mt-6">\n                <a href="/pages/wizard_riesgos.html" class="btn btn--outline mr-3">\n                    <i data-lucide="edit"></i> Editar en Wizard\n                </a>\n                <a href="/pages/profesiograma_view.html').concat(s?"?documento_id="+s:"",'" class="btn btn--primary">\n                    <i data-lucide="eye"></i> Ver Profesiograma Completo\n                </a>\n            </div>\n        ')),window.lucide&&window.lucide.createIcons(),e.next=34;break;case 29:e.prev=29,e.t0=e.catch(10),console.error("Error loading profesiograma:",e.t0),Tn("profesiograma-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="alert-circle"></i>\n                </div>\n                <h3 class="empty-state__title">Error al cargar</h3>\n                <p class="empty-state__description">Hubo un error al cargar los datos del profesiograma.</p>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 34:case"end":return e.stop()}}),e,null,[[10,29]])}))),Ln.apply(this,arguments)}function Tn(e,n){console.log(" [showPageContent] containerId:",e);var t=document.getElementById(e);console.log(" [showPageContent] container found:",!!t),t?(t.innerHTML=n,console.log(" [showPageContent] HTML set, length:",n.length),console.log(" [showPageContent] First 200 chars:",n.substring(0,200))):(console.error(" [showPageContent] Container NOT FOUND:",e),console.error(" [showPageContent] Available elements with IDs:",Array.from(document.querySelectorAll("[id]")).map((function(e){return e.id})).join(", ")))}function jn(){var e=localStorage.getItem("genesys_wizard_state");if(!e)return console.warn(" [getWizardData] No wizard state in localStorage"),null;try{var n=JSON.parse(e);return console.log(" [getWizardData] Successfully parsed wizard state"),n}catch(e){return console.error(" [getWizardData] Error parsing:",e),null}}function On(e,n){var t=document.getElementById(e);t&&(t.textContent=n)}function Dn(){var e=localStorage.getItem("authToken")||localStorage.getItem("genesys_token");return{"Content-Type":"application/json",Authorization:e?"Bearer ".concat(e):""}}function Mn(){var e=localStorage.getItem("genesys_empresa");if(e)try{var n=JSON.parse(e);return console.log(" [API] Empresa ID:",n.id),n.id}catch(e){console.error(" [API] Error parsing empresa:",e)}return null}function $n(){return Rn.apply(this,arguments)}function Rn(){return(Rn=c(g().mark((function e(){var n,t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Mn()){e.next=4;break}return console.warn(" [API] No empresa ID, cannot fetch cargos"),e.abrupt("return",null);case 4:return e.prev=4,console.log(" [API] Fetching cargos for empresa:",n),e.next=8,fetch("/api/cargos/empresa/".concat(n),{headers:Dn()});case 8:if((t=e.sent).ok){e.next=12;break}return console.error(" [API] Error fetching cargos:",t.status),e.abrupt("return",null);case 12:return e.next=14,t.json();case 14:return a=e.sent,console.log(" [API] Cargos fetched:",a),Ue.data.cargos=a.cargos||[],Ue.companyId=n,e.abrupt("return",a);case 21:return e.prev=21,e.t0=e.catch(4),console.error(" [API] Error fetching cargos:",e.t0),e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,null,[[4,21]])})))).apply(this,arguments)}function Hn(){return Bn.apply(this,arguments)}function Bn(){return(Bn=c(g().mark((function e(){var n,t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Mn()){e.next=4;break}return console.warn(" [API] No empresa ID, cannot fetch matriz"),e.abrupt("return",null);case 4:return e.prev=4,console.log(" [API] Fetching matriz for empresa:",n),e.next=8,fetch("/api/cargos/matriz-gtc45/".concat(n),{headers:Dn()});case 8:if((t=e.sent).ok){e.next=12;break}return console.error(" [API] Error fetching matriz:",t.status),e.abrupt("return",null);case 12:return e.next=14,t.json();case 14:return a=e.sent,console.log(" [API] Matriz fetched:",a),Ue.data.matriz=a,e.abrupt("return",a);case 20:return e.prev=20,e.t0=e.catch(4),console.error(" [API] Error fetching matriz:",e.t0),e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,null,[[4,20]])})))).apply(this,arguments)}function Gn(){var e=document.getElementById("user-menu"),n=document.getElementById("user-dropdown"),t=document.getElementById("btn-logout");e&&n&&(e.addEventListener("click",(function(t){t.stopPropagation(),n.classList.toggle("open"),e.classList.toggle("open")})),document.addEventListener("click",(function(t){e.contains(t.target)||(n.classList.remove("open"),e.classList.remove("open"))})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&(n.classList.remove("open"),e.classList.remove("open"))}))),t&&t.addEventListener("click",(function(e){e.preventDefault(),qn()}));var a=document.getElementById("sidebar-logout");a&&a.addEventListener("click",(function(e){e.preventDefault(),qn()})),function(){var e=document.getElementById("user-avatar"),n=document.getElementById("user-name"),t=document.getElementById("user-email"),a=localStorage.getItem("genesys_user")||localStorage.getItem("userData"),r=localStorage.getItem("genesys_empresa");if(a)try{var i=JSON.parse(a);if(e&&i.nombre){var o=i.nombre.split(" ").map((function(e){return e[0]})).slice(0,2).join("").toUpperCase();e.textContent=o}n&&i.nombre&&(n.textContent=i.nombre),t&&i.email&&(t.textContent=i.email)}catch(e){console.warn("Error parsing user data:",e)}else if(r)try{var s=JSON.parse(r);if(e&&s.razon_social){var c=s.razon_social.split(" ").map((function(e){return e[0]})).slice(0,2).join("").toUpperCase();e.textContent=c}n&&s.razon_social&&(n.textContent=s.razon_social),t&&s.email&&(t.textContent=s.email)}catch(e){console.warn("Error parsing empresa data:",e)}else e&&(e.textContent="US"),n&&(n.textContent="Usuario"),t&&(t.textContent="usuario@empresa.com")}()}function qn(){localStorage.removeItem("genesys_token"),localStorage.removeItem("genesys_user"),localStorage.removeItem("genesys_empresa"),localStorage.removeItem("genesys_auth_type"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),sessionStorage.clear(),window.location.href="/pages/login.html"}function Vn(){return Un.apply(this,arguments)}function Un(){return Un=c(g().mark((function e(){var n,t,a,r,i,o,s,l;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[Dashboard] Loading company data..."),n=function(){var e=c(g().mark((function e(n){var t,a,r,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n||localStorage.getItem("empresaId"),a=localStorage.getItem("authToken"),!t||!a){e.next=21;break}return e.prev=3,e.next=6,fetch("/api/documentos/empresa/".concat(t),{headers:{Authorization:"Bearer ".concat(a)}});case 6:if(!(r=e.sent).ok){e.next=16;break}return e.next=10,r.json();case 10:if(!((i=e.sent).success&&i.documents&&i.documents.length>0)){e.next=16;break}return console.log("[Dashboard] Enriched data from API with",i.documents.length,"documents"),o=i.documents[0],s=o.metadata||{},e.abrupt("return",{sector:s.sector,actividad_economica:s.actividadEconomica,responsable:s.nombreResponsable,nombre_responsable:o.nombre_responsable,numCargos:s.numCargos});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),console.warn("[Dashboard] Error enriching from API:",e.t0);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(n){return e.apply(this,arguments)}}(),t=Mn(),console.log("[Dashboard] Logged-in empresa ID:",t),!(a=localStorage.getItem("genesys_empresa"))){e.next=23;break}return e.prev=6,r=JSON.parse(a),console.log("[Dashboard] Found empresa from login:",r),e.next=11,n();case 11:if(!(i=e.sent)){e.next=16;break}return Fn((o=Ve(Ve({},r),{},{sector:i.sector||r.sector||"-",actividad_economica:i.actividad_economica||r.actividad_economica||"-",responsable:i.responsable||i.nombre_responsable||r.responsable||"-",numCargos:i.numCargos||0})).nombre_legal||o.razon_social,o),e.abrupt("return",o);case 16:return Fn(r.nombre_legal||r.razon_social||r.nombre,r),e.abrupt("return",r);case 20:e.prev=20,e.t0=e.catch(6),console.warn("[Dashboard] Error parsing genesys_empresa:",e.t0);case 23:if(!(s=localStorage.getItem("genesys_user"))){e.next=36;break}if(e.prev=25,!(l=JSON.parse(s)).empresa){e.next=31;break}return console.log("[Dashboard] Found empresa from user data:",l.empresa),Fn(l.empresa.nombre||l.empresa.razon_social,l.empresa),e.abrupt("return",l.empresa);case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(25),console.warn("[Dashboard] Error parsing genesys_user:",e.t1);case 36:return console.log("[Dashboard] No company data found"),On("company-name","Sin empresa"),e.abrupt("return",null);case 39:case"end":return e.stop()}}),e,null,[[6,20],[25,33]])}))),Un.apply(this,arguments)}function Fn(e,n){if(On("company-name",e||"Sin empresa"),On("company-sector",(null==n?void 0:n.sector)||"-"),On("company-activity",(null==n?void 0:n.actividad_economica)||"-"),On("company-nit",(null==n?void 0:n.nit)||"-"),On("responsable-name",(null==n?void 0:n.responsable)||(null==n?void 0:n.nombre_responsable)||"-"),Ue.companyName=e,Ue.companyId=(null==n?void 0:n.id)||null,null!=n&&n.cargos&&Array.isArray(n.cargos)){var t=n.cargos.length,a=n.cargos.reduce((function(e,n){return e+(n.numPersonas||n.numTrabajadores||0)}),0);On("stat-total-trabajadores",a.toString());var r=0;n.cargos.forEach((function(e){e.ges&&Array.isArray(e.ges)&&(r+=e.ges.length),e.gesSeleccionados&&Array.isArray(e.gesSeleccionados)&&(r+=e.gesSeleccionados.length)})),On("stat-peligros",r.toString()),console.log("[Dashboard] Company stats - Cargos: ".concat(t,", Trabajadores: ").concat(a,", GES: ").concat(r))}}function Wn(){console.log("[CargoWizard] Opening create wizard...");var e,n=Mn(),t=He({mode:"create",empresaId:n,onSave:(e=c(g().mark((function e(t){var a,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[CargoWizard] Saving new cargo:",t),e.prev=1,e.next=4,fetch("/api/cargos",{method:"POST",headers:Dn(),body:JSON.stringify(Ve(Ve({},t),{},{empresa_id:n}))});case 4:if((a=e.sent).ok){e.next=7;break}throw new Error("Error al crear el cargo");case 7:return e.next=9,a.json();case 9:return r=e.sent,console.log("[CargoWizard] Cargo created:",r),e.next=13,pn();case 13:Kn("Cargo creado exitosamente","success"),e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(1),console.error("[CargoWizard] Error saving cargo:",e.t0),Kn("Error al crear el cargo: "+e.t0.message,"error"),e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,16]])}))),function(n){return e.apply(this,arguments)}),onCancel:function(){console.log("[CargoWizard] Create wizard cancelled")}});t.show()}function Jn(e,n){console.log("[CargoWizard] Opening edit wizard for cargo:",e,n);var t,a=Mn(),r=He({mode:"edit",cargoId:e,cargoData:n,empresaId:a,onSave:(t=c(g().mark((function n(t){var r,i,o;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("[CargoWizard] Saving edited cargo:",t),n.prev=1,t.pendingApprovals&&t.pendingApprovals.length>0&&(console.log("[CargoWizard] Cargo has pending approvals:",t.pendingApprovals),t.estado_aprobacion="pendiente"),n.next=5,fetch("/api/cargos/".concat(e),{method:"PUT",headers:Dn(),body:JSON.stringify(Ve(Ve({},t),{},{empresa_id:a}))});case 5:if((i=n.sent).ok){n.next=8;break}throw new Error("Error al actualizar el cargo");case 8:return n.next=10,i.json();case 10:return o=n.sent,console.log("[CargoWizard] Cargo updated:",o),n.next=14,pn();case 14:(null===(r=t.pendingApprovals)||void 0===r?void 0:r.length)>0?Kn("Cargo actualizado. Algunos cambios est谩n pendientes de aprobaci贸n.","warning"):Kn("Cargo actualizado exitosamente","success"),n.next=23;break;case 18:throw n.prev=18,n.t0=n.catch(1),console.error("[CargoWizard] Error updating cargo:",n.t0),Kn("Error al actualizar el cargo: "+n.t0.message,"error"),n.t0;case 23:case"end":return n.stop()}}),n,null,[[1,18]])}))),function(e){return t.apply(this,arguments)}),onCancel:function(){console.log("[CargoWizard] Edit wizard cancelled")}});r.show()}function Zn(){var e=document.getElementById("btn-nuevo-cargo");e&&e.addEventListener("click",(function(e){e.preventDefault(),Wn()}));var n=document.querySelector(".btn-nuevo-cargo-inline");n&&n.addEventListener("click",(function(e){e.preventDefault(),Wn()})),document.querySelectorAll(".btn-edit-cargo").forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault();var t=e.dataset.cargoId,a={};try{var r=e.dataset.cargo;r&&(a=JSON.parse(r.replace(/&#39;/g,"'")))}catch(e){console.error("[CargoWizard] Error parsing cargo data:",e)}Jn(t,a)}))})),document.querySelectorAll(".btn-view-cargo").forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var t={};try{var r=e.dataset.cargo;r&&(t=JSON.parse(r.replace(/&#39;/g,"'")))}catch(e){console.error("[CargoDetails] Error parsing cargo data:",e)}!function(e){var n=document.querySelector(".cargo-details-popup");n&&n.remove();var t=e.togglesActivos||[],r=e.nrNivelMaximo||"N/A",i="muted";"I"===r?i="success":"II"===r?i="info":"III"===r?i="warning":"IV"===r?i="danger":"V"===r&&(i="critical");var o=e.gesSeleccionados||[],s=o.reduce((function(e,n){var t=n.riesgo||n.categoria||"Otros";return e[t]||(e[t]=[]),e[t].push(n),e}),{}),c="";c=Object.keys(s).length>0?Object.entries(s).map((function(e){var n=a(e,2),t=n[0],r=n[1];return'\n            <div class="ges-category">\n                <div class="ges-category__header">'.concat(t,'</div>\n                <ul class="ges-category__list">\n                    ').concat(r.map((function(e){var n,t,a,r=e.niveles||{},i=(null===(n=r.deficiencia)||void 0===n?void 0:n.value)||r.deficiencia||"-",o=(null===(t=r.exposicion)||void 0===t?void 0:t.value)||r.exposicion||"-",s=(null===(a=r.consecuencia)||void 0===a?void 0:a.value)||r.consecuencia||"-";return'<li>\n                            <span class="ges-name">'.concat(e.ges||e.nombre||"Sin nombre",'</span>\n                            <span class="ges-niveles">ND:').concat(i," NE:").concat(o," NC:").concat(s,"</span>\n                        </li>")})).join(""),"\n                </ul>\n            </div>\n        ")})).join(""):'<p class="text-muted">Sin riesgos asignados</p>';var l=e.examenesMedicos||[],d="";d=l.length>0?'\n            <ul class="examenes-list">\n                '.concat(l.map((function(e){return'\n                    <li>\n                        <span class="examen-codigo">'.concat(e.codigo,'</span>\n                        <span class="examen-nombre">').concat(e.nombre,"</span>\n                    </li>\n                ")})).join(""),"\n            </ul>\n        "):'<p class="text-muted">Sin ex谩menes asignados</p>';var u=e.conteoNiveles||{},p='\n        <div class="niveles-grid">\n            '.concat(["V","IV","III","II","I"].map((function(e){return'\n                <div class="nivel-item nivel-item--'.concat(e.toLowerCase(),'">\n                    <span class="nivel-label">NR ').concat(e,'</span>\n                    <span class="nivel-count">').concat(u[e]||0,"</span>\n                </div>\n            ")})).join(""),"\n        </div>\n    "),g=document.createElement("div");g.className="cargo-details-popup",g.innerHTML='\n        <div class="cargo-details-overlay"></div>\n        <div class="cargo-details-modal">\n            <div class="cargo-details-modal__header">\n                <h2 class="cargo-details-modal__title">\n                    <i data-lucide="briefcase"></i>\n                    '.concat(e.nombre_cargo||"Sin nombre",'\n                </h2>\n                <button class="cargo-details-modal__close" aria-label="Cerrar">\n                    <i data-lucide="x"></i>\n                </button>\n            </div>\n            <div class="cargo-details-modal__body">\n                \x3c!-- Info b谩sica --\x3e\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="info"></i> Informaci贸n General\n                    </h3>\n                    <div class="details-grid">\n                        <div class="detail-item">\n                            <span class="detail-label">rea</span>\n                            <span class="detail-value">').concat(e.area||"Sin 谩rea",'</span>\n                        </div>\n                        <div class="detail-item">\n                            <span class="detail-label">Zona</span>\n                            <span class="detail-value">').concat(e.zona||"Sin zona",'</span>\n                        </div>\n                        <div class="detail-item">\n                            <span class="detail-label">Personas</span>\n                            <span class="detail-value">').concat(e.num_trabajadores||0,'</span>\n                        </div>\n                        <div class="detail-item">\n                            <span class="detail-label">NR M谩ximo</span>\n                            <span class="detail-value">\n                                <span class="badge badge--').concat(i,'">').concat(e.nrMaximo||"N/A"," (").concat(r,")</span>\n                            </span>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Descripci贸n --\x3e\n                ").concat(e.descripcion_tareas?'\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="file-text"></i> Descripci贸n de Tareas\n                    </h3>\n                    <p class="descripcion-text">'.concat(e.descripcion_tareas,"</p>\n                </div>\n                "):"","\n\n                \x3c!-- Condiciones especiales --\x3e\n                ").concat(t.length>0?'\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="alert-triangle"></i> Condiciones Especiales\n                    </h3>\n                    <div class="toggles-badges">\n                        '.concat(t.map((function(e){return'\n                            <span class="badge badge--attention">'.concat(e,"</span>\n                        ")})).join(""),"\n                    </div>\n                </div>\n                "):"",'\n\n                \x3c!-- Distribuci贸n de riesgos --\x3e\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="bar-chart-3"></i> Distribuci贸n de Riesgos por NR\n                    </h3>\n                    ').concat(p,'\n                </div>\n\n                \x3c!-- Riesgos GES --\x3e\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="shield-alert"></i> Riesgos Identificados (').concat(o.length,')\n                    </h3>\n                    <div class="ges-list">\n                        ').concat(c,'\n                    </div>\n                </div>\n\n                \x3c!-- Ex谩menes m茅dicos --\x3e\n                <div class="details-section">\n                    <h3 class="details-section__title">\n                        <i data-lucide="stethoscope"></i> Ex谩menes M茅dicos (').concat(l.length,")\n                    </h3>\n                    ").concat(d,'\n                </div>\n            </div>\n            <div class="cargo-details-modal__footer">\n                <button class="btn btn--outline btn-close-popup">Cerrar</button>\n                <button class="btn btn--primary btn-edit-from-popup" data-cargo-id="').concat(e.id,'">\n                    <i data-lucide="edit-2"></i> Editar Cargo\n                </button>\n            </div>\n        </div>\n    '),document.body.appendChild(g),window.lucide&&window.lucide.createIcons();requestAnimationFrame((function(){g.classList.add("show")}));var v=function(){g.classList.remove("show"),setTimeout((function(){return g.remove()}),300)};g.querySelector(".cargo-details-overlay").addEventListener("click",v),g.querySelector(".cargo-details-modal__close").addEventListener("click",v),g.querySelector(".btn-close-popup").addEventListener("click",v),g.querySelector(".btn-edit-from-popup").addEventListener("click",(function(){v(),Jn(e.id,e)}));var m=function(e){"Escape"===e.key&&(v(),document.removeEventListener("keydown",m))};document.addEventListener("keydown",m)}(t)}))})),console.log("[CargoWizard] Events bound successfully")}function Kn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=document.createElement("div");t.className="notification notification--".concat(n),t.innerHTML='\n        <i data-lucide="'.concat("success"===n?"check-circle":"error"===n?"alert-circle":"warning"===n?"alert-triangle":"info",'"></i>\n        <span>').concat(e,"</span>\n    "),document.body.appendChild(t),window.lucide&&window.lucide.createIcons(),setTimeout((function(){t.classList.add("show")}),10),setTimeout((function(){t.classList.remove("show"),setTimeout((function(){t.remove()}),300)}),4e3)}function Xn(){var e=function(){return"paid"===localStorage.getItem("genesys_payment_status")},n=document.getElementById("paywall-btn-pay");n&&n.addEventListener("click",c(g().mark((function e(){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[Paywall] Pay button clicked"),(n=document.getElementById("paywall-overlay"))&&(n.style.display="none"),Kn("Cont谩ctenos para procesar su pago y desbloquear todos los documentos","info"),setTimeout((function(){var e=encodeURIComponent("Hola, quiero pagar por los documentos del dashboard");window.open("https://wa.me/".concat("573102877240","?text=").concat(e),"_blank")}),1500);case 5:case"end":return e.stop()}}),e)}))));var t=document.getElementById("paywall-download-cotizacion");t&&t.addEventListener("click",c(g().mark((function e(){var n,t,a,r,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.disabled=!0,console.log("[Paywall] Downloading cotizaci贸n..."),e.prev=2,n=localStorage.getItem("empresaId"),t=localStorage.getItem("authToken"),n&&t){e.next=7;break}throw new Error("No se encontr贸 informaci贸n de sesi贸n");case 7:return e.next=9,fetch("/api/documentos/empresa/".concat(n),{headers:{Authorization:"Bearer ".concat(t)}});case 9:if((a=e.sent).ok){e.next=12;break}throw new Error("Error al obtener documentos");case 12:return e.next=14,a.json();case 14:if(!((r=e.sent).documents&&r.documents.length>0)){e.next=26;break}if(o=r.documents[0],!(s=null===(i=o.preview_urls)||void 0===i?void 0:i.cotizacion)){e.next=23;break}window.open(s,"_blank"),Kn("Cotizaci贸n descargada exitosamente","success"),e.next=24;break;case 23:throw new Error("Cotizaci贸n no disponible");case 24:e.next=27;break;case 26:throw new Error("No hay documentos disponibles");case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(2),console.error("[Paywall] Error downloading cotizaci贸n:",e.t0),Kn(e.t0.message||"Error al descargar la cotizaci贸n","error");case 33:this.disabled=!1;case 34:case"end":return e.stop()}}),e,this,[[2,29]])}))));var a=document.getElementById("paywall-download-perfil");a&&a.addEventListener("click",c(g().mark((function e(){var n,t,a,r,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.disabled=!0,console.log("[Paywall] Downloading perfil..."),e.prev=2,n=localStorage.getItem("empresaId"),t=localStorage.getItem("authToken"),n&&t){e.next=7;break}throw new Error("No se encontr贸 informaci贸n de sesi贸n");case 7:return e.next=9,fetch("/api/documentos/empresa/".concat(n),{headers:{Authorization:"Bearer ".concat(t)}});case 9:if((a=e.sent).ok){e.next=12;break}throw new Error("Error al obtener documentos");case 12:return e.next=14,a.json();case 14:if(!((r=e.sent).documents&&r.documents.length>0)){e.next=26;break}if(o=r.documents[0],!(s=null===(i=o.preview_urls)||void 0===i?void 0:i.perfil)){e.next=23;break}window.open(s,"_blank"),Kn("Perfil de Cargo descargado exitosamente","success"),e.next=24;break;case 23:throw new Error("Perfil de cargo no disponible");case 24:e.next=27;break;case 26:throw new Error("No hay documentos disponibles");case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(2),console.error("[Paywall] Error downloading perfil:",e.t0),Kn(e.t0.message||"Error al descargar el perfil","error");case 33:this.disabled=!1;case 34:case"end":return e.stop()}}),e,this,[[2,29]])})))),e()?console.log("[Paywall] User has paid. No paywall will be shown."):(console.log("[Paywall] User has not paid. Timer starting (8s)..."),setTimeout((function(){e()||function(){var e=document.getElementById("paywall-overlay");if(e){var n=0;if(Ue.data.cargos&&Ue.data.cargos.length>0)n=Ue.data.cargos.length,console.log("[Paywall] Using cargo count from DashboardState:",n);else try{var t=localStorage.getItem("genesys_empresa");t&&(n=JSON.parse(t).numCargos||0,console.log("[Paywall] Using cargo count from genesys_empresa:",n))}catch(e){console.warn("[Paywall] Error reading cargo count:",e)}var a=3e4*n,r=document.getElementById("paywall-cargo-count");r&&(r.textContent=n.toString());var i=document.getElementById("paywall-total");i&&(i.textContent="$"+a.toLocaleString("es-CO")),e.style.display="flex",window.lucide&&window.lucide.createIcons(),console.log("[Paywall] Modal shown - Cargos:",n,"Total:","$"+a.toLocaleString("es-CO"))}}()}),8e3))}document.addEventListener("DOMContentLoaded",c(g().mark((function e(){var n,t,a,r,i,o,s,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(" Dashboard Premium initializing..."),console.log(" [DEBUG] Checking localStorage..."),n=localStorage.getItem("genesys_wizard_state"),console.log(" [DEBUG] genesys_wizard_state exists:",!!n),n)try{s=JSON.parse(n),console.log(" [DEBUG] Parsed wizard state:",{currentStep:s.currentStep,hasFormData:!!s.formData,nombreEmpresa:(null===(t=s.formData)||void 0===t?void 0:t.nombreEmpresa)||"N/A",nit:(null===(a=s.formData)||void 0===a?void 0:a.nit)||"N/A",cargosCount:(null===(r=s.formData)||void 0===r||null===(r=r.cargos)||void 0===r?void 0:r.length)||0,firstCargo:(null===(i=s.formData)||void 0===i||null===(i=i.cargos)||void 0===i?void 0:i[0])||"No cargos"}),(null===(o=s.formData)||void 0===o||null===(o=o.cargos)||void 0===o?void 0:o.length)>0&&s.formData.cargos.forEach((function(e,n){var t;console.log(" [DEBUG] Cargo ".concat(n,":"),{nombre:e.nombre,area:e.area,zona:e.zona,numPersonas:e.numPersonas,gesCount:(null===(t=e.ges)||void 0===t?void 0:t.length)||0,toggles:{trabajaAlturas:e.trabajaAlturas,manipulaAlimentos:e.manipulaAlimentos,conduceVehiculo:e.conduceVehiculo,trabajaEspaciosConfinados:e.trabajaEspaciosConfinados}})}))}catch(e){console.error(" [DEBUG] Error parsing wizard state:",e)}else console.warn(" [DEBUG] No wizard state found in localStorage. Keys available:",Object.keys(localStorage));return console.log(" [DEBUG] Checking DOM containers..."),["cargos-content","matriz-critical-content","profesiograma-content","documentos-content","examenes-table-body"].forEach((function(e){var n=document.getElementById(e);console.log(' [DEBUG] Container "'.concat(e,'":'),n?"FOUND":"NOT FOUND")})),new Ye,Gn(),e.next=12,Vn();case 12:if(!(c=Mn())){e.next=17;break}return console.log("[Dashboard] Pre-loading cargos for empresa:",c),e.next=17,$n();case 17:document.addEventListener("keydown",(function(e){if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();var n=document.getElementById("global-search");n&&n.focus()}})),console.log(" Dashboard Premium ready");case 19:case"end":return e.stop()}}),e)})))),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Xn):Xn(),console.log(" Dashboard Premium initialized")})()})();