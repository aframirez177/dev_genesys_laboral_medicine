/*! For license information please see dashboard.bundle.js.LICENSE.txt */
(()=>{var e={4633:(e,n,t)=>{var a=t(3738).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var n,t={},s=Object.prototype,o=s.hasOwnProperty,i=Object.defineProperty||function(e,n,t){e[n]=t.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function p(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{p({},"")}catch(n){p=function(e,n,t){return e[n]=t}}function g(e,n,t,a){var r=n&&n.prototype instanceof _?n:_,s=Object.create(r.prototype),o=new j(a||[]);return i(s,"_invoke",{value:N(e,t,o)}),s}function m(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}t.wrap=g;var v="suspendedStart",h="suspendedYield",f="executing",b="completed",y={};function _(){}function w(){}function x(){}var E={};p(E,l,(function(){return this}));var A=Object.getPrototypeOf,C=A&&A(A(D([])));C&&C!==s&&o.call(C,l)&&(E=C);var S=x.prototype=_.prototype=Object.create(E);function k(e){["next","throw","return"].forEach((function(n){p(e,n,(function(e){return this._invoke(n,e)}))}))}function I(e,n){function t(r,s,i,c){var l=m(e[r],e,s);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==a(u)&&o.call(u,"__await")?n.resolve(u.__await).then((function(e){t("next",e,i,c)}),(function(e){t("throw",e,i,c)})):n.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return t("throw",e,i,c)}))}c(l.arg)}var r;i(this,"_invoke",{value:function(e,a){function s(){return new n((function(n,r){t(e,a,n,r)}))}return r=r?r.then(s,s):s()}})}function N(e,t,a){var r=v;return function(s,o){if(r===f)throw Error("Generator is already running");if(r===b){if("throw"===s)throw o;return{value:n,done:!0}}for(a.method=s,a.arg=o;;){var i=a.delegate;if(i){var c=z(i,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===v)throw r=b,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=f;var l=m(e,t,a);if("normal"===l.type){if(r=a.done?b:h,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r=b,a.method="throw",a.arg=l.arg)}}}function z(e,t){var a=t.method,r=e.iterator[a];if(r===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=n,z(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var s=m(r,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,y;var o=s.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function P(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function O(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(e){if(e||""===e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return s.next=s}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,i(S,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=p(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===w||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,p(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},k(I.prototype),p(I.prototype,d,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,a,r,s){void 0===s&&(s=Promise);var o=new I(g(e,n,a,r),s);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(S),p(S,u,"Generator"),p(S,l,(function(){return this})),p(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var n=Object(e),t=[];for(var a in n)t.push(a);return t.reverse(),function e(){for(;t.length;){var a=t.pop();if(a in n)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return i.type="throw",i.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),l=o.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=n&&n<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=n,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(s)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),y},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),O(t),y}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var a=t.completion;if("throw"===a.type){var r=a.arg;O(t)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:D(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),y}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},4756:(e,n,t)=>{var a=t(4633)();e.exports=a;try{regeneratorRuntime=a}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var s=n[a]={exports:{}};return e[a](s,s.exports,t),s.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{"use strict";function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function n(n,t){if(n){if("string"==typeof n)return e(n,t);var a={}.toString.call(n).slice(8,-1);return"Object"===a&&n.constructor&&(a=n.constructor.name),"Map"===a||"Set"===a?Array.from(n):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(n,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,s,o,i=[],c=!0,l=!1;try{if(s=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=s.call(t)).done)&&(i.push(a.value),i.length!==n);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return i}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var n=function(e,n){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==r(n)?n:n+""}function o(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n,t,a,r,s,o){try{var i=e[s](o),c=i.value}catch(e){return void t(e)}i.done?n(c):Promise.resolve(c).then(a,r)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,r){var s=e.apply(n,t);function o(e){i(s,a,r,o,c,"next",e)}function c(e){i(s,a,r,o,c,"throw",e)}o(void 0)}))}}function l(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,s(a.key),a)}}function u(e,n,t){return n&&d(e.prototype,n),t&&d(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var p=t(4756),g=t.n(p);function m(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function v(t){return function(n){if(Array.isArray(n))return e(n)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const h=globalThis,f=h.trustedTypes,b=f?f.createPolicy("lit-html",{createHTML:e=>e}):void 0,y="$lit$",_=`lit$${Math.random().toFixed(9).slice(2)}$`,w="?"+_,x=`<${w}>`,E=document,A=()=>E.createComment(""),C=e=>null===e||"object"!=typeof e&&"function"!=typeof e,S=Array.isArray,k=e=>S(e)||"function"==typeof e?.[Symbol.iterator],I="[ \t\n\f\r]",N=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,z=/-->/g,P=/>/g,O=RegExp(`>|${I}(?:([^\\s"'>=/]+)(${I}*=${I}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),j=/'/g,D=/"/g,L=/^(?:script|style|textarea|title)$/i,$=e=>(n,...t)=>({_$litType$:e,strings:n,values:t}),M=$(1),T=($(2),$(3),Symbol.for("lit-noChange")),R=Symbol.for("lit-nothing"),H=new WeakMap,G=E.createTreeWalker(E,129);function B(e,n){if(!S(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==b?b.createHTML(n):n}const V=(e,n)=>{const t=e.length-1,a=[];let r,s=2===n?"<svg>":3===n?"<math>":"",o=N;for(let n=0;n<t;n++){const t=e[n];let i,c,l=-1,d=0;for(;d<t.length&&(o.lastIndex=d,c=o.exec(t),null!==c);)d=o.lastIndex,o===N?"!--"===c[1]?o=z:void 0!==c[1]?o=P:void 0!==c[2]?(L.test(c[2])&&(r=RegExp("</"+c[2],"g")),o=O):void 0!==c[3]&&(o=O):o===O?">"===c[0]?(o=r??N,l=-1):void 0===c[1]?l=-2:(l=o.lastIndex-c[2].length,i=c[1],o=void 0===c[3]?O:'"'===c[3]?D:j):o===D||o===j?o=O:o===z||o===P?o=N:(o=O,r=void 0);const u=o===O&&e[n+1].startsWith("/>")?" ":"";s+=o===N?t+x:l>=0?(a.push(i),t.slice(0,l)+y+t.slice(l)+_+u):t+_+(-2===l?n:u)}return[B(e,s+(e[t]||"<?>")+(2===n?"</svg>":3===n?"</math>":"")),a]};class U{constructor({strings:e,_$litType$:n},t){let a;this.parts=[];let r=0,s=0;const o=e.length-1,i=this.parts,[c,l]=V(e,n);if(this.el=U.createElement(c,t),G.currentNode=this.el.content,2===n||3===n){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(a=G.nextNode())&&i.length<o;){if(1===a.nodeType){if(a.hasAttributes())for(const e of a.getAttributeNames())if(e.endsWith(y)){const n=l[s++],t=a.getAttribute(e).split(_),o=/([.?@])?(.*)/.exec(n);i.push({type:1,index:r,name:o[2],strings:t,ctor:"."===o[1]?Z:"?"===o[1]?K:"@"===o[1]?X:J}),a.removeAttribute(e)}else e.startsWith(_)&&(i.push({type:6,index:r}),a.removeAttribute(e));if(L.test(a.tagName)){const e=a.textContent.split(_),n=e.length-1;if(n>0){a.textContent=f?f.emptyScript:"";for(let t=0;t<n;t++)a.append(e[t],A()),G.nextNode(),i.push({type:2,index:++r});a.append(e[n],A())}}}else if(8===a.nodeType)if(a.data===w)i.push({type:2,index:r});else{let e=-1;for(;-1!==(e=a.data.indexOf(_,e+1));)i.push({type:7,index:r}),e+=_.length-1}r++}}static createElement(e,n){const t=E.createElement("template");return t.innerHTML=e,t}}function q(e,n,t=e,a){if(n===T)return n;let r=void 0!==a?t._$Co?.[a]:t._$Cl;const s=C(n)?void 0:n._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),void 0===s?r=void 0:(r=new s(e),r._$AT(e,t,a)),void 0!==a?(t._$Co??=[])[a]=r:t._$Cl=r),void 0!==r&&(n=q(e,r._$AS(e,n.values),r,a)),n}class W{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:t}=this._$AD,a=(e?.creationScope??E).importNode(n,!0);G.currentNode=a;let r=G.nextNode(),s=0,o=0,i=t[0];for(;void 0!==i;){if(s===i.index){let n;2===i.type?n=new F(r,r.nextSibling,this,e):1===i.type?n=new i.ctor(r,i.name,i.strings,this,e):6===i.type&&(n=new Y(r,this,e)),this._$AV.push(n),i=t[++o]}s!==i?.index&&(r=G.nextNode(),s++)}return G.currentNode=E,a}p(e){let n=0;for(const t of this._$AV)void 0!==t&&(void 0!==t.strings?(t._$AI(e,t,n),n+=t.strings.length-2):t._$AI(e[n])),n++}}class F{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,t,a){this.type=2,this._$AH=R,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=t,this.options=a,this._$Cv=a?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return void 0!==n&&11===e?.nodeType&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=q(this,e,n),C(e)?e===R||null==e||""===e?(this._$AH!==R&&this._$AR(),this._$AH=R):e!==this._$AH&&e!==T&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):k(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==R&&C(this._$AH)?this._$AA.nextSibling.data=e:this.T(E.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:t}=e,a="number"==typeof t?this._$AC(e):(void 0===t.el&&(t.el=U.createElement(B(t.h,t.h[0]),this.options)),t);if(this._$AH?._$AD===a)this._$AH.p(n);else{const e=new W(a,this),t=e.u(this.options);e.p(n),this.T(t),this._$AH=e}}_$AC(e){let n=H.get(e.strings);return void 0===n&&H.set(e.strings,n=new U(e)),n}k(e){S(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let t,a=0;for(const r of e)a===n.length?n.push(t=new F(this.O(A()),this.O(A()),this,this.options)):t=n[a],t._$AI(r),a++;a<n.length&&(this._$AR(t&&t._$AB.nextSibling,a),n.length=a)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class J{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,t,a,r){this.type=1,this._$AH=R,this._$AN=void 0,this.element=e,this.name=n,this._$AM=a,this.options=r,t.length>2||""!==t[0]||""!==t[1]?(this._$AH=Array(t.length-1).fill(new String),this.strings=t):this._$AH=R}_$AI(e,n=this,t,a){const r=this.strings;let s=!1;if(void 0===r)e=q(this,e,n,0),s=!C(e)||e!==this._$AH&&e!==T,s&&(this._$AH=e);else{const a=e;let o,i;for(e=r[0],o=0;o<r.length-1;o++)i=q(this,a[t+o],n,o),i===T&&(i=this._$AH[o]),s||=!C(i)||i!==this._$AH[o],i===R?e=R:e!==R&&(e+=(i??"")+r[o+1]),this._$AH[o]=i}s&&!a&&this.j(e)}j(e){e===R?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Z extends J{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===R?void 0:e}}class K extends J{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==R)}}class X extends J{constructor(e,n,t,a,r){super(e,n,t,a,r),this.type=5}_$AI(e,n=this){if((e=q(this,e,n,0)??R)===T)return;const t=this._$AH,a=e===R&&t!==R||e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive,r=e!==R&&(t===R||a);a&&this.element.removeEventListener(this.name,this,t),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class Y{constructor(e,n,t){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=t}get _$AU(){return this._$AM._$AU}_$AI(e){q(this,e)}}const Q=h.litHtmlPolyfillSupport;Q?.(U,F),(h.litHtmlVersions??=[]).push("3.3.1");var ee,ne,te,ae,re,se,oe,ie,ce,le,de,ue,pe,ge,me,ve,he,fe,be,ye,_e,we,xe,Ee,Ae,Ce,Se,ke,Ie,Ne,ze,Pe,Oe,je,De,Le,$e;function Me(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Re=function(){return u((function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.options=Te({mode:n.mode||"create",cargoId:n.cargoId||null,cargoData:n.cargoData||null,empresaId:n.empresaId||null,onSave:n.onSave||function(){},onCancel:n.onCancel||function(){}},n),this.state={currentStep:0,totalSteps:5,loading:!1,error:null,cargo:{nombre:"",area:"",zona:"",descripcion:"",numPersonas:1,tareasRutinarias:!1,trabajaAlturas:!1,manipulaAlimentos:!1,conduceVehiculo:!1,trabajaEspaciosConfinados:!1,riesgosSeleccionados:[],niveles:{},controles:{}},pendingApprovals:[],originalNiveles:{},originalControles:{},catalogoGES:[],catalogoRiesgos:[],existingAreas:[],existingZonas:[]},this.steps=[{id:"info",title:"Información Básica",icon:"user"},{id:"riesgos",title:"Selección de Riesgos",icon:"alert-triangle"},{id:"niveles",title:"Niveles de Riesgo",icon:"sliders"},{id:"controles",title:"Controles",icon:"shield"},{id:"resumen",title:"Resumen",icon:"check-circle"}],this.niveles={ND:[{value:1,label:"Bajo / N/A",color:"#10b981"},{value:2,label:"Medio",color:"#84cc16"},{value:6,label:"Alto",color:"#f59e0b"},{value:10,label:"Muy Alto",color:"#ef4444"}],NE:[{value:1,label:"Esporádica",color:"#10b981"},{value:2,label:"Ocasional",color:"#84cc16"},{value:3,label:"Frecuente",color:"#f59e0b"},{value:4,label:"Continua",color:"#ef4444"}],NC:[{value:10,label:"Leve",color:"#10b981"},{value:25,label:"Grave",color:"#f59e0b"},{value:60,label:"Muy Grave",color:"#f97316"},{value:100,label:"Mortal",color:"#ef4444"}]},this.modalElement=null,this.init()}),[{key:"init",value:(r=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"edit"===this.options.mode&&this.options.cargoData&&this.loadCargoData(this.options.cargoData),e.next=3,this.loadCatalogos();case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadCargoData",value:function(e){this.state.cargo=Te(Te({},this.state.cargo),{},{nombre:e.nombre||e.nombre_cargo||"",area:e.area||"",zona:e.zona||"",descripcion:e.descripcion||"",numPersonas:e.numPersonas||e.num_trabajadores||1,tareasRutinarias:e.tareasRutinarias||e.tareas_rutinarias||!1,trabajaAlturas:e.trabajaAlturas||e.trabaja_alturas||!1,manipulaAlimentos:e.manipulaAlimentos||e.manipula_alimentos||!1,conduceVehiculo:e.conduceVehiculo||e.conduce_vehiculo||!1,trabajaEspaciosConfinados:e.trabajaEspaciosConfinados||e.trabaja_espacios_confinados||!1,riesgosSeleccionados:e.riesgos||e.riesgosSeleccionados||[],niveles:e.niveles||{},controles:e.controles||{}}),this.state.originalNiveles=JSON.parse(JSON.stringify(this.state.cargo.niveles)),this.state.originalControles=JSON.parse(JSON.stringify(this.state.cargo.controles))}},{key:"loadCatalogos",value:(t=c(g().mark((function e(){var n,t,a,r,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/catalogo/ges");case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:t=e.sent,this.state.catalogoGES=t.data||t||[];case 9:if(!this.options.empresaId){e.next=20;break}return e.next=12,fetch("/api/cargos/empresa/".concat(this.options.empresaId));case 12:if(!(a=e.sent).ok){e.next=20;break}return e.next=16,a.json();case 16:r=e.sent,s=r.cargos||[],this.state.existingAreas=v(new Set(s.map((function(e){return e.area})).filter(Boolean))),this.state.existingZonas=v(new Set(s.map((function(e){return e.zona})).filter(Boolean)));case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error("[CargoMiniWizard] Error loading catalogs:",e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])}))),function(){return t.apply(this,arguments)})},{key:"show",value:function(){var e=this;this.modalElement=document.createElement("div"),this.modalElement.className="cargo-mini-wizard-overlay",this.modalElement.innerHTML='\n      <div class="cargo-mini-wizard-modal">\n        <div class="cargo-mini-wizard-content" id="cargo-mini-wizard-content">\n        </div>\n      </div>\n    ',document.body.appendChild(this.modalElement),document.body.style.overflow="hidden",this.renderContent(),this.modalElement.addEventListener("click",(function(n){n.target===e.modalElement&&e.handleCancel()})),this.escapeHandler=function(n){"Escape"===n.key&&e.handleCancel()},document.addEventListener("keydown",this.escapeHandler)}},{key:"hide",value:function(){this.modalElement&&(document.body.removeChild(this.modalElement),document.body.style.overflow="",this.modalElement=null),this.escapeHandler&&document.removeEventListener("keydown",this.escapeHandler)}},{key:"renderContent",value:function(){var e=this,n=document.getElementById("cargo-mini-wizard-content");n&&(((e,n,t)=>{const a=t?.renderBefore??n;let r=a._$litPart$;if(void 0===r){const e=t?.renderBefore??null;a._$litPart$=r=new F(n.insertBefore(A(),e),e,void 0,t??{})}r._$AI(e)})(M(ee||(ee=m(['\n      \x3c!-- Header --\x3e\n      <div class="mini-wizard__header">\n        <div class="mini-wizard__header-left">\n          <h2 class="mini-wizard__title">\n            ','\n          </h2>\n          <p class="mini-wizard__subtitle">\n            ','\n          </p>\n        </div>\n        <button class="mini-wizard__close" @click=','>\n          <i data-lucide="x"></i>\n        </button>\n      </div>\n\n      \x3c!-- Progress Steps --\x3e\n      <div class="mini-wizard__progress">\n        ','\n      </div>\n\n      \x3c!-- Content --\x3e\n      <div class="mini-wizard__body">\n        ','\n      </div>\n\n      \x3c!-- Footer --\x3e\n      <div class="mini-wizard__footer">\n        <div class="mini-wizard__footer-left">\n          ','\n        </div>\n        <div class="mini-wizard__footer-right">\n          <button class="btn btn--ghost" @click=',">\n            Cancelar\n          </button>\n          ","\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?"Editar Cargo":"Nuevo Cargo",this.steps[this.state.currentStep].title,(function(){return e.handleCancel()}),this.steps.map((function(n,t){return M(ne||(ne=m(['\n          <div class="mini-wizard__step '," ",'">\n            <div class="mini-wizard__step-icon">\n              <i data-lucide="','"></i>\n            </div>\n            <span class="mini-wizard__step-label">',"</span>\n          </div>\n        "])),t===e.state.currentStep?"active":"",t<e.state.currentStep?"completed":"",n.icon,n.title)})),this.renderCurrentStep(),this.state.currentStep>0?M(te||(te=m(['\n            <button class="btn btn--outline" @click=','>\n              <i data-lucide="arrow-left"></i>\n              Anterior\n            </button>\n          '])),(function(){return e.goToPreviousStep()})):"",(function(){return e.handleCancel()}),this.state.currentStep<this.state.totalSteps-1?M(ae||(ae=m(['\n            <button class="btn btn--primary" @click=','>\n              Siguiente\n              <i data-lucide="arrow-right"></i>\n            </button>\n          '])),(function(){return e.goToNextStep()})):M(re||(re=m(['\n            <button class="btn btn--primary" @click=','>\n              <i data-lucide="save"></i>\n              ',"\n            </button>\n          "])),(function(){return e.handleSave()}),"edit"===this.options.mode?"Guardar Cambios":"Crear Cargo")),n),window.lucide&&window.lucide.createIcons())}},{key:"renderCurrentStep",value:function(){switch(this.state.currentStep){case 0:return this.renderInfoStep();case 1:return this.renderRiesgosStep();case 2:return this.renderNivelesStep();case 3:return this.renderControlesStep();case 4:return this.renderResumenStep();default:return M(se||(se=m(["<p>Paso no encontrado</p>"])))}}},{key:"renderInfoStep",value:function(){var e=this,n=this.state.cargo;return M(oe||(oe=m(['\n      <div class="mini-wizard__step-content">\n        <div class="mini-wizard__form-grid">\n          \x3c!-- Columna izquierda: Campos básicos --\x3e\n          <div class="mini-wizard__form-col">\n            <div class="form-group">\n              <label class="form-label">Nombre del Cargo <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Operario de Producción"\n                required\n              />\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Área <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                list="areas-list"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Producción, Administración"\n              />\n              <datalist id="areas-list">\n                ','\n              </datalist>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Zona o Lugar <span class="required">*</span></label>\n              <input\n                type="text"\n                class="form-input"\n                list="zonas-list"\n                .value=',"\n                @input=",'\n                placeholder="Ej: Planta 1, Oficina central"\n              />\n              <datalist id="zonas-list">\n                ','\n              </datalist>\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Número de Trabajadores <span class="required">*</span></label>\n              <input\n                type="number"\n                class="form-input"\n                .value=',"\n                @input=",'\n                min="1"\n                max="9999"\n              />\n            </div>\n\n            <div class="form-group">\n              <label class="form-label">Descripción</label>\n              <textarea\n                class="form-input form-textarea"\n                .value=',"\n                @input=",'\n                placeholder="Descripción de las funciones del cargo..."\n                rows="4"\n              ></textarea>\n            </div>\n          </div>\n\n          \x3c!-- Columna derecha: Toggles especiales --\x3e\n          <div class="mini-wizard__form-col">\n            <label class="form-label form-label--section">\n              <i data-lucide="shield"></i>\n              Características Especiales\n            </label>\n            <div class="toggles-grid">\n              ',"\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),n.nombre,(function(n){return e.updateCargo("nombre",n.target.value)}),n.area,(function(n){return e.updateCargo("area",n.target.value)}),this.state.existingAreas.map((function(e){return M(ie||(ie=m(['<option value="','">'])),e)})),n.zona,(function(n){return e.updateCargo("zona",n.target.value)}),this.state.existingZonas.map((function(e){return M(ce||(ce=m(['<option value="','">'])),e)})),n.numPersonas,(function(n){return e.updateCargo("numPersonas",parseInt(n.target.value)||1)}),n.descripcion,(function(n){return e.updateCargo("descripcion",n.target.value)}),[{name:"tareasRutinarias",label:"Tareas repetitivas",icon:"repeat",severity:"warning"},{name:"conduceVehiculo",label:"Conduce vehículo",icon:"car",severity:"warning"},{name:"manipulaAlimentos",label:"Manipula alimentos",icon:"utensils",severity:"danger"},{name:"trabajaAlturas",label:"Trabaja en alturas",icon:"arrow-up",severity:"danger"},{name:"trabajaEspaciosConfinados",label:"Espacios confinados",icon:"door-closed",severity:"danger"}].map((function(t){return M(le||(le=m(['\n                <div class="toggle-item toggle-item--','">\n                  <div class="toggle-item__info">\n                    <i data-lucide="','" class="toggle-item__icon"></i>\n                    <span class="toggle-item__label">','</span>\n                  </div>\n                  <label class="toggle-switch toggle-switch--','">\n                    <input\n                      type="checkbox"\n                      .checked=',"\n                      @change=",'\n                    />\n                    <span class="toggle-switch__slider"></span>\n                  </label>\n                </div>\n              '])),t.severity,t.icon,t.label,t.severity,n[t.name],(function(n){return e.updateCargo(t.name,n.target.checked)}))})))}},{key:"renderRiesgosStep",value:function(){var e=this,n=this.state.catalogoGES.reduce((function(e,n){var t=n.categoria||"Otros";return e[t]||(e[t]=[]),e[t].push(n),e}),{}),t=this.state.cargo.riesgosSeleccionados.map((function(e){return e.id_ges||e.idGes||e.id}));return this.state.expandedCategories||(this.state.expandedCategories={}),M(de||(de=m(['\n      <div class="mini-wizard__step-content mini-wizard__step-content--riesgos">\n        <div class="riesgos-header">\n          <p>Selecciona los riesgos asociados a este cargo</p>\n          <span class="riesgos-count">\n            ',' seleccionados\n          </span>\n        </div>\n\n        <div class="riesgos-grid">\n          ',"\n        </div>\n      </div>\n    "])),t.length,Object.entries(n).map((function(n){var r=a(n,2),s=r[0],o=r[1],i=e.state.expandedCategories[s],c=i?o:o.slice(0,10);return M(ue||(ue=m(['\n              <div class="riesgos-category">\n                <div class="riesgos-category__header">\n                  <span class="riesgos-category__name">','</span>\n                  <span class="riesgos-category__count">','</span>\n                </div>\n                <div class="riesgos-category__items">\n                  ',"\n                  ","\n                </div>\n              </div>\n            "])),s,o.length,c.map((function(n){var a=n.id_ges||n.idGes||n.id,r=t.includes(a);return M(pe||(pe=m(['\n                      <div\n                        class="riesgo-chip ','"\n                        @click=','\n                      >\n                        <span class="riesgo-chip__name">',"</span>\n                        ","\n                      </div>\n                    "])),r?"selected":"",(function(){return e.toggleRiesgo(n)}),n.nombre,r?M(ge||(ge=m(['<i data-lucide="check"></i>']))):"")})),o.length>10?M(me||(me=m(['\n                    <button\n                      class="riesgo-chip riesgo-chip--toggle"\n                      @click=',"\n                    >\n                      ","\n                    </button>\n                  "])),(function(){return e.toggleCategoryExpanded(s)}),i?M(ve||(ve=m(['<i data-lucide="chevron-up"></i> Mostrar menos']))):M(he||(he=m(['<i data-lucide="chevron-down"></i> +'," más"])),o.length-10)):"")})))}},{key:"renderNivelesStep",value:function(){var e=this,n=this.state.cargo.riesgosSeleccionados;return 0===n.length?M(fe||(fe=m(['\n        <div class="mini-wizard__empty">\n          <i data-lucide="alert-circle"></i>\n          <p>No hay riesgos seleccionados</p>\n          <span>Vuelve al paso anterior para seleccionar riesgos</span>\n        </div>\n      ']))):M(be||(be=m(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="niveles-list">\n          ',"\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?M(ye||(ye=m(['\n          <div class="approval-warning">\n            <i data-lucide="alert-triangle"></i>\n            <div>\n              <strong>Cambios en niveles requieren aprobación</strong>\n              <p>Las modificaciones en los niveles de riesgo serán marcadas para revisión antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.map((function(n,t){return e.renderNivelItem(n,t)})))}},{key:"renderNivelItem",value:function(e,n){var t=this,a=e.id_ges||e.idGes||e.id,r=this.state.cargo.niveles[a]||{ND:1,NE:1,NC:10},s=r.ND*r.NE,o=s*r.NC,i=this.getNRInfo(o);return M(_e||(_e=m(['\n      <div class="nivel-item">\n        <div class="nivel-item__header">\n          <span class="nivel-item__name">','</span>\n          <span class="nivel-item__badge nivel-item__badge--','">\n            NR: '," (",')\n          </span>\n        </div>\n\n        <div class="nivel-item__selectors">\n          \x3c!-- ND --\x3e\n          <div class="nivel-selector">\n            <label>ND (Deficiencia)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- NE --\x3e\n          <div class="nivel-selector">\n            <label>NE (Exposición)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- NC --\x3e\n          <div class="nivel-selector">\n            <label>NC (Consecuencia)</label>\n            <div class="nivel-buttons">\n              ','\n            </div>\n          </div>\n\n          \x3c!-- Calculated values --\x3e\n          <div class="nivel-calculated">\n            <div class="nivel-calc-item">\n              <span class="nivel-calc-label">NP</span>\n              <span class="nivel-calc-value">','</span>\n            </div>\n            <div class="nivel-calc-item nivel-calc-item--nr" style="--nr-color: ','">\n              <span class="nivel-calc-label">NR</span>\n              <span class="nivel-calc-value">',"</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),e.nombre,i.level,o,i.label,this.niveles.ND.map((function(e){return M(we||(we=m(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.ND===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"ND",e.value)}),e.value)})),this.niveles.NE.map((function(e){return M(xe||(xe=m(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.NE===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"NE",e.value)}),e.value)})),this.niveles.NC.map((function(e){return M(Ee||(Ee=m(['\n                <button\n                  type="button"\n                  class="nivel-btn ','"\n                  style="--nivel-color: ','"\n                  @click=',"\n                >\n                  ","\n                </button>\n              "])),r.NC===e.value?"active":"",e.color,(function(){return t.updateNivel(a,"NC",e.value)}),e.value)})),s,i.color,o)}},{key:"renderControlesStep",value:function(){var e=this,n=this.state.cargo.riesgosSeleccionados;return 0===n.length?M(Ae||(Ae=m(['\n        <div class="mini-wizard__empty">\n          <i data-lucide="alert-circle"></i>\n          <p>No hay riesgos seleccionados</p>\n        </div>\n      ']))):M(Ce||(Ce=m(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="controles-list">\n          ',"\n        </div>\n      </div>\n    "])),"edit"===this.options.mode?M(Se||(Se=m(['\n          <div class="approval-warning">\n            <i data-lucide="alert-triangle"></i>\n            <div>\n              <strong>Cambios en controles requieren aprobación</strong>\n              <p>Las modificaciones en los controles serán marcadas para revisión antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.map((function(n,t){return e.renderControlItem(n,t)})))}},{key:"renderControlItem",value:function(e,n){var t=this,a=e.id_ges||e.idGes||e.id,r=this.state.cargo.controles[a]||{fuente:"",medio:"",individuo:""};return M(ke||(ke=m(['\n      <div class="control-item">\n        <div class="control-item__header">\n          <span class="control-item__name">','</span>\n        </div>\n\n        <div class="control-item__fields">\n          <div class="form-group">\n            <label class="form-label">Control en la Fuente</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: Aislamiento acústico, guardas de protección..."\n              rows="2"\n            ></textarea>\n          </div>\n\n          <div class="form-group">\n            <label class="form-label">Control en el Medio</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: Señalización, ventilación, iluminación..."\n              rows="2"\n            ></textarea>\n          </div>\n\n          <div class="form-group">\n            <label class="form-label">Control en el Individuo</label>\n            <textarea\n              class="form-input form-textarea form-textarea--sm"\n              .value=',"\n              @input=",'\n              placeholder="Ej: EPP, capacitación, pausas activas..."\n              rows="2"\n            ></textarea>\n          </div>\n        </div>\n      </div>\n    '])),e.nombre,r.fuente,(function(e){return t.updateControl(a,"fuente",e.target.value)}),r.medio,(function(e){return t.updateControl(a,"medio",e.target.value)}),r.individuo,(function(e){return t.updateControl(a,"individuo",e.target.value)}))}},{key:"renderResumenStep",value:function(){var e=this,n=this.state.cargo,t=this.checkPendingApprovals();return M(Ie||(Ie=m(['\n      <div class="mini-wizard__step-content">\n        ','\n\n        <div class="resumen-grid">\n          \x3c!-- Info básica --\x3e\n          <div class="resumen-section">\n            <h3 class="resumen-section__title">\n              <i data-lucide="user"></i>\n              Información del Cargo\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-item">\n                <span class="resumen-item__label">Nombre:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">Área:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">Zona:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n              <div class="resumen-item">\n                <span class="resumen-item__label">Trabajadores:</span>\n                <span class="resumen-item__value">','</span>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Características especiales --\x3e\n          <div class="resumen-section">\n            <h3 class="resumen-section__title">\n              <i data-lucide="shield"></i>\n              Características Especiales\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-toggles">\n                ',"\n                ","\n                ","\n                ","\n                ","\n                ",'\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Riesgos --\x3e\n          <div class="resumen-section resumen-section--full">\n            <h3 class="resumen-section__title">\n              <i data-lucide="alert-triangle"></i>\n              Riesgos Seleccionados (',')\n            </h3>\n            <div class="resumen-section__content">\n              <div class="resumen-riesgos">\n                ',"\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    "])),t?M(Ne||(Ne=m(['\n          <div class="approval-pending-banner">\n            <i data-lucide="clock"></i>\n            <div>\n              <strong>Cambios pendientes de aprobación</strong>\n              <p>Algunos cambios en niveles y/o controles requieren verificación con la empresa antes de aplicarse.</p>\n            </div>\n          </div>\n        ']))):"",n.nombre||"-",n.area||"-",n.zona||"-",n.numPersonas,n.trabajaAlturas?M(ze||(ze=m(['<span class="resumen-toggle resumen-toggle--danger">Alturas</span>']))):"",n.manipulaAlimentos?M(Pe||(Pe=m(['<span class="resumen-toggle resumen-toggle--danger">Alimentos</span>']))):"",n.conduceVehiculo?M(Oe||(Oe=m(['<span class="resumen-toggle resumen-toggle--warning">Vehículo</span>']))):"",n.trabajaEspaciosConfinados?M(je||(je=m(['<span class="resumen-toggle resumen-toggle--danger">Espacios Confinados</span>']))):"",n.tareasRutinarias?M(De||(De=m(['<span class="resumen-toggle resumen-toggle--warning">Tareas Rutinarias</span>']))):"",n.trabajaAlturas||n.manipulaAlimentos||n.conduceVehiculo||n.trabajaEspaciosConfinados||n.tareasRutinarias?"":M(Le||(Le=m(['<span class="resumen-toggle resumen-toggle--none">Ninguna</span>']))),n.riesgosSeleccionados.length,n.riesgosSeleccionados.map((function(t){var a=t.id_ges||t.idGes||t.id,r=n.niveles[a]||{ND:1,NE:1,NC:10},s=r.ND*r.NE*r.NC,o=e.getNRInfo(s);return M($e||($e=m(['\n                    <div class="resumen-riesgo">\n                      <span class="resumen-riesgo__name">','</span>\n                      <span class="resumen-riesgo__nr" style="background: ','">\n                        NR: ',"\n                      </span>\n                    </div>\n                  "])),t.nombre,o.color,s)})))}},{key:"updateCargo",value:function(e,n){this.state.cargo[e]=n,this.renderContent()}},{key:"toggleRiesgo",value:function(e){var n=e.id_ges||e.idGes||e.id,t=this.state.cargo.riesgosSeleccionados,a=t.findIndex((function(e){return(e.id_ges||e.idGes||e.id)===n}));a>=0?(t.splice(a,1),delete this.state.cargo.niveles[n],delete this.state.cargo.controles[n]):(t.push(e),this.state.cargo.niveles[n]={ND:1,NE:1,NC:10},this.state.cargo.controles[n]={fuente:"",medio:"",individuo:""}),this.renderContent()}},{key:"toggleCategoryExpanded",value:function(e){this.state.expandedCategories||(this.state.expandedCategories={}),this.state.expandedCategories[e]=!this.state.expandedCategories[e],this.renderContent()}},{key:"updateNivel",value:function(e,n,t){this.state.cargo.niveles[e]||(this.state.cargo.niveles[e]={ND:1,NE:1,NC:10}),this.state.cargo.niveles[e][n]=t,"edit"===this.options.mode&&this.checkNivelApprovalNeeded(e,n,t),this.renderContent()}},{key:"updateControl",value:function(e,n,t){this.state.cargo.controles[e]||(this.state.cargo.controles[e]={fuente:"",medio:"",individuo:""}),this.state.cargo.controles[e][n]=t,"edit"===this.options.mode&&this.checkControlApprovalNeeded(e,n,t)}},{key:"checkNivelApprovalNeeded",value:function(e,n,t){var a=this.state.originalNiveles[e];if(a&&a[n]!==t){var r="nivel_".concat(e,"_").concat(n);this.state.pendingApprovals.includes(r)||this.state.pendingApprovals.push(r)}}},{key:"checkControlApprovalNeeded",value:function(e,n,t){var a=this.state.originalControles[e];if(a&&a[n]!==t){var r="control_".concat(e,"_").concat(n);this.state.pendingApprovals.includes(r)||this.state.pendingApprovals.push(r)}}},{key:"checkPendingApprovals",value:function(){return this.state.pendingApprovals.length>0}},{key:"goToNextStep",value:function(){this.validateCurrentStep()&&this.state.currentStep<this.state.totalSteps-1&&(this.state.currentStep++,this.renderContent())}},{key:"goToPreviousStep",value:function(){this.state.currentStep>0&&(this.state.currentStep--,this.renderContent())}},{key:"validateCurrentStep",value:function(){var e=this.state.cargo;switch(this.state.currentStep){case 0:return!e.nombre||e.nombre.length<3?(alert("El nombre del cargo debe tener al menos 3 caracteres"),!1):e.area?!!e.zona||(alert("La zona es requerida"),!1):(alert("El área es requerida"),!1);case 1:return 0!==e.riesgosSeleccionados.length||(alert("Debes seleccionar al menos un riesgo"),!1);default:return!0}}},{key:"handleSave",value:(n=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.checkPendingApprovals()){e.next=6;break}return e.next=3,this.showApprovalModal();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return this.state.loading=!0,this.renderContent(),e.prev=8,e.next=11,this.options.onSave(Te(Te({},this.state.cargo),{},{pendingApprovals:this.state.pendingApprovals,mode:this.options.mode,cargoId:this.options.cargoId}));case 11:this.hide(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.error("[CargoMiniWizard] Error saving:",e.t0),alert("Error al guardar: "+e.t0.message);case 18:return e.prev=18,this.state.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[8,14,18,21]])}))),function(){return n.apply(this,arguments)})},{key:"handleCancel",value:function(){this.options.onCancel(),this.hide()}},{key:"showApprovalModal",value:(e=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("div");n.className="approval-modal-overlay",n.innerHTML='\n        <div class="approval-modal">\n          <div class="approval-modal__icon">\n            <i data-lucide="alert-triangle"></i>\n          </div>\n          <h3 class="approval-modal__title">Cambios Requieren Aprobación</h3>\n          <p class="approval-modal__message">\n            Has modificado niveles de riesgo y/o controles existentes.\n            Estos cambios deben ser verificados con la empresa antes de aplicarse.\n          </p>\n          <p class="approval-modal__submessage">\n            Los cambios quedarán en estado "Pendiente de aprobación" hasta que sean revisados.\n          </p>\n          <div class="approval-modal__actions">\n            <button class="btn btn--ghost" id="approval-cancel">Cancelar</button>\n            <button class="btn btn--primary" id="approval-confirm">\n              <i data-lucide="clock"></i>\n              Enviar para Aprobación\n            </button>\n          </div>\n        </div>\n      ',document.body.appendChild(n),window.lucide&&window.lucide.createIcons(),n.querySelector("#approval-cancel").addEventListener("click",(function(){document.body.removeChild(n),e(!1)})),n.querySelector("#approval-confirm").addEventListener("click",(function(){document.body.removeChild(n),e(!0)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})},{key:"getNRInfo",value:function(e){return e<=20?{level:"i",label:"Nivel I",color:"#10b981"}:e<=120?{level:"ii",label:"Nivel II",color:"#84cc16"}:e<=500?{level:"iii",label:"Nivel III",color:"#f59e0b"}:e<=1e3?{level:"iv",label:"Nivel IV",color:"#f97316"}:{level:"v",label:"Nivel V",color:"#ef4444"}}}]);var e,n,t,r}();function He(e){return new Re(e)}function Ge(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Be(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ge(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ge(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ve={currentPage:"home",companyId:null,companyName:"",user:null,isLoading:!1,data:{summary:null,alerts:null,conditions:null,risks:null,examenes:null,cargos:null,matriz:null}},Ue="#sidebar",qe="#sidebar-toggle",We="#sidebar-overlay",Fe="#mobile-menu-toggle",Je=".sidebar-nav__item",Ze=".dashboard-page",Ke=function(){return u((function e(){l(this,e),this.pages=new Map,this.currentPage=null,this.init()}),[{key:"init",value:function(){var e=this;document.querySelectorAll(Ze).forEach((function(n){var t=n.dataset.page;e.pages.set(t,n)})),this.bindNavEvents(),this.bindSidebarEvents();var n=window.location.hash.replace("#","")||"home";this.navigateTo(n)}},{key:"bindNavEvents",value:function(){var e=this;document.querySelectorAll(Je).forEach((function(n){n.addEventListener("click",(function(t){t.preventDefault();var a=n.dataset.page;a&&e.navigateTo(a)}))})),document.querySelectorAll("[data-navigate]").forEach((function(n){n.addEventListener("click",(function(t){t.preventDefault();var a=n.dataset.navigate;a&&e.navigateTo(a)}))})),window.addEventListener("popstate",(function(){var n=window.location.hash.replace("#","")||"home";e.navigateTo(n,!1)}))}},{key:"bindSidebarEvents",value:function(){var e=document.querySelector(Ue),n=document.querySelector(qe),t=document.querySelector(We),a=document.querySelector(Fe);n&&n.addEventListener("click",(function(){e.classList.toggle("collapsed"),document.querySelector(".dashboard-main").classList.toggle("sidebar-collapsed")})),a&&a.addEventListener("click",(function(){e.classList.toggle("open"),t.classList.toggle("visible")})),t&&t.addEventListener("click",(function(){e.classList.remove("open"),t.classList.remove("visible")}))}},{key:"navigateTo",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.pages.has(e)||(console.warn('Page "'.concat(e,'" not found')),e="home"),this.pages.forEach((function(e,n){e.style.display="none"}));var t=this.pages.get(e);t&&(t.style.display="block"),document.querySelectorAll(Je).forEach((function(n){n.classList.remove("active"),n.dataset.page===e&&n.classList.add("active")})),this.currentPage=e,Ve.currentPage=e,n&&window.history.pushState({page:e},"","#".concat(e));var a=document.querySelector(Ue),r=document.querySelector(We);a&&a.classList.remove("open"),r&&r.classList.remove("visible"),this.loadPageData(e),window.lucide&&window.lucide.createIcons(),console.log("Navigated to: ".concat(e))}},{key:"loadPageData",value:(e=c(g().mark((function e(n){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t={home:Xe,inteligencia:sn,"mapa-org":cn,cargos:dn,examenes:pn,matriz:mn,estadisticas:hn,sve:bn,psicosocial:_n,documentos:xn,profesiograma:In,config:An,"panel-medico":Sn}[n])){e.next=11;break}return e.prev=3,e.next=6,t();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("Error loading page ".concat(n,":"),e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])}))),function(n){return e.apply(this,arguments)})}]);var e}();function Xe(){return Ye.apply(this,arguments)}function Ye(){return(Ye=c(g().mark((function e(){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading Dashboard Home..."),e.prev=1,Qe(),e.next=5,nn();case 5:(n=e.sent)&&an(n),rn("donut-cumplimiento",87),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error loading dashboard home:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function Qe(){var e=new Date,n=document.getElementById("last-update"),t=document.getElementById("next-update");if(n&&(n.textContent="Hoy ".concat(en(e))),t){var a=new Date(e.getTime()+216e5);t.textContent="Hoy ".concat(en(a))}}function en(e){return e.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit",hour12:!0}).toUpperCase()}function nn(){return tn.apply(this,arguments)}function tn(){return(tn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{cumplimiento:87,trabajadores:{total:53,alDia:45,alertas:8},alertas:{total:8,vencidos:3,proximos:5},examenes:{vencidos:3,proximos:5},riesgos:{nivelV:8,nivelIV:15,total:34},condiciones:{hipoacusia:15,trend:3},sve:3,peligros:122});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(e){On("cumplimiento-value",e.cumplimiento),On("total-trabajadores",e.trabajadores.total),On("trabajadores-aldia",e.trabajadores.alDia),On("trabajadores-alertas",e.trabajadores.alertas),On("total-alertas",e.alertas.total),On("alertas-vencidos",e.alertas.vencidos),On("alertas-proximos",e.alertas.proximos),On("hipoacusia-percent","".concat(e.condiciones.hipoacusia,"%")),On("condition-trend-text","+".concat(e.condiciones.trend,"% vs trimestre")),On("examenes-vencidos",e.examenes.vencidos),On("examenes-proximos",e.examenes.proximos),On("riesgos-v",e.riesgos.nivelV),On("riesgos-iv",e.riesgos.nivelIV),On("riesgos-total",e.riesgos.total),On("stat-cumplimiento","".concat(e.cumplimiento,"%")),On("stat-examenes-dia",e.trabajadores.alDia),On("stat-total-trabajadores",e.trabajadores.total),On("stat-sve-activos",e.sve),On("stat-peligros",e.peligros),On("insight-pattern-text","Aumento 15% deterioro auditivo en soldadores últimos 6 meses"),On("insight-recommendation-text","Auditoría uso EPP + medir ruido")}function rn(e,n){var t=document.getElementById(e);if(t){var a=160,r=2*Math.PI*74,s=r-n/100*r;t.innerHTML='\n        <svg width="'.concat(a,'" height="').concat(a,'" viewBox="0 0 ').concat(a," ").concat(a,'">\n            \x3c!-- Background circle --\x3e\n            <circle\n                cx="').concat(80,'"\n                cy="').concat(80,'"\n                r="').concat(74,'"\n                fill="none"\n                stroke="#e5e7eb"\n                stroke-width="').concat(12,'"\n            />\n            \x3c!-- Progress circle --\x3e\n            <circle\n                cx="').concat(80,'"\n                cy="').concat(80,'"\n                r="').concat(74,'"\n                fill="none"\n                stroke="#5dc4af"\n                stroke-width="').concat(12,'"\n                stroke-linecap="round"\n                stroke-dasharray="').concat(r,'"\n                stroke-dashoffset="').concat(s,'"\n                transform="rotate(-90 ').concat(80," ").concat(80,')"\n                style="transition: stroke-dashoffset 0.5s ease;"\n            />\n            \x3c!-- Center text --\x3e\n            <text\n                x="').concat(80,'"\n                y="').concat(80,'"\n                text-anchor="middle"\n                dominant-baseline="middle"\n                font-family="Poppins, sans-serif"\n                font-size="36"\n                font-weight="700"\n                fill="#383d47"\n            >').concat(n,"%</text>\n        </svg>\n    ")}}function sn(){return on.apply(this,arguments)}function on(){return(on=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Intelligence Page..."),zn("inteligencia-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="brain"></i>\n            </div>\n            <h3 class="empty-state__title">Inteligencia de Salud</h3>\n            <p class="empty-state__description">Aún no hay datos disponibles. Complete el wizard de riesgos para generar análisis de salud.</p>\n            <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Iniciar Wizard</a>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cn(){return ln.apply(this,arguments)}function ln(){return(ln=c(g().mark((function e(){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Org Map Page..."),(n=document.getElementById("org-chart-canvas"))&&(n.innerHTML='\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="network"></i>\n                </div>\n                <h3 class="empty-state__title">Mapa Organizacional</h3>\n                <p class="empty-state__description">Aún no hay datos disponibles. Agregue cargos para visualizar la estructura organizacional.</p>\n            </div>\n        ',window.lucide&&window.lucide.createIcons());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dn(){return un.apply(this,arguments)}function un(){return un=c(g().mark((function e(){var n,t,a,r,s,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("🔵 [CARGOS] ========== Loading Cargos Page =========="),zn("cargos-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <div class="skeleton skeleton--circle" style="width:64px;height:64px;"></div>\n            </div>\n            <h3 class="empty-state__title">Cargando cargos...</h3>\n        </div>\n    '),e.next=4,Ln();case 4:if(n=e.sent,console.log("🔵 [CARGOS] API result:",n),n&&n.success){e.next=11;break}return console.log("🟡 [CARGOS] No cargos found from API"),zn("cargos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="users"></i>\n                </div>\n                <h3 class="empty-state__title">Gestión de Cargos</h3>\n                <p class="empty-state__description">Aún no hay cargos registrados. Complete el wizard para agregar cargos a la empresa.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Agregar Cargos</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 11:if(e.prev=11,t=n.cargos||[],console.log("🔵 [CARGOS] Processing cargos from API:",t.length),0!==t.length){e.next=18;break}return zn("cargos-content",'\n                <div class="empty-state">\n                    <div class="empty-state__icon">\n                        <i data-lucide="users"></i>\n                    </div>\n                    <h3 class="empty-state__title">Sin Cargos</h3>\n                    <p class="empty-state__description">No hay cargos configurados. Agregue cargos en el wizard.</p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Agregar Cargos</a>\n                </div>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 18:a=t.map((function(e,n){var t=e.riesgosCount||0,a=e.num_trabajadores||0,r=e.nrNivelMaximo||"I",s=e.togglesActivos||[],o=s.map((function(e){return'<span class="badge badge--warning"><i data-lucide="'.concat({Alturas:"mountain",Alimentos:"utensils",Vehiculo:"car","Espacios Conf.":"box"}[e]||"alert-triangle",'" style="width:12px;height:12px;"></i> ').concat(e,"</span>")})).join(""),i={I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[r]||"muted";return'\n                <div class="card">\n                    <div class="card__header">\n                        <h3 class="card__title">'.concat(e.nombre_cargo||"Cargo "+(n+1),'</h3>\n                        <div class="card__badges">\n                            <span class="badge badge--').concat(t>0?"primary":"muted",'">').concat(t," riesgo").concat(1!==t?"s":"","</span>\n                            ").concat(t>0?'<span class="badge badge--'.concat(i,'">NR ').concat(r,"</span>"):"",'\n                        </div>\n                    </div>\n                    <div class="card__body">\n                        <div class="cargo-info">\n                            <div class="cargo-info__row">\n                                <i data-lucide="map-pin" class="text-muted"></i>\n                                <span>').concat(e.area||"Sin área"," / ").concat(e.zona||"Sin zona",'</span>\n                            </div>\n                            <div class="cargo-info__row">\n                                <i data-lucide="users" class="text-muted"></i>\n                                <span>').concat(a," persona").concat(1!==a?"s":"","</span>\n                            </div>\n                            ").concat(s.length>0?'\n                                <div class="cargo-info__conditions mt-2">\n                                    '.concat(o,"\n                                </div>\n                            "):"",'\n                        </div>\n                    </div>\n                    <div class="card__footer">\n                        <button class="btn btn--sm btn--outline btn-edit-cargo" data-cargo-id="').concat(e.id,"\" data-cargo='").concat(JSON.stringify(e).replace(/'/g,"&#39;"),'\'>\n                            <i data-lucide="edit-2"></i> Editar\n                        </button>\n                    </div>\n                </div>\n            ')})).join(""),r=t.reduce((function(e,n){return e+(n.num_trabajadores||0)}),0),s=t.filter((function(e){var n;return null===(n=e.togglesActivos)||void 0===n?void 0:n.includes("Alturas")})).length,t.filter((function(e){var n;return null===(n=e.togglesActivos)||void 0===n?void 0:n.includes("Espacios Conf.")})).length,o=t.reduce((function(e,n){return e+(n.riesgosCount||0)}),0),zn("cargos-content",'\n            <div class="dashboard-grid dashboard-grid--cols-4 mb-6">\n                <div class="card card--stat">\n                    <div class="stat-value">'.concat(t.length,'</div>\n                    <div class="stat-label">Total Cargos</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(r,'</div>\n                    <div class="stat-label">Total Personas</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(o,'</div>\n                    <div class="stat-label">Total Riesgos</div>\n                </div>\n                <div class="card card--stat card--warning">\n                    <div class="stat-value stat-value--warning">').concat(s,'</div>\n                    <div class="stat-label">Trabajo en Alturas</div>\n                </div>\n            </div>\n            <div class="dashboard-grid dashboard-grid--cols-3">\n                ').concat(a,'\n            </div>\n            <div class="text-center mt-6">\n                <button class="btn btn--primary btn-nuevo-cargo-inline">\n                    <i data-lucide="plus"></i> Agregar Cargo\n                </button>\n            </div>\n        ')),window.lucide&&window.lucide.createIcons(),qn(),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(11),console.error("Error loading cargos:",e.t0),zn("cargos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="alert-circle"></i>\n                </div>\n                <h3 class="empty-state__title">Error</h3>\n                <p class="empty-state__description">Hubo un error al cargar los cargos.</p>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 33:case"end":return e.stop()}}),e,null,[[11,28]])}))),un.apply(this,arguments)}function pn(){return gn.apply(this,arguments)}function gn(){return(gn=c(g().mark((function e(){var n,t,r,s,o,i,c,l,d,u,p,m,v,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("🔵 [EXAMENES] ========== Loading Examenes Page =========="),n=Pn(),console.log("🔵 [EXAMENES] wizardData:",n?"found":"not found"),n){e.next=13;break}return On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar","0"),On("examenes-showing","Mostrando 0 de 0"),(t=document.getElementById("examenes-table-body"))&&(t.innerHTML='\n                <tr>\n                    <td colspan="7" class="table-empty">\n                        <div class="empty-state empty-state--inline">\n                            <i data-lucide="clipboard-list"></i>\n                            <span>Complete el wizard para ver los exámenes recomendados por cargo</span>\n                        </div>\n                    </td>\n                </tr>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 13:if(e.prev=13,r=n.formData||{},s=r.cargos||[],console.log("🔵 [EXAMENES] Processing cargos:",s.length),0!==s.length){e.next=28;break}return console.log("🟡 [EXAMENES] No cargos found"),On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar","0"),On("examenes-showing","Mostrando 0 de 0"),(o=document.getElementById("examenes-table-body"))&&(o.innerHTML='\n                    <tr>\n                        <td colspan="7" class="table-empty">\n                            <div class="empty-state empty-state--inline">\n                                <i data-lucide="users"></i>\n                                <span>No hay cargos configurados. Agregue cargos en el wizard.</span>\n                            </div>\n                        </td>\n                    </tr>\n                '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 28:i={EMO:"Examen Médico Ocupacional",EMOA:"EMO con énfasis en Alturas",EMOMP:"EMO Manipuladores de Alimentos",OPTO:"Visiometría",AUD:"Audiometría",ECG:"Electrocardiograma",GLI:"Glicemia",PL:"Perfil Lipídico",PE:"Prueba de Esfuerzo",ESP:"Espirometría",PSM:"Prueba Psicosensométrica",PST:"Prueba Psicotécnica",FRO:"Frotis de Garganta",KOH:"KOH (Examen Hongos)",COP:"Coprológico"},c=["EMO","OPTO","AUD"],l={trabajaAlturas:["EMOA","GLI","PL","PE","ESP","ECG"],manipulaAlimentos:["EMOMP","FRO","KOH","COP"],conduceVehiculo:["PSM","GLI","PL"],trabajaEspaciosConfinados:["EMO","ESP","ECG","GLI","PL","PSM"],espaciosConfinados:["EMO","ESP","ECG","GLI","PL","PSM"]},d=0,u=0,p=[],s.forEach((function(e){var n=new Set(c);Object.entries(l).forEach((function(t){var r=a(t,2),s=r[0],o=r[1];e[s]&&o.forEach((function(e){return n.add(e)}))})),(e.gesSeleccionados||e.ges||[]).forEach((function(e){e.examenesMedicos&&Object.keys(e.examenesMedicos).forEach((function(e){return n.add(e)}))}));var t=Array.from(n),r=e.numPersonas||e.numTrabajadores||1;t.forEach((function(n){d++,u++,p.push('\n                    <tr>\n                        <td><input type="checkbox" class="examen-checkbox" data-cargo="'.concat(e.nombre,'" data-examen="').concat(n,'" /></td>\n                        <td>--</td>\n                        <td>\n                            <div class="cell-cargo">\n                                <strong>').concat(e.nombre||"Sin nombre",'</strong>\n                                <span class="text-xs text-muted">').concat(r," persona").concat(1!==r?"s":"",'</span>\n                            </div>\n                        </td>\n                        <td>\n                            <span class="badge badge--primary">').concat(n,'</span>\n                            <span class="text-sm">').concat(i[n]||n,'</span>\n                        </td>\n                        <td class="text-muted">Por programar</td>\n                        <td><span class="badge badge--warning">Por agendar</span></td>\n                        <td>\n                            <button class="btn btn--icon btn--sm" title="Agendar examen">\n                                <i data-lucide="calendar-plus"></i>\n                            </button>\n                        </td>\n                    </tr>\n                '))}))})),On("examenes-stat-vencidos","0"),On("examenes-stat-proximos","0"),On("examenes-stat-aldia","0"),On("examenes-stat-agendar",u.toString()),On("examenes-showing","Mostrando ".concat(d," de ").concat(d)),(m=document.getElementById("filter-cargo"))&&(m.innerHTML='<option value="">Cargo: Todos</option>',s.forEach((function(e){m.innerHTML+='<option value="'.concat(e.nombre,'">').concat(e.nombre,"</option>")}))),(v=document.getElementById("examenes-table-body"))&&(p.length>0?v.innerHTML=p.join(""):v.innerHTML='\n                    <tr>\n                        <td colspan="7" class="table-empty">\n                            <div class="empty-state empty-state--inline">\n                                <i data-lucide="check-circle"></i>\n                                <span>No hay exámenes pendientes</span>\n                            </div>\n                        </td>\n                    </tr>\n                '),window.lucide&&window.lucide.createIcons(),e.next=53;break;case 47:e.prev=47,e.t0=e.catch(13),console.error("Error loading examenes:",e.t0),(h=document.getElementById("examenes-table-body"))&&(h.innerHTML='\n                <tr>\n                    <td colspan="7" class="table-empty">\n                        <div class="empty-state empty-state--inline">\n                            <i data-lucide="alert-circle"></i>\n                            <span>Error al cargar los exámenes</span>\n                        </div>\n                    </td>\n                </tr>\n            '),window.lucide&&window.lucide.createIcons();case 53:case"end":return e.stop()}}),e,null,[[13,47]])})))).apply(this,arguments)}function mn(){return vn.apply(this,arguments)}function vn(){return vn=c(g().mark((function e(){var n,t,a,r,s,o,i,c,l,d,u,p,m,v,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("🔵 [MATRIZ] ========== Loading Matriz Page =========="),zn("matriz-critical-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <div class="skeleton skeleton--circle" style="width:64px;height:64px;"></div>\n            </div>\n            <h3 class="empty-state__title">Cargando matriz...</h3>\n        </div>\n    '),e.next=4,Mn();case 4:if(n=e.sent,console.log("🔵 [MATRIZ] API result:",n),n&&n.success){e.next=17;break}return On("matriz-total","0"),On("matriz-nivel-v","0"),On("matriz-nivel-iv","0"),On("matriz-nivel-iii","0"),On("matriz-nivel-i-ii","0"),On("matriz-fecha",(new Date).toLocaleDateString("es-CO")),On("matriz-responsable","Sin asignar"),zn("matriz-critical-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="layout-grid"></i>\n                </div>\n                <h3 class="empty-state__title">Matriz de Riesgos GTC-45</h3>\n                <p class="empty-state__description">Aún no hay peligros identificados. Complete el wizard para generar la matriz de riesgos.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Crear Matriz</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 17:try{if(i=n.categorias,c=n.alertasCriticas,l=n.resumen,console.log("🔵 [MATRIZ] Processing resumen:",l),On("matriz-total",((null==l?void 0:l.totalPeligros)||0).toString()),On("matriz-nivel-v",((null==l||null===(t=l.conteoNiveles)||void 0===t?void 0:t.V)||0).toString()),On("matriz-nivel-iv",((null==l||null===(a=l.conteoNiveles)||void 0===a?void 0:a.IV)||0).toString()),On("matriz-nivel-iii",((null==l||null===(r=l.conteoNiveles)||void 0===r?void 0:r.III)||0).toString()),On("matriz-nivel-i-ii",(((null==l||null===(s=l.conteoNiveles)||void 0===s?void 0:s.I)||0)+((null==l||null===(o=l.conteoNiveles)||void 0===o?void 0:o.II)||0)).toString()),On("matriz-fecha",(new Date).toLocaleDateString("es-CO")),d=localStorage.getItem("genesys_empresa"),u="Sin asignar",d)try{p=JSON.parse(d),u=p.nombre_legal||p.razon_social||p.nombre||"Sin asignar"}catch(e){}On("matriz-responsable",u),c&&c.length>0?(m=c.map((function(e){return'\n                <div class="card card--danger mb-3">\n                    <div class="card__body">\n                        <div class="flex justify-between items-center">\n                            <div>\n                                <h4 class="font-semibold">'.concat(e.descripcion,'</h4>\n                                <p class="text-sm text-muted">Cargo: ').concat(e.cargo," · ").concat(e.tipo,'</p>\n                            </div>\n                            <span class="badge badge--').concat("V"===e.nrNivel?"danger":"warning",'">\n                                Nivel ').concat(e.nrNivel," (NR: ").concat(e.nr,")\n                            </span>\n                        </div>\n                    </div>\n                </div>\n            ")})).join(""),zn("matriz-critical-content",m)):(null==l?void 0:l.totalPeligros)>0?zn("matriz-critical-content",'\n                <div class="card card--success">\n                    <div class="card__body text-center">\n                        <i data-lucide="check-circle" class="text-success mb-2" style="width:48px;height:48px;"></i>\n                        <h3>Sin riesgos críticos</h3>\n                        <p class="text-muted">No hay peligros de nivel IV o V en la matriz actual.</p>\n                    </div>\n                </div>\n            '):zn("matriz-critical-content",'\n                <div class="empty-state">\n                    <div class="empty-state__icon">\n                        <i data-lucide="layout-grid"></i>\n                    </div>\n                    <h3 class="empty-state__title">Sin peligros identificados</h3>\n                    <p class="empty-state__description">Agregue riesgos en el wizard para completar la matriz.</p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Ir al Wizard</a>\n                </div>\n            '),i&&i.length>0&&(v=document.getElementById("matriz-categorias-content"))&&(h=i.map((function(e){return'\n                    <div class="card mb-3" style="border-left: 4px solid '.concat(e.color,';">\n                        <div class="card__header">\n                            <h4 class="card__title">').concat(e.nombre,'</h4>\n                            <span class="badge">').concat(e.peligros.length," peligro(s)</span>\n                        </div>\n                    </div>\n                ")})).join(""),v.innerHTML=h)}catch(e){console.error("Error loading matriz:",e),zn("matriz-critical-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="alert-circle"></i>\n                </div>\n                <h3 class="empty-state__title">Error al cargar</h3>\n                <p class="empty-state__description">Hubo un error al cargar los datos de la matriz.</p>\n            </div>\n        ')}window.lucide&&window.lucide.createIcons();case 19:case"end":return e.stop()}}),e)}))),vn.apply(this,arguments)}function hn(){return fn.apply(this,arguments)}function fn(){return(fn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Estadisticas Page..."),zn("estadisticas-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="bar-chart-3"></i>\n            </div>\n            <h3 class="empty-state__title">Perfil Sociodemográfico</h3>\n            <p class="empty-state__description">Aún no hay datos disponibles. El perfil se generará automáticamente con los datos de trabajadores.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bn(){return yn.apply(this,arguments)}function yn(){return(yn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading SVE Page..."),zn("sve-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="activity"></i>\n            </div>\n            <h3 class="empty-state__title">Sistema de Vigilancia Epidemiológica</h3>\n            <p class="empty-state__description">Aún no hay SVE configurados. Se generarán automáticamente basados en los riesgos identificados.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _n(){return wn.apply(this,arguments)}function wn(){return(wn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Psicosocial Page..."),zn("psicosocial-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="flask-conical"></i>\n            </div>\n            <h3 class="empty-state__title">Batería de Riesgo Psicosocial</h3>\n            <p class="empty-state__description">Aún no hay baterías aplicadas. Configure la empresa para comenzar la evaluación psicosocial.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xn(){return En.apply(this,arguments)}function En(){return(En=c(g().mark((function e(){var n,t,r,s,o,i,c,l,d,u,p,m,v,h,f,b;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("🔵 [DOCUMENTOS] ========== Loading Documentos Page =========="),n=localStorage.getItem("genesys_empresa"),t=Pn(),console.log("🔵 [DOCUMENTOS] wizardData:",t?"found":"not found"),r=[],!n){e.next=23;break}if(e.prev=6,!(s=JSON.parse(n)).id){e.next=18;break}return o=localStorage.getItem("genesys_token"),e.next=12,fetch("/api/documentos/empresa/".concat(s.id),{headers:o?{Authorization:"Bearer ".concat(o)}:{}});case 12:if(!(i=e.sent).ok){e.next=18;break}return e.next=16,i.json();case 16:(c=e.sent).success&&c.documents&&(r=c.documents);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.warn("Error fetching documents from API:",e.t0);case 23:if(!(l=localStorage.getItem("genesys_pending_document_token"))||0!==r.length){e.next=39;break}return e.prev=25,e.next=28,fetch("/api/documentos/status/".concat(l));case 28:if(!(d=e.sent).ok){e.next=34;break}return e.next=32,d.json();case 32:(u=e.sent).success&&r.push({token_acceso:l,estado:u.status,preview_urls:u.urls||{},metadata:u.metadata||{},created_at:(new Date).toISOString()});case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(25),console.warn("Error fetching pending document:",e.t1);case 39:if(0!==r.length||!t){e.next=50;break}if(p=t.formData||{},m=p.cargos||[],console.log("🔵 [DOCUMENTOS] Wizard cargos:",m.length),!(m.length>0)){e.next=50;break}return v=0,h=0,m.forEach((function(e){var n;v+=(null===(n=e.ges)||void 0===n?void 0:n.length)||0,h+=e.numPersonas||0})),zn("documentos-content",'\n                <div class="alert-banner alert-banner--info mb-6">\n                    <i data-lucide="info"></i>\n                    <span>\n                        <strong>'.concat(p.nombreEmpresa||"Sin nombre","</strong> · NIT: ").concat(p.nit||"N/A"," ·\n                        ").concat(m.length," cargo(s), ").concat(h," trabajadores, ").concat(v,' riesgos identificados\n                    </span>\n                </div>\n\n                <div class="dashboard-section mb-6">\n                    <h2 class="dashboard-section__title">Documentos Disponibles para Generar</h2>\n                    <div class="dashboard-grid dashboard-grid--cols-4">\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="file-spreadsheet" style="width:48px;height:48px;color:#10b981;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Matriz GTC-45</h3>\n                                <p class="text-muted text-sm mb-4">Excel con ').concat(v,' peligros identificados</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="file-text" style="width:48px;height:48px;color:#5dc4af;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Profesiograma</h3>\n                                <p class="text-muted text-sm mb-4">PDF para ').concat(m.length,' cargo(s)</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="user-check" style="width:48px;height:48px;color:#f59e0b;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Perfil de Cargo</h3>\n                                <p class="text-muted text-sm mb-4">Requisitos por cargo</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                        <div class="card">\n                            <div class="card__body text-center">\n                                <i data-lucide="receipt" style="width:48px;height:48px;color:#6366f1;margin-bottom:16px;"></i>\n                                <h3 class="card__title">Cotización</h3>\n                                <p class="text-muted text-sm mb-4">Presupuesto de exámenes</p>\n                                <span class="badge badge--success">Listo para generar</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="dashboard-section mb-6">\n                    <h2 class="dashboard-section__title">Resumen de Cargos</h2>\n                    <div class="table-container">\n                        <table class="data-table">\n                            <thead>\n                                <tr>\n                                    <th>Cargo</th>\n                                    <th>Área</th>\n                                    <th>Zona</th>\n                                    <th>Trabajadores</th>\n                                    <th>Riesgos GES</th>\n                                    <th>Especial</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ').concat(m.map((function(e){var n;return"\n                                    <tr>\n                                        <td><strong>".concat(e.nombre||"Sin nombre","</strong></td>\n                                        <td>").concat(e.area||"N/A","</td>\n                                        <td>").concat(e.zona||"N/A","</td>\n                                        <td>").concat(e.numPersonas||0,'</td>\n                                        <td><span class="badge badge--primary">').concat((null===(n=e.ges)||void 0===n?void 0:n.length)||0,"</span></td>\n                                        <td>\n                                            ").concat(e.trabajaAlturas?'<span class="badge badge--warning" title="Trabajo en alturas">🪜</span>':"","\n                                            ").concat(e.manipulaAlimentos?'<span class="badge badge--info" title="Manipula alimentos">🍽️</span>':"","\n                                            ").concat(e.conduceVehiculo?'<span class="badge badge--secondary" title="Conduce vehículo">🚗</span>':"","\n                                            ").concat(e.trabajaEspaciosConfinados?'<span class="badge badge--danger" title="Espacios confinados">⚠️</span>':"","\n                                            ").concat(e.trabajaAlturas||e.manipulaAlimentos||e.conduceVehiculo||e.trabajaEspaciosConfinados?"":"-","\n                                        </td>\n                                    </tr>\n                                ")})).join(""),'\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n\n                <div class="text-center mt-6">\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary btn--lg">\n                        <i data-lucide="zap"></i>\n                        Ir al Wizard para Generar Documentos\n                    </a>\n                </div>\n            ')),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 50:r.length>0?(f={matriz:{icon:"file-spreadsheet",label:"Matriz GTC-45",color:"#10b981"},profesiograma:{icon:"file-text",label:"Profesiograma",color:"#5dc4af"},perfil:{icon:"user-check",label:"Perfil de Cargo",color:"#f59e0b"},cotizacion:{icon:"receipt",label:"Cotización",color:"#6366f1"}},b=r.map((function(e){var n=e.preview_urls||{},t=e.metadata||{},r=new Date(e.created_at).toLocaleDateString("es-CO"),s="pagado"===e.estado?"Pagado":"completado"===e.estado?"Completado":"Pendiente",o="pagado"===e.estado?"success":"completado"===e.estado?"primary":"warning",i=Object.entries(n).filter((function(e){return"thumbnails"!==a(e,1)[0]})).map((function(e){var n=a(e,2),t=n[0],r=n[1],s=f[t]||{icon:"file",label:t,color:"#6b7280"};return'\n                    <div class="card card--document">\n                        <div class="card__body">\n                            <div class="document-icon" style="color:'.concat(s.color,';">\n                                <i data-lucide="').concat(s.icon,'"></i>\n                            </div>\n                            <div class="document-info">\n                                <h4>').concat(s.label,'</h4>\n                                <span class="text-xs text-muted">').concat("matriz"===t?"Excel":"PDF",'</span>\n                            </div>\n                            <a href="').concat(r,'" target="_blank" class="btn btn--sm btn--primary" download>\n                                <i data-lucide="download"></i>\n                            </a>\n                        </div>\n                    </div>\n                ')})).join("");return'\n                <div class="card mb-4">\n                    <div class="card__header">\n                        <div>\n                            <h3 class="card__title">'.concat(t.nombreEmpresa||"Empresa",'</h3>\n                            <span class="text-sm text-muted">Generado: ').concat(r," · ").concat(t.numCargos||0,' cargos</span>\n                        </div>\n                        <span class="badge badge--').concat(o,'">').concat(s,'</span>\n                    </div>\n                    <div class="card__body">\n                        <div class="dashboard-grid dashboard-grid--cols-4">\n                            ').concat(i||'<p class="text-muted">Sin documentos disponibles</p>',"\n                        </div>\n                    </div>\n                </div>\n            ")})).join(""),zn("documentos-content",'\n            <div class="dashboard-section">\n                <h2 class="dashboard-section__title">Documentos Generados</h2>\n                '.concat(b,'\n            </div>\n            <div class="text-center mt-6">\n                <a href="/pages/wizard_riesgos.html" class="btn btn--outline">\n                    <i data-lucide="plus"></i>\n                    Generar Nuevos Documentos\n                </a>\n            </div>\n        '))):zn("documentos-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="folder-open"></i>\n                </div>\n                <h3 class="empty-state__title">Centro de Documentos</h3>\n                <p class="empty-state__description">Aún no hay documentos generados. Complete el wizard para generar profesiogramas, matrices y más.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Generar Documentos</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 52:case"end":return e.stop()}}),e,null,[[6,20],[25,36]])})))).apply(this,arguments)}function An(){return Cn.apply(this,arguments)}function Cn(){return(Cn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Config Page..."),zn("config-content",'\n        <div class="card">\n            <div class="card__header">\n                <h3 class="card__title">Configuración de Empresa</h3>\n            </div>\n            <div class="card__body">\n                <p class="text-muted">La configuración se habilitará cuando la empresa esté registrada en el sistema.</p>\n            </div>\n        </div>\n    ');case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sn(){return kn.apply(this,arguments)}function kn(){return(kn=c(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading Panel Medico Page..."),On("medico-info","Sin médico asignado"),zn("panel-medico-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <i data-lucide="stethoscope"></i>\n            </div>\n            <h3 class="empty-state__title">Panel Médico Ocupacional</h3>\n            <p class="empty-state__description">Este panel es exclusivo para médicos ocupacionales. Contacte al administrador para obtener acceso.</p>\n        </div>\n    '),window.lucide&&window.lucide.createIcons();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function In(){return Nn.apply(this,arguments)}function Nn(){return Nn=c(g().mark((function e(){var n,t,r,s,o,i,c,l;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("🔵 [PROFESIOGRAMA] ========== Loading Profesiograma Page =========="),zn("profesiograma-content",'\n        <div class="empty-state">\n            <div class="empty-state__icon">\n                <div class="skeleton skeleton--circle" style="width:64px;height:64px;"></div>\n            </div>\n            <h3 class="empty-state__title">Cargando profesiograma...</h3>\n        </div>\n    '),e.next=4,Ln();case 4:if(n=e.sent,console.log("🔵 [PROFESIOGRAMA] API result:",n),n&&n.success){e.next=10;break}return zn("profesiograma-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="file-text"></i>\n                </div>\n                <h3 class="empty-state__title">Sin Profesiograma</h3>\n                <p class="empty-state__description">Aún no has generado un profesiograma. Usa el asistente para crear uno.</p>\n                <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Crear Profesiograma</a>\n            </div>\n        '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 10:if(e.prev=10,t=n.cargos||[],console.log("🔵 [PROFESIOGRAMA] Processing cargos from API:",t.length),0!==t.length){e.next=18;break}return console.log("🟡 [PROFESIOGRAMA] No cargos found"),zn("profesiograma-content",'\n                <div class="empty-state">\n                    <div class="empty-state__icon">\n                        <i data-lucide="file-text"></i>\n                    </div>\n                    <h3 class="empty-state__title">Sin Cargos Configurados</h3>\n                    <p class="empty-state__description">No hay cargos en el profesiograma. Completa el wizard para agregar cargos.</p>\n                    <a href="/pages/wizard_riesgos.html" class="btn btn--primary">Ir al Wizard</a>\n                </div>\n            '),window.lucide&&window.lucide.createIcons(),e.abrupt("return");case 18:if(r=localStorage.getItem("genesys_empresa"),s={nombre:"Empresa",nit:"--"},r)try{o=JSON.parse(r),s={nombre:o.nombre_legal||o.razon_social||o.nombre||"Empresa",nit:o.nit||"--"}}catch(e){}i=t.map((function(e,n){var t=e.riesgosCount||0,r=e.togglesActivos||[],s=e.nrNivelMaximo||"I",o=e.conteoNiveles||{},i={I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[s]||"muted",c=r.map((function(e){return{Alturas:{icon:"mountain",label:"Alturas"},Alimentos:{icon:"utensils",label:"Alimentos"},Vehiculo:{icon:"car",label:"Conducción"},"Espacios Conf.":{icon:"box",label:"Esp. Confinados"}}[e]||{icon:"alert-triangle",label:e}})),l=Object.entries(o).filter((function(e){return a(e,2)[1]>0})).map((function(e){var n=a(e,2),t=n[0],r=n[1];return'<span class="badge badge--'.concat({I:"success",II:"info",III:"warning",IV:"danger",V:"danger"}[t]||"muted",'">').concat(r," NR-").concat(t,"</span>")})).join(" ");return'\n                <div class="card card--profesiograma">\n                    <div class="card__header">\n                        <div>\n                            <h3 class="card__title">'.concat(e.nombre_cargo||"Cargo "+(n+1),'</h3>\n                            <span class="text-sm text-muted">').concat(e.area||"Sin área"," · ").concat(e.zona||"Sin zona"," · ").concat(e.num_trabajadores||0,' persona(s)</span>\n                        </div>\n                        <div class="card__badges">\n                            <span class="badge badge--').concat(t>0?"primary":"muted",'">').concat(t," Riesgos</span>\n                            ").concat(t>0?'<span class="badge badge--'.concat(i,'">NR Max: ').concat(s,"</span>"):"",'\n                        </div>\n                    </div>\n                    <div class="card__body">\n                        ').concat(c.length>0?'\n                            <div class="profesiograma-section mb-4">\n                                <p class="profesiograma-section__title">\n                                    <i data-lucide="alert-triangle" style="width:16px;height:16px;color:#f59e0b;"></i>\n                                    Condiciones Especiales\n                                </p>\n                                <div class="flex gap-2 flex-wrap">\n                                    '.concat(c.map((function(e){return'<span class="badge badge--warning"><i data-lucide="'.concat(e.icon,'" style="width:12px;height:12px;"></i> ').concat(e.label,"</span>")})).join(""),"\n                                </div>\n                            </div>\n                        "):"","\n\n                        ").concat(t>0?'\n                            <div class="profesiograma-section mb-4">\n                                <p class="profesiograma-section__title">\n                                    <i data-lucide="shield-alert" style="width:16px;height:16px;color:#ef4444;"></i>\n                                    Distribución de Riesgos\n                                </p>\n                                <div class="flex gap-2 flex-wrap">\n                                    '.concat(l||'<span class="badge badge--muted">Sin clasificar</span>',"\n                                </div>\n                            </div>\n                        "):"",'\n\n                        <div class="profesiograma-section">\n                            <p class="profesiograma-section__title">\n                                <i data-lucide="clipboard-list" style="width:16px;height:16px;color:#5dc4af;"></i>\n                                Información\n                            </p>\n                            <div class="profesiograma-list">\n                                <div class="profesiograma-list__item">\n                                    <span class="badge badge--primary badge--sm">ID</span>\n                                    <span>').concat(e.id,'</span>\n                                </div>\n                                <div class="profesiograma-list__item">\n                                    <span class="badge badge--info badge--sm">Doc</span>\n                                    <span>Documento #').concat(e.documento_id,"</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            ")})).join(""),c=t.reduce((function(e,n){return e+(n.num_trabajadores||0)}),0),l=t.reduce((function(e,n){return e+(n.riesgosCount||0)}),0),zn("profesiograma-content",'\n            <div class="dashboard-grid dashboard-grid--cols-4 mb-6">\n                <div class="card card--stat">\n                    <div class="stat-value">'.concat(t.length,'</div>\n                    <div class="stat-label">Cargos</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(c,'</div>\n                    <div class="stat-label">Trabajadores</div>\n                </div>\n                <div class="card card--stat">\n                    <div class="stat-value">').concat(l,'</div>\n                    <div class="stat-label">Riesgos Identificados</div>\n                </div>\n                <div class="card card--stat card--highlight">\n                    <div class="stat-value stat-value--primary">').concat(n.total||t.length,'</div>\n                    <div class="stat-label">Total BD</div>\n                </div>\n            </div>\n\n            <div class="card card--company mb-6">\n                <div class="card__body" style="display:flex;align-items:center;gap:24px;">\n                    <div class="company-logo" style="width:64px;height:64px;background:#5dc4af;border-radius:12px;display:flex;align-items:center;justify-content:center;">\n                        <i data-lucide="building-2" style="width:32px;height:32px;color:#fff;"></i>\n                    </div>\n                    <div>\n                        <h2 style="margin:0 0 4px;">').concat(s.nombre,'</h2>\n                        <p class="text-muted" style="margin:0;">NIT: ').concat(s.nit,'</p>\n                    </div>\n                </div>\n            </div>\n\n            <div class="dashboard-section">\n                <h2 class="dashboard-section__title">Protocolo de Vigilancia por Cargo</h2>\n                <div class="dashboard-grid dashboard-grid--cols-2">\n                    ').concat(i,'\n                </div>\n            </div>\n\n            <div class="text-center mt-6">\n                <a href="/pages/wizard_riesgos.html" class="btn btn--outline mr-3">\n                    <i data-lucide="edit"></i> Editar en Wizard\n                </a>\n                <a href="/pages/profesiograma_view.html" class="btn btn--primary">\n                    <i data-lucide="eye"></i> Ver Profesiograma Completo\n                </a>\n            </div>\n        ')),window.lucide&&window.lucide.createIcons(),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(10),console.error("Error loading profesiograma:",e.t0),zn("profesiograma-content",'\n            <div class="empty-state">\n                <div class="empty-state__icon">\n                    <i data-lucide="alert-circle"></i>\n                </div>\n                <h3 class="empty-state__title">Error al cargar</h3>\n                <p class="empty-state__description">Hubo un error al cargar los datos del profesiograma.</p>\n            </div>\n        '),window.lucide&&window.lucide.createIcons();case 33:case"end":return e.stop()}}),e,null,[[10,28]])}))),Nn.apply(this,arguments)}function zn(e,n){console.log("🟢 [showPageContent] containerId:",e);var t=document.getElementById(e);console.log("🟢 [showPageContent] container found:",!!t),t?(t.innerHTML=n,console.log("🟢 [showPageContent] HTML set, length:",n.length),console.log("🟢 [showPageContent] First 200 chars:",n.substring(0,200))):(console.error("🔴 [showPageContent] Container NOT FOUND:",e),console.error("🔴 [showPageContent] Available elements with IDs:",Array.from(document.querySelectorAll("[id]")).map((function(e){return e.id})).join(", ")))}function Pn(){var e=localStorage.getItem("genesys_wizard_state");if(!e)return console.warn("🟡 [getWizardData] No wizard state in localStorage"),null;try{var n=JSON.parse(e);return console.log("🟢 [getWizardData] Successfully parsed wizard state"),n}catch(e){return console.error("🔴 [getWizardData] Error parsing:",e),null}}function On(e,n){var t=document.getElementById(e);t&&(t.textContent=n)}function jn(){var e=localStorage.getItem("genesys_token");return{"Content-Type":"application/json",Authorization:e?"Bearer ".concat(e):""}}function Dn(){var e=localStorage.getItem("genesys_empresa");if(e)try{var n=JSON.parse(e);return console.log("🔵 [API] Empresa ID:",n.id),n.id}catch(e){console.error("🔴 [API] Error parsing empresa:",e)}return null}function Ln(){return $n.apply(this,arguments)}function $n(){return($n=c(g().mark((function e(){var n,t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Dn()){e.next=4;break}return console.warn("🟡 [API] No empresa ID, cannot fetch cargos"),e.abrupt("return",null);case 4:return e.prev=4,console.log("🔵 [API] Fetching cargos for empresa:",n),e.next=8,fetch("/api/cargos/empresa/".concat(n),{headers:jn()});case 8:if((t=e.sent).ok){e.next=12;break}return console.error("🔴 [API] Error fetching cargos:",t.status),e.abrupt("return",null);case 12:return e.next=14,t.json();case 14:return a=e.sent,console.log("🟢 [API] Cargos fetched:",a),Ve.data.cargos=a.cargos||[],Ve.companyId=n,e.abrupt("return",a);case 21:return e.prev=21,e.t0=e.catch(4),console.error("🔴 [API] Error fetching cargos:",e.t0),e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,null,[[4,21]])})))).apply(this,arguments)}function Mn(){return Tn.apply(this,arguments)}function Tn(){return(Tn=c(g().mark((function e(){var n,t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Dn()){e.next=4;break}return console.warn("🟡 [API] No empresa ID, cannot fetch matriz"),e.abrupt("return",null);case 4:return e.prev=4,console.log("🔵 [API] Fetching matriz for empresa:",n),e.next=8,fetch("/api/cargos/matriz-gtc45/".concat(n),{headers:jn()});case 8:if((t=e.sent).ok){e.next=12;break}return console.error("🔴 [API] Error fetching matriz:",t.status),e.abrupt("return",null);case 12:return e.next=14,t.json();case 14:return a=e.sent,console.log("🟢 [API] Matriz fetched:",a),Ve.data.matriz=a,e.abrupt("return",a);case 20:return e.prev=20,e.t0=e.catch(4),console.error("🔴 [API] Error fetching matriz:",e.t0),e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,null,[[4,20]])})))).apply(this,arguments)}function Rn(){var e=document.getElementById("user-menu"),n=document.getElementById("user-dropdown"),t=document.getElementById("btn-logout");e&&n&&(e.addEventListener("click",(function(t){t.stopPropagation(),n.classList.toggle("open"),e.classList.toggle("open")})),document.addEventListener("click",(function(t){e.contains(t.target)||(n.classList.remove("open"),e.classList.remove("open"))})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&(n.classList.remove("open"),e.classList.remove("open"))}))),t&&t.addEventListener("click",(function(e){e.preventDefault(),Hn()}));var a=document.getElementById("sidebar-logout");a&&a.addEventListener("click",(function(e){e.preventDefault(),Hn()})),function(){var e=document.getElementById("user-avatar"),n=document.getElementById("user-name"),t=document.getElementById("user-email"),a=localStorage.getItem("genesys_user")||localStorage.getItem("userData"),r=localStorage.getItem("genesys_empresa");if(a)try{var s=JSON.parse(a);if(e&&s.nombre){var o=s.nombre.split(" ").map((function(e){return e[0]})).slice(0,2).join("").toUpperCase();e.textContent=o}n&&s.nombre&&(n.textContent=s.nombre),t&&s.email&&(t.textContent=s.email)}catch(e){console.warn("Error parsing user data:",e)}else if(r)try{var i=JSON.parse(r);if(e&&i.razon_social){var c=i.razon_social.split(" ").map((function(e){return e[0]})).slice(0,2).join("").toUpperCase();e.textContent=c}n&&i.razon_social&&(n.textContent=i.razon_social),t&&i.email&&(t.textContent=i.email)}catch(e){console.warn("Error parsing empresa data:",e)}else e&&(e.textContent="US"),n&&(n.textContent="Usuario"),t&&(t.textContent="usuario@empresa.com")}()}function Hn(){localStorage.removeItem("genesys_token"),localStorage.removeItem("genesys_user"),localStorage.removeItem("genesys_empresa"),localStorage.removeItem("genesys_auth_type"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),sessionStorage.clear(),window.location.href="/pages/login.html"}function Gn(){return Bn.apply(this,arguments)}function Bn(){return(Bn=c(g().mark((function e(){var n,t,a,r,s,o,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[Dashboard] Loading company data..."),!(n=localStorage.getItem("genesys_empresa"))){e.next=13;break}return e.prev=3,t=JSON.parse(n),console.log("[Dashboard] Found empresa from login:",t),Vn(t.razon_social||t.nombre_legal||t.nombre,t),e.abrupt("return",t);case 10:e.prev=10,e.t0=e.catch(3),console.warn("[Dashboard] Error parsing genesys_empresa:",e.t0);case 13:if(!(a=localStorage.getItem("genesys_wizard_state"))){e.next=29;break}if(e.prev=15,!(r=JSON.parse(a)).formData||!r.formData.nombreEmpresa){e.next=24;break}return console.log("[Dashboard] Found company from wizard state:",r.formData.nombreEmpresa),Vn((s={nombre:r.formData.nombreEmpresa,nit:r.formData.nit,email:r.formData.email,sector:r.formData.sector,cargos:r.formData.cargos||[]}).nombre,s),Ve.companyName=s.nombre,Ve.data.cargos=s.cargos,e.abrupt("return",s);case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(15),console.warn("[Dashboard] Error parsing genesys_wizard_state:",e.t1);case 29:if(!(o=localStorage.getItem("genesys_user"))){e.next=42;break}if(e.prev=31,!(i=JSON.parse(o)).empresa){e.next=37;break}return console.log("[Dashboard] Found empresa from user data:",i.empresa),Vn(i.empresa.nombre||i.empresa.razon_social,i.empresa),e.abrupt("return",i.empresa);case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(31),console.warn("[Dashboard] Error parsing genesys_user:",e.t2);case 42:return console.log("[Dashboard] No company data found"),On("company-name","Sin empresa"),e.abrupt("return",null);case 45:case"end":return e.stop()}}),e,null,[[3,10],[15,26],[31,39]])})))).apply(this,arguments)}function Vn(e,n){if(On("company-name",e||"Sin empresa"),Ve.companyName=e,Ve.companyId=(null==n?void 0:n.id)||null,null!=n&&n.cargos&&Array.isArray(n.cargos)){var t=n.cargos.length,a=n.cargos.reduce((function(e,n){return e+(n.numPersonas||n.numTrabajadores||0)}),0);On("stat-total-trabajadores",a.toString());var r=0;n.cargos.forEach((function(e){e.ges&&Array.isArray(e.ges)&&(r+=e.ges.length),e.gesSeleccionados&&Array.isArray(e.gesSeleccionados)&&(r+=e.gesSeleccionados.length)})),On("stat-peligros",r.toString()),console.log("[Dashboard] Company stats - Cargos: ".concat(t,", Trabajadores: ").concat(a,", GES: ").concat(r))}}function Un(){console.log("[CargoWizard] Opening create wizard...");var e,n=Dn(),t=He({mode:"create",empresaId:n,onSave:(e=c(g().mark((function e(t){var a,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[CargoWizard] Saving new cargo:",t),e.prev=1,e.next=4,fetch("/api/cargos",{method:"POST",headers:jn(),body:JSON.stringify(Be(Be({},t),{},{empresa_id:n}))});case 4:if((a=e.sent).ok){e.next=7;break}throw new Error("Error al crear el cargo");case 7:return e.next=9,a.json();case 9:return r=e.sent,console.log("[CargoWizard] Cargo created:",r),e.next=13,dn();case 13:Wn("Cargo creado exitosamente","success"),e.next=21;break;case 16:throw e.prev=16,e.t0=e.catch(1),console.error("[CargoWizard] Error saving cargo:",e.t0),Wn("Error al crear el cargo: "+e.t0.message,"error"),e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,16]])}))),function(n){return e.apply(this,arguments)}),onCancel:function(){console.log("[CargoWizard] Create wizard cancelled")}});t.show()}function qn(){var e=document.getElementById("btn-nuevo-cargo");e&&e.addEventListener("click",(function(e){e.preventDefault(),Un()}));var n=document.querySelector(".btn-nuevo-cargo-inline");n&&n.addEventListener("click",(function(e){e.preventDefault(),Un()})),document.querySelectorAll(".btn-edit-cargo").forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault();var t=e.dataset.cargoId,a={};try{var r=e.dataset.cargo;r&&(a=JSON.parse(r.replace(/&#39;/g,"'")))}catch(e){console.error("[CargoWizard] Error parsing cargo data:",e)}!function(e,n){console.log("[CargoWizard] Opening edit wizard for cargo:",e,n);var t,a=Dn(),r=He({mode:"edit",cargoId:e,cargoData:n,empresaId:a,onSave:(t=c(g().mark((function n(t){var r,s,o;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("[CargoWizard] Saving edited cargo:",t),n.prev=1,t.pendingApprovals&&t.pendingApprovals.length>0&&(console.log("[CargoWizard] Cargo has pending approvals:",t.pendingApprovals),t.estado_aprobacion="pendiente"),n.next=5,fetch("/api/cargos/".concat(e),{method:"PUT",headers:jn(),body:JSON.stringify(Be(Be({},t),{},{empresa_id:a}))});case 5:if((s=n.sent).ok){n.next=8;break}throw new Error("Error al actualizar el cargo");case 8:return n.next=10,s.json();case 10:return o=n.sent,console.log("[CargoWizard] Cargo updated:",o),n.next=14,dn();case 14:(null===(r=t.pendingApprovals)||void 0===r?void 0:r.length)>0?Wn("Cargo actualizado. Algunos cambios están pendientes de aprobación.","warning"):Wn("Cargo actualizado exitosamente","success"),n.next=23;break;case 18:throw n.prev=18,n.t0=n.catch(1),console.error("[CargoWizard] Error updating cargo:",n.t0),Wn("Error al actualizar el cargo: "+n.t0.message,"error"),n.t0;case 23:case"end":return n.stop()}}),n,null,[[1,18]])}))),function(e){return t.apply(this,arguments)}),onCancel:function(){console.log("[CargoWizard] Edit wizard cancelled")}});r.show()}(t,a)}))})),console.log("[CargoWizard] Events bound successfully")}function Wn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=document.createElement("div");t.className="notification notification--".concat(n),t.innerHTML='\n        <i data-lucide="'.concat("success"===n?"check-circle":"error"===n?"alert-circle":"warning"===n?"alert-triangle":"info",'"></i>\n        <span>').concat(e,"</span>\n    "),document.body.appendChild(t),window.lucide&&window.lucide.createIcons(),setTimeout((function(){t.classList.add("show")}),10),setTimeout((function(){t.classList.remove("show"),setTimeout((function(){t.remove()}),300)}),4e3)}document.addEventListener("DOMContentLoaded",c(g().mark((function e(){var n,t,a,r,s,o,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("🚀 Dashboard Premium initializing..."),console.log("🔍 [DEBUG] Checking localStorage..."),n=localStorage.getItem("genesys_wizard_state"),console.log("🔍 [DEBUG] genesys_wizard_state exists:",!!n),n)try{i=JSON.parse(n),console.log("🔍 [DEBUG] Parsed wizard state:",{currentStep:i.currentStep,hasFormData:!!i.formData,nombreEmpresa:(null===(t=i.formData)||void 0===t?void 0:t.nombreEmpresa)||"N/A",nit:(null===(a=i.formData)||void 0===a?void 0:a.nit)||"N/A",cargosCount:(null===(r=i.formData)||void 0===r||null===(r=r.cargos)||void 0===r?void 0:r.length)||0,firstCargo:(null===(s=i.formData)||void 0===s||null===(s=s.cargos)||void 0===s?void 0:s[0])||"No cargos"}),(null===(o=i.formData)||void 0===o||null===(o=o.cargos)||void 0===o?void 0:o.length)>0&&i.formData.cargos.forEach((function(e,n){var t;console.log("🔍 [DEBUG] Cargo ".concat(n,":"),{nombre:e.nombre,area:e.area,zona:e.zona,numPersonas:e.numPersonas,gesCount:(null===(t=e.ges)||void 0===t?void 0:t.length)||0,toggles:{trabajaAlturas:e.trabajaAlturas,manipulaAlimentos:e.manipulaAlimentos,conduceVehiculo:e.conduceVehiculo,trabajaEspaciosConfinados:e.trabajaEspaciosConfinados}})}))}catch(e){console.error("🔴 [DEBUG] Error parsing wizard state:",e)}else console.warn("🟡 [DEBUG] No wizard state found in localStorage. Keys available:",Object.keys(localStorage));return console.log("🔍 [DEBUG] Checking DOM containers..."),["cargos-content","matriz-critical-content","profesiograma-content","documentos-content","examenes-table-body"].forEach((function(e){var n=document.getElementById(e);console.log('🔍 [DEBUG] Container "'.concat(e,'":'),n?"FOUND":"NOT FOUND")})),new Ke,Rn(),e.next=12,Gn();case 12:document.addEventListener("keydown",(function(e){if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault();var n=document.getElementById("global-search");n&&n.focus()}})),console.log("✅ Dashboard Premium ready");case 14:case"end":return e.stop()}}),e)})))),console.log("✅ Dashboard Premium initialized")})()})();