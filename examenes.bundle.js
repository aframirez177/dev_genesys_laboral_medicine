/*! For license information please see examenes.bundle.js.LICENSE.txt */
(()=>{var e={633:(e,t,n)=>{var r=n(738).default;function a(){"use strict";e.exports=a=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},o=Object.prototype,i=o.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,n){return e[t]=n}}function m(e,t,n,r){var a=t&&t.prototype instanceof E?t:E,o=Object.create(a.prototype),i=new j(r||[]);return c(o,"_invoke",{value:T(e,n,i)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=m;var v="suspendedStart",h="suspendedYield",g="executing",y="completed",b={};function E(){}function S(){}function x(){}var C={};p(C,l,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(N([])));O&&O!==o&&i.call(O,l)&&(C=O);var P=x.prototype=E.prototype=Object.create(C);function k(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(a,o,c,s){var l=f(e[a],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(d).then((function(e){u.value=e,c(u)}),(function(e){return n("throw",e,c,s)}))}s(l.arg)}var a;c(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}})}function T(e,n,r){var a=v;return function(o,i){if(a===g)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var s=I(c,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=g;var l=f(e,n,r);if("normal"===l.type){if(a=r.done?y:h,l.arg===b)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=y,r.method="throw",r.arg=l.arg)}}}function I(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var o=f(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(i.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(r(e)+" is not iterable")}return S.prototype=x,c(P,"constructor",{value:x,configurable:!0}),c(x,"constructor",{value:S,configurable:!0}),S.displayName=p(x,d,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,p(e,d,"GeneratorFunction")),e.prototype=Object.create(P),e},n.awrap=function(e){return{__await:e}},k(L.prototype),p(L.prototype,u,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,r,a,o){void 0===o&&(o=Promise);var i=new L(m(e,t,r,a),o);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(P),p(P,d,"Generator"),p(P,l,(function(){return this})),p(P,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=N,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],c=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;M(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},756:(e,t,n)=>{var r=n(633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=t.apply(n,r);function c(t){e(i,a,o,c,s,"next",t)}function s(t){e(i,a,o,c,s,"throw",t)}c(void 0)}))}}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var l=n(756),u=n.n(l);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],s=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,a=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function(){return s((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.options={googleFormsUrl:t.googleFormsUrl||"",googleSheetsUrl:t.googleSheetsUrl||"",onSuccess:t.onSuccess||function(){},onError:t.onError||function(){},redirectTo:t.redirectTo||null},this.sourcePage=this.detectSourcePage(),this.form=null,this.modal=null}),[{key:"detectSourcePage",value:function(){var e=window.location.pathname;return e.includes("Matriz_de_riesgos_profesional")?"matriz-riesgos":e.includes("Profesiograma")?"profesiograma":e.includes("Examenes_medicos_ocupacionales")?"examenes-medicos":"unknown"}},{key:"generateFormHTML",value:function(){return'\n            <div class="contact-form-modal" id="contactFormModal">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h2>'.concat(this.getFormTitle(),'</h2>\n                        <button class="close-modal" type="button">&times;</button>\n                    </div>\n                    <form id="contactInfoForm" class="contact-form">\n                        <div class="form-group">\n                            <label for="fullName">Nombre completo *</label>\n                            <input type="text" id="fullName" name="fullName" required>\n                        </div>\n                        \n                        <div class="form-group">\n                            <label for="company">Empresa *</label>\n                            <input type="text" id="company" name="company" required>\n                        </div>\n                        \n                        <div class="form-row">\n                            <div class="form-group">\n                                <label for="nit">NIT *</label>\n                                <input type="text" id="nit" name="nit" \n                                    pattern="[0-9-]*" \n                                    title="Ingrese un NIT válido"\n                                    required>\n                            </div>\n                            <div class="form-group">\n                                <label for="companySize">Tamaño de la empresa *</label>\n                                <select id="companySize" name="companySize" required>\n                                    <option value="">Seleccione...</option>\n                                    <option value="micro">Micro (1-10 empleados)</option>\n                                    <option value="pequena">Pequeña (11-50 empleados)</option>\n                                    <option value="mediana">Mediana (51-200 empleados)</option>\n                                    <option value="grande">Grande (201+ empleados)</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        <div class="form-row">\n                            <div class="form-group">\n                                <label for="corporateEmail">Email corporativo *</label>\n                                <input type="email" id="corporateEmail" name="corporateEmail" required>\n                            </div>\n                            <div class="form-group">\n                                <label for="whatsapp">WhatsApp *</label>\n                                <input type="tel" id="whatsapp" name="whatsapp" \n                                    pattern="[0-9]*" \n                                    title="Ingrese solo números"\n                                    required>\n                            </div>\n                        </div>\n\n                        <div class="form-row">\n                            <div class="form-group">\n                                <label for="position">Cargo *</label>\n                                <input type="text" id="position" name="position" required>\n                            </div>\n                            <div class="form-group">\n                                <label for="city">Ciudad *</label>\n                                <select id="city" name="city" required>\n                                    <option value="">Seleccione...</option>\n                                    ').concat(this.generateColombiaCities(),'\n                                </select>\n                            </div>\n                        </div>\n\n                        <div class="form-row actions">\n                            <button type="submit" class="submit-btn cta-button">Continuar</button>\n                            <button type="button" class="cancel-btn cta-button-1">Cancelar</button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        ')}},{key:"getFormTitle",value:function(){return{"matriz-riesgos":"Complete sus datos para descargar su Matriz de Riesgos",profesiograma:"Complete sus datos para descargar su Profesiograma","examenes-medicos":"Complete sus datos para descargar su Cotización"}[this.sourcePage]||"Complete sus datos"}},{key:"generateColombiaCities",value:function(){return["Bogotá","Medellín","Cali","Barranquilla","Cartagena","Cúcuta","Bucaramanga","Pereira","Santa Marta","Ibagué","Pasto","Manizales","Neiva","Villavicencio","Armenia"].sort().map((function(e){return'<option value="'.concat(e,'">').concat(e,"</option>")})).join("")}},{key:"submitToGoogleForms",value:(n=t(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={"entry.376229560":t.fullName,"entry.388709108":t.company,"entry.816380802":t.nit,"entry.927766678":t.companySize,"entry.1135831971":t.corporateEmail,"entry.412547333":t.whatsapp,"entry.1264021129":t.position,"entry.1441307568":t.city,"entry.1227109866":this.sourcePage},e.prev=1,e.next=4,fetch(this.options.googleFormsUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n)});case 4:return e.sent,e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(1),console.error("Error submitting to Google Forms:",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return n.apply(this,arguments)})},{key:"submitToGoogleSheets",value:(e=t(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(this.options.googleSheetsUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(f(f({},t),{},{sourcePage:this.sourcePage,timestamp:(new Date).toISOString()}))});case 3:return e.sent,e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error submitting to Google Sheets:",e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(t){return e.apply(this,arguments)})},{key:"showForm",value:function(){document.getElementById("contactFormModal")||(document.body.insertAdjacentHTML("beforeend",this.generateFormHTML()),this.initializeFormHandlers()),this.modal=document.getElementById("contactFormModal"),this.form=document.getElementById("contactInfoForm"),this.modal.style.display="block"}},{key:"hideForm",value:function(){this.modal&&(this.modal.style.display="none")}},{key:"initializeFormHandlers",value:function(){var e=this,n=document.getElementById("contactFormModal"),r=document.getElementById("contactInfoForm"),a=n.querySelector(".close-modal"),o=n.querySelector(".cancel-btn");a.addEventListener("click",(function(){return e.hideForm()})),o.addEventListener("click",(function(){return e.hideForm()})),n.addEventListener("click",(function(t){t.target===n&&e.hideForm()})),r.addEventListener("submit",function(){var n=t(u().mark((function t(n){var a,o,i,c,s,l,d,m;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a=new FormData(r),o=Object.fromEntries(a.entries()),i=r.querySelector(".submit-btn"),c=i.textContent,i.disabled=!0,i.textContent="Procesando...",t.prev=7,t.next=10,Promise.all([e.submitToGoogleForms(o),e.submitToGoogleSheets(o)]);case 10:if(s=t.sent,l=p(s,2),d=l[0],m=l[1],!d||!m){t.next=20;break}e.hideForm(),e.options.onSuccess(o),e.options.redirectTo&&(window.location.href=e.options.redirectTo),t.next=21;break;case 20:throw new Error("Error al enviar el formulario");case 21:t.next=28;break;case 23:t.prev=23,t.t0=t.catch(7),console.error("Error:",t.t0),e.options.onError(t.t0),alert("Hubo un error al procesar su solicitud. Por favor intente nuevamente.");case 28:return t.prev=28,i.disabled=!1,i.textContent=c,t.finish(28);case 32:case"end":return t.stop()}}),t,null,[[7,23,28,32]])})));return function(e){return n.apply(this,arguments)}}());var i=document.getElementById("nit"),c=document.getElementById("whatsapp"),s=document.getElementById("corporateEmail");i.addEventListener("input",(function(e){e.target.value=e.target.value.replace(/[^0-9-]/g,"")})),c.addEventListener("input",(function(e){e.target.value=e.target.value.replace(/[^0-9]/g,"")})),s.addEventListener("input",(function(e){var t=e.target.value;/^[^@]+@(hotmail|yahoo|outlook)\.(com|net|org)$/i.test(t)?s.setCustomValidity("Por favor utilice un correo corporativo"):s.setCustomValidity("")}))}}]);var e,n}();function h(){return new v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(e){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},E={EMO:{code:"EMO",fullName:"EXAMEN MEDICO CON ENFASIS OSTEOMUSCULAR",description:"Evalúa la salud del sistema musculoesquelético, identificando condiciones que puedan afectar el desempeño laboral.",basePrice:3e4},EMOA:{code:"EMOA",fullName:"EXAMEN MEDICO OSTEOMUSCULAR CON ENFASIS EN ALTURAS",description:"Evaluación específica para trabajo en alturas, incluyendo valoración del sistema vestibular y neurológico.",basePrice:33e3},AUD:{code:"AUD",fullName:"AUDIOMETRIA",description:"Mide la capacidad auditiva para identificar posibles pérdidas auditivas causadas por ruido ocupacional.",basePrice:16450},ESP:{code:"ESP",fullName:"ESPIROMETRÍA",description:"Evalúa la función pulmonar, detectando enfermedades respiratorias que puedan ser causadas o agravadas por el trabajo.",basePrice:16450},OPTO:{code:"OPTO",fullName:"OPTOMETRÍA",description:"Examina la salud visual y detecta problemas que puedan afectar el desempeño laboral o ser resultado de la exposición a riesgos en el trabajo.",basePrice:16450},VIS:{code:"VIS",fullName:"VISIOMETRÍA",description:"Mide la agudeza visual y otras capacidades visuales importantes para el trabajo.",basePrice:11900},ECG:{code:"ECG",fullName:"ELECTROCARDIOGRAMA",description:"Registra la actividad eléctrica del corazón para detectar enfermedades cardíacas.",basePrice:29400},RXC:{code:"RXC",fullName:"RAYOS X DE COLUMNA",description:"Obtiene imágenes de la columna vertebral para identificar lesiones o condiciones que puedan afectar la salud del trabajador.",basePrice:49e3},PSM:{code:"PSM",fullName:"PRUEBA PSICOSENSOMETRICA",description:"Evalúa habilidades sensoriales y motoras importantes para ciertas tareas laborales.",basePrice:30800},PST:{code:"PST",fullName:"PRUEBA PSICOTECNICA",description:"Mide aptitudes y habilidades cognitivas relevantes para el desempeño laboral.",basePrice:24500},GLI:{code:"GLI",fullName:"GLICEMIA",description:"Mide los niveles de azúcar en sangre para identificar diabetes u otras condiciones metabólicas.",basePrice:10500},CH:{code:"CH",fullName:"CUADRO HEMATICO",description:"Cuadro Hematico",basePrice:9800},PL:{code:"PL",fullName:"PERFIL LIPÍDICO",description:"Mide los niveles de colesterol y triglicéridos para evaluar el riesgo cardiovascular.",basePrice:22400},PAS:{code:"PAS",fullName:"PRUEBA DE ALCOHOL EN SALIVA",description:"Detectan consumo reciente de alcohol.",basePrice:28e3},PE:{code:"PE",fullName:"PRUEBA DE EMBARAZO",description:"Confirma o descarta un embarazo.",basePrice:12600},PSP:{code:"PSP",fullName:"PRUEBA DE SUSTANCIAS PSICOACTIVAS",description:"Detectan el consumo de drogas.",basePrice:23800},TGO:{code:"TGO",fullName:"TRANSAMINASAS TGO",description:"Evalúan la función hepática. Colesterol: Mide los niveles de colesterol en sangre.",basePrice:12600},TGP:{code:"TGP",fullName:"TRANSAMINASAS TGP",description:"Evalúan la función hepática. Colesterol: Mide los niveles de colesterol en sangre.",basePrice:12600},TRI:{code:"TRI",fullName:"TRIGLICÉRIDOS",description:"Mide los niveles de triglicéridos en sangre.",basePrice:10500},COL:{code:"COL",fullName:"COLESTEROL",description:"Mide los niveles de colesterol en sangre.",basePrice:10500},COP:{code:"COP",fullName:"COPROLOGICO",description:"Coprologico",basePrice:9800},LEP:{code:"LEP",fullName:"LEPTOSPIRA",description:"Leptospira",basePrice:80500},BRU:{code:"BRU",fullName:"BRUCELA",description:"Brucela",basePrice:80500},TOX:{code:"TOX",fullName:"TOXOPLASMA",description:"Toxoplasma",basePrice:40600}},S={"1-10":{min:1,max:10,discount:.05},"11-50":{min:11,max:50,discount:.1},"51-100":{min:51,max:100,discount:.15},"101-500":{min:101,max:500,discount:.2},"501+":{min:501,max:1/0,discount:.25}},x="calculatorState",C=864e5,w=function(){return s((function e(){var t=this;if(i(this,e),window.location.search.includes("newCalculation=true")&&localStorage.removeItem(x),this.cargos=[],this.nextCargoId=1,this.selectedExams=new Map,this.initializeElements(),this.bindEvents(),this.checkSavedData()){var n=JSON.parse(localStorage.getItem(x)),r=new Date(n.lastUpdate),a=Math.floor((new Date-r)/36e5),o=this.container.querySelector(".restore-banner");o.querySelector(".banner-message").textContent="Encontramos una cotización guardada con ".concat(n.cargos.length," cargo(s) de hace ").concat(a," hora(s)"),o.style.display="block",o.querySelector(".btn-restore").addEventListener("click",(function(){t.restoreState(),o.style.display="none"})),o.querySelector(".btn-new").addEventListener("click",(function(){localStorage.removeItem(x),t.addFirstCargo(),o.style.display="none"}))}else this.addFirstCargo()}),[{key:"checkAndRestoreSavedData",value:function(){if(this.checkSavedData()){var e=JSON.parse(localStorage.getItem(x)),t=new Date(e.lastUpdate).toLocaleString(),n=e.cargos.length;confirm("Encontramos una cotización guardada con ".concat(n," cargo(s)\n")+"Última actualización: ".concat(t,"\n\n")+'¿Desea continuar con la cotización guardada?\n\nSeleccione "Aceptar" para continuar con la cotización guardada\nSeleccione "Cancelar" para comenzar una nueva')?this.restoreState():(localStorage.removeItem(x),this.addFirstCargo())}}},{key:"initializeElements",value:function(){this.container=document.querySelector(".calculator"),this.container?(this.container.innerHTML=this.generateCalculatorHTML(),this.cargoContainer=this.container.querySelector("#job-positions"),this.addCargoButton=this.container.querySelector(".btn-add"),this.examDescription=this.container.querySelector("#examDescription"),this.totalPriceElement=this.container.querySelector(".total-price"),this.discountCheckboxes={time:this.container.querySelector("#discount2")},this.discountPercentageElement=this.container.querySelector("#discount-percentage")):console.error("No se encontró el contenedor de la calculadora")}},{key:"generateCalculatorHTML",value:function(){return'\n                <div class="restore-banner" style="display: none;">\n                    <div class="banner-content">\n                        <div class="banner-message"></div>\n                        <div class="banner-actions">\n                            <button class="btn-restore cta-button">Continuar con esta cotización</button>\n                            <button class="btn-new cta-button-1">Crear nueva cotización</button>\n                        </div>\n                    </div>\n                </div>\n                <div class="calculator-header">\n                    <h1>Genera una cotización personalizada de los exámenes médicos ocupacionales para tu equipo de trabajo</h1>\n                </div>\n                <div class="calculator-body">\n                    <div class="calculator-form">\n                        <div class="section-calculator">\n                            <div id="job-positions"></div>\n                            <div class="container-btn-add">\n                                <button class="btn-add">+ Agrega un nuevo cargo aquí</button>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="calculator-summary">\n                        <div class="exam-description">\n                            <h3 id="examTitle">Seleccione un examen</h3>\n                            <p id="examDescription">Pase el cursor sobre un examen para ver su descripción.</p>\n                        </div>\n                        <div class="exam-price">\n                            <p id="examPrice">Desde: <span class="min-price">$0</span></p>\n                        </div>\n                        <div class="package-summary"></div>\n                        <div class="discount-options">\n                            <div class="discount-option info-only">\n                                <div class="discount-info">\n                                    <div class="discount-header">\n                                        <span class="discount-title">Queremos apoyar el desarrollo</span>\n                                    </div>\n                                    <p class="discount-description">Por el tamaño de tu empresa tienes un beneficio de:</p>\n                                </div>\n                                <div class="discount-value" id="discount-percentage">-5%</div>\n                            </div>\n                            <div class="discount-option">\n                                <div class="discount-info">\n                                    <div class="discount-header">\n                                        <span class="discount-title">Ahorra tiempo y dinero</span>\n                                    </div>\n                                    <p class="discount-description">Todo mi equipo realizará sus examenes en una semana o asistirán un mínimo de 35 personas a la semana.</p>\n                                </div>\n                                <div class="discount-action">\n                                    <span class="discount-value">-5%</span>\n                                    <input type="checkbox" id="discount2">\n                                </div>\n                            </div>\n                        </div>\n                        <div class="total">\n                            <p>Los exámenes de tu empresa tienen un valor de:</p>\n                            <p class="total-price">$0</p>\n                        </div>\n                        <button class="btn-download">Descarga Acá tu cotización</button>\n                    </div>\n                </div>\n            '}},{key:"bindEvents",value:function(){var e=this;this.addCargoButton.addEventListener("click",(function(){e.addCargo(),e.saveState()})),Object.values(this.discountCheckboxes).forEach((function(t){t.addEventListener("change",(function(){e.updateTotals(),e.saveState()}))})),this.cargoContainer.addEventListener("click",(function(t){var n=t.target;if(n.classList.contains("toggle-cargo")){var r=n.closest(".cargo");e.toggleCargo(r)}if(n.classList.contains("delete-cargo")){var a=n.closest(".cargo");e.removeCargo(a)}})),this.cargoContainer.addEventListener("input",(function(t){var n=t.target;n.classList.contains("cargo-name")&&(e.updateCargoName(n),e.updateTotals(),e.saveState())})),this.cargoContainer.addEventListener("change",(function(t){var n=t.target;n.classList.contains("exam-checkbox")&&(e.updateExamSelection(n),e.saveState()),n.classList.contains("num-trabajadores")&&(e.updateWorkerCount(n),e.saveState())})),this.cargoContainer.addEventListener("mouseover",(function(t){var n=t.target.closest(".checkbox-item");n&&e.showExamDescription(n.dataset.examCode)})),this.container.querySelector(".btn-download").addEventListener("click",(function(){return e.downloadQuotation()}))}},{key:"generateCargoHTML",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Object.values(E).map((function(t){return'\n                    <div class="checkbox-item" \n                        data-exam-code="'.concat(t.code,'"\n                        title="').concat(t.fullName,'">\n                        <label for="exam-').concat(t.code,"-").concat(e,'">').concat(t.code,'</label>\n                        <input type="checkbox" \n                            id="exam-').concat(t.code,"-").concat(e,'"\n                            class="exam-checkbox"\n                            data-exam-code="').concat(t.code,'"\n                            data-cargo-id="').concat(e,'">\n                    </div>\n                ')})).join("");return'\n                <div class="cargo" data-cargo-id="'.concat(e,'">\n                    <div class="cargo-encabezado">\n                        <div class="cargo-header">\n                            <input type="text" \n                                class="cargo-name" \n                                placeholder="Acá el nombre del cargo"\n                                value="">\n                            <div class="cargo-controls">\n                            <div class="numero-trabajadores">\n                            <input type="number" \n                                class="num-trabajadores" \n                                min="1" \n                                value="1">\n                            </div>\n                                <button class="toggle-cargo">\n                                    ').concat(t?"-":"+","\n                                \n                            </div>\n                        </div>\n                        </button>\n                                ").concat(1!==e?'<button class="delete-cargo">×</button>':"",'\n                    </div>\n                    <div class="cargo-body ').concat(t?"":"hidden",'">\n                        <div class="exam-selector">\n                            <h4>Selecciona los exámenes requeridos:</h4>\n                            <div class="exam-grid">\n                                ').concat(n,"\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            ")}},{key:"addFirstCargo",value:function(){this.cargoContainer.innerHTML="";var e=this.generateCargoHTML(this.nextCargoId);this.cargoContainer.innerHTML=e,this.cargos=[{id:this.nextCargoId,name:"Cargo ".concat(this.nextCargoId),workers:1,selectedExams:new Set}],this.nextCargoId++,this.updateTotals(),this.saveState()}},{key:"addCargo",value:function(){var e=this.generateCargoHTML(this.nextCargoId);this.cargoContainer.insertAdjacentHTML("beforeend",e),this.cargos.push({id:this.nextCargoId,name:"Cargo ".concat(this.nextCargoId),workers:1,selectedExams:new Set}),this.nextCargoId++,this.updateTotals(),this.saveState()}},{key:"removeCargo",value:function(e){var t=parseInt(e.dataset.cargoId);1!==t&&confirm("¿Está seguro de eliminar este cargo?")&&(e.remove(),this.cargos=this.cargos.filter((function(e){return e.id!==t})),this.updateTotals(),this.saveState())}},{key:"toggleCargo",value:function(e){var t=e.querySelector(".cargo-body"),n=e.querySelector(".toggle-cargo");t.classList.toggle("hidden"),n.textContent=t.classList.contains("hidden")?"+":"-"}},{key:"updateCargoName",value:function(e){var t=parseInt(e.closest(".cargo").dataset.cargoId),n=this.cargos.find((function(e){return e.id===t}));n&&(n.name=e.value.trim()||"Cargo ".concat(t),this.saveState(),this.updateTotals())}},{key:"updateExamSelection",value:function(e){var t=parseInt(e.dataset.cargoId),n=e.dataset.examCode,r=this.cargos.find((function(e){return e.id===t}));r&&(e.checked?r.selectedExams.add(n):r.selectedExams.delete(n),this.updateTotals(),this.saveState())}},{key:"updateWorkerCount",value:function(e){var t=parseInt(e.closest(".cargo").dataset.cargoId),n=this.cargos.find((function(e){return e.id===t}));n&&(n.workers=Math.max(1,parseInt(e.value)||1),this.updateTotals(),this.saveState())}},{key:"showExamDescription",value:function(e){var t=E[e];if(t){var n=this.container.querySelector("#examTitle"),r=this.container.querySelector("#examDescription"),a=this.container.querySelector("#examPrice .min-price");n.textContent=t.fullName,r.textContent=t.description,a.textContent=b(t.basePrice)}}},{key:"formatMoneyValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=b(e);return'<span class="valor-cantidad '.concat(t?"larger":"smaller",'">').concat(n,"</span>")}},{key:"calculateVolumeDiscount",value:function(){for(var e=this.cargos.reduce((function(e,t){return e+t.workers}),0),t=0,n=Object.values(S);t<n.length;t++){var r=n[t];if(e>=r.min&&e<=r.max)return r.discount}return 0}},{key:"updateTotals",value:function(){var e=this,t=0,n=this.container.querySelector(".package-summary");n.innerHTML="",this.cargos.forEach((function(r){var a=0;r.selectedExams.forEach((function(e){var t=E[e];t&&(a+=t.basePrice*r.workers)})),t+=a,n.insertAdjacentHTML("beforeend",'\n                    <div class="package-item">\n                        <div class="package-header">\n                            <h4>Paquete '.concat(r.name,'</h4>\n                        </div>\n                        <div class="valores-cargo">\n                            <div class="valor-item">\n                                <div class="valor-descripcion">\n                                    <span class="valor-label">Valor por trabajador:</span>\n                                </div>\n                                <div class="valor-monto">\n                                    ').concat(e.formatMoneyValue(a/(r.workers||1),!1),'\n                                </div>\n                            </div>\n                            <div class="valor-item">\n                                <div class="valor-descripcion">\n                                    <span class="valor-label">Total para ').concat(r.workers," trabajador").concat(1!==r.workers?"es":"",':</span>\n                                </div>\n                                <div class="valor-monto">\n                                    ').concat(e.formatMoneyValue(a,!0),"\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                "))}));var r=this.calculateVolumeDiscount(),a=t;a*=1-r,this.discountCheckboxes.time.checked&&(a*=.95),this.container.querySelector("#discount-percentage").textContent="-".concat((100*r).toFixed(0),"%"),this.totalPriceElement.textContent=b(a)}},{key:"checkSavedData",value:function(){try{var e=localStorage.getItem(x);if(!e)return!1;var t=JSON.parse(e);if(!t.lastUpdate)return!1;var n=new Date(t.lastUpdate).getTime();return(new Date).getTime()-n>C?(localStorage.removeItem(x),!1):t&&Array.isArray(t.cargos)&&t.cargos.length>0&&"number"==typeof t.nextCargoId}catch(e){return console.error("Error al verificar datos guardados:",e),!1}}},{key:"shouldSaveState",value:function(){var e=this.cargos[0];return!(!e||!e.name||e.name==="Cargo ".concat(e.id))&&(0!==e.selectedExams.size&&this.cargos.slice(1).every((function(e){return e.name&&e.name!=="Cargo ".concat(e.id)})))}},{key:"saveState",value:function(){if(this.shouldSaveState()){var e={cargos:this.cargos.map((function(e){return{id:e.id,name:e.name,workers:e.workers,selectedExams:Array.from(e.selectedExams)}})),nextCargoId:this.nextCargoId,discounts:{time:this.discountCheckboxes.time.checked},lastUpdate:(new Date).toISOString()};try{localStorage.setItem(x,JSON.stringify(e)),console.log("Estado guardado exitosamente")}catch(e){console.error("Error al guardar estado:",e)}}}},{key:"restoreState",value:function(){var e=this;try{var t=localStorage.getItem(x);if(!t)return!1;var n=JSON.parse(t);return this.cargoContainer.innerHTML="",this.cargos=[],n.cargos.forEach((function(t){var n=e.generateCargoHTML(t.id);e.cargoContainer.insertAdjacentHTML("beforeend",n);var r=e.cargoContainer.querySelector('[data-cargo-id="'.concat(t.id,'"]'));if(r){r.querySelector(".cargo-name").value=t.name,r.querySelector(".num-trabajadores").value=t.workers;var a={id:t.id,name:t.name,workers:t.workers,selectedExams:new Set};Array.isArray(t.selectedExams)&&t.selectedExams.forEach((function(e){var t=r.querySelector('[data-exam-code="'.concat(e,'"]'));if(t){var n=t.querySelector('input[type="checkbox"]');n&&(n.checked=!0,a.selectedExams.add(e))}})),e.cargos.push(a)}else console.error("No se pudo encontrar el elemento para el cargo ".concat(t.id))})),n.discounts&&(this.discountCheckboxes.time.checked=n.discounts.time),this.nextCargoId=n.nextCargoId,this.updateTotals(),console.log("Estado restaurado:",{cargos:this.cargos.map((function(e){return y(y({},e),{},{selectedExams:Array.from(e.selectedExams)})})),nextCargoId:this.nextCargoId,discounts:{time:this.discountCheckboxes.time.checked}}),!0}catch(e){return console.error("Error al restaurar estado:",e),!1}}},{key:"downloadQuotation",value:(n=t(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h({googleFormsUrl:"https://docs.google.com/forms/d/e/1FAIpQLSfPF3gwfHJtBTVjTyotqTgky39adkKMhwz_AG-G0Hd6iDtBug/formResponse",googleSheetsUrl:"https://script.google.com/macros/s/AKfycbyLelEsDZq-6kbmDwnw7CSMxEKQVjuZnMUConHwMU4extYoi_iOeU4gLPYBHim_04RF/exec",onSuccess:function(e){t.generateAndDownloadFile()},onError:function(e){console.error("Error en el formulario:",e),alert("Hubo un error al procesar su solicitud. Por favor intente nuevamente.")}}).showForm();case 2:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"generateAndDownloadFile",value:(e=t(u().mark((function e(){var t,n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=this.generateQuotationContent(),n=new Blob([t],{type:"text/plain"}),r=window.URL.createObjectURL(n),(a=document.createElement("a")).href=r,a.download="cotizacion_examenes_".concat((new Date).toISOString().split("T")[0],".txt"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)}catch(e){console.error("Error al generar la cotización:",e),alert("Hubo un error al generar la cotización. Por favor intente nuevamente.")}case 1:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"generateQuotationContent",value:function(){var e=[],t=(new Date).toLocaleDateString("es-CO");e.push("COTIZACIÓN DE EXÁMENES MÉDICOS OCUPACIONALES"),e.push("Fecha: ".concat(t)),e.push("==========================================\n"),this.cargos.forEach((function(t){e.push("CARGO: ".concat(t.name)),e.push("Número de trabajadores: ".concat(t.workers)),e.push("Exámenes seleccionados:");var n=0;t.selectedExams.forEach((function(r){var a=E[r],o=a.basePrice*t.workers;n+=o,e.push("- ".concat(a.fullName)),e.push("  Precio unitario: ".concat(b(a.basePrice))),e.push("  Subtotal: ".concat(b(o)))})),e.push("Subtotal para ".concat(t.name,": ").concat(b(n),"\n"))}));var n=this.calculateVolumeDiscount(),r=this.cargos.reduce((function(e,t){return e+t.workers}),0);return e.push("RESUMEN DE DESCUENTOS"),e.push("Total de trabajadores: ".concat(r)),e.push("Descuento por volumen: ".concat((100*n).toFixed(0),"%")),this.discountCheckboxes.time.checked&&e.push("Descuento adicional: 5%"),e.push("\nTOTAL FINAL"),e.push(this.totalPriceElement.textContent),e.join("\n")}}]);var e,n}();function O(){new w}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",O):O()})()})();